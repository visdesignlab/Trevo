{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/dataLoad.js","webpack:///./src/scripts/dataFormat.js","webpack:///./src/scripts/pathCalc.js","webpack:///./src/scripts/buttonComponents.js","webpack:///./src/scripts/selectedPaths.js","webpack:///./src/scripts/renderPathView.js","webpack:///./src/scripts/filterComponent.js","webpack:///./src/scripts/toolbarComponent.js","webpack:///./src/scripts/cladeMaker.js","webpack:///./src/scripts/distributionView.js","webpack:///./src/scripts/pairView.js","webpack:///./src/scripts/viewControl.js","webpack:///./src/scripts/sidebarComponent.js","webpack:///./src/scripts/multinetLoad.js","webpack:///./src/scripts/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","loadData","readFunction","fileString","type","String","maxTimeKeeper","pairPaths","pathData","field","flatMap","path","filter","f","map","pair","verts","test","lastNode","p1Index","p2Index","p1","p2","distance","node","indexOf","common","d3","edgeLength","deltas","range","combLength","binCount","binStep","bins","Array","one","top","bottom","two","b","attributes","valdiffs","Math","abs","values","realVal","calculateDelta","closeness","leaf1","leaf","leaf2","calculateCloseness","calculateNewScales","keyList","colorKeeper","attData","color","undefined","max","upperCI95","min","lowerCI95","domain","clamp","scaleCat","sc","rootAttribute","paths","calculatedAtt","calculatedScales","rootAtt","keys","att","scales","root","combineLength","maxTime","formatAttributeData","filterArray","speciesLabel","species","catColor","move","edgeMove","label","yScale","satScale","colorScale","state","states","winState","stateColors","includes","attrLabel","st","console","error","allPaths","edgeArray","leafArray","source","target","le","getPath","pathKeeper","ed","reverse","pullPath","pathArray","nodes","arrayOfArray","nameArray","depth","forEach","childArray","id","children","assign","flag","dropDown","div","optionArray","dropText","dropId","dropdiv","append","classed","style","button","text","dropContent","attr","options","selectAll","join","on","raise","selectedPaths","comparisonKeeper","pathSelected","selectedPath","otherPaths","selectedDiv","main","remove","drawPathsAndAttributes","commonNodes","selectedSpecies","treeNodes","select","attrHide","filterMaster","attribute","attrFilter","selectedToolTest","selectedTool","empty","sortByDistanceDiv","sortByDistanceButton","sortButton","attrKeys","attrSortWrap","radioDiv","radio","svgTest","svg","branchFrequency","row","reduce","acc","curr","selectWrap","circleScale","selectedGroups","addRemoveBubble","treeNode","treeLinks","this","string","charAt","toUpperCase","timelines","nodeGroups","x","hovers","nearest","attributeWrapper","attributeGroups","renderAttributes","drawContAtt","drawDiscreteAtt","sorted","sort","a","high","highLeaves","low","lowLeaves","commonNodeStart","maxBranch","thresh","chil","parentBase","base","scaledParentMove","parentScale","xScale","level","getCommonNodes","pathBars","childNodeWrap","childNodes","curve","y","line","commonHover","concat","renderSelectedTopology","attWrap","ch","mappedDis","offset","index","last","dis","spec","maxP","v","notMax","other","findMaxState","attGroups","wrapRect","speciesGrp","lineGenD","attributeHeight","lineGenC","branchGrpDis","sp","bCirc","otherCirc","tool","transition","duration","html","pageX","pageY","ticks","branchGrpCon","MeanRect","scale","confiBars","dataMaster","renderDistibutions","renderSelectedView","commonNode","chosenPath","pathIndex","sortOtherPaths","group","pathRemove","renderComparison","buttonGroupTest","buttonGroup","usedColors","groupColor","newColor","find","compareButtonTest","compareButton","comparisonCombined","newAtt","com","atts","added","standard","variance","first","second","filteredComp","selectedTest","attWraps","normBins","fill","internalNodes","leafNodes","edges","mean","e","sqrt","meanStandard","sigma2","upCon95","lowCon95","leaves","exit","attWrapsEnter","enter","merge","innerWrap","lineGen","pathGroups","missing","areaG","y0","y1","confGroups","conf","NaN","axisGroupTest","axisGroup","maxDiff","newScale","startBins","difArray","diffs","diff","obsDistWrap","histogram","thresholds","newLeaves","xAxis","each","distGroups","groupLength","dimensions","rectWidth","rectHeight","collapsedHeight","getScales","nodeTooltipFlag","collapsed","pathWrapTest","pathWrap","pathAdd","notIt","nodeFilter","getLatestData","renderPaths","shownAttributes","checked","predictedAttrGrps","attribWrap","attrMove","selectedState","filterType","addFilterTag","addFilter","attributeType","updateMainView","nodeList","leafStateFilter","innerTimeline","step","change","height","innerPaths","continuousAtt","continuousPaths","attributeNodesCont","innerBars","rangeRect","drawGroups","stateBins","splitOnArray","newBins","newBinData","scaleName","newData","pa","firstGroupSvg","firstGroup","secondGroup","g","newM","branchBar","drawBranchPointDistribution","groupLabels","stateLabel","innerGroup","innerWrapRect","wrappers","shiftWraps","xAxisShift","shiftCircles","leafWraps","totalVal","totalMean","newVal","groupMean","distcircles","dotVals","w","groupBy","totalArray","leafWrapsD","rects","groupedData","d3Array","width","ratio","drawLeaves","bars","discreteAtt","innerTimelineDis","statePath","disct","attributeNodesDisc","stateDots","endStateDot","stateBars","probability","chosenIn","valueAdd","toolbarControl","toolbar","viewArray","chosenCladesGroup","groups","filterButton","log","filterDiv","normedPaths","moveMetric","selectWrapper","attButton","stateChange","attProps","selectedOption","optKeys","button1","button2","submit","fromState","classList","toState","discreteFilter","filterOb","continRanges","ranges","brushBars","xBrush","extent","selection","handle","invert","brushGroup","selections","_groups","__brush","predictedFilter","observedFilter","lastFilter","continuousFilter","stateFilter","searchDiv","form","input","queryArray","split","toLowerCase","queryFilter","toggleFilters","scrunchButton","toggleScrunch","discreteViewButton","discretePredictedGroups","dropOptions","no","attributeOptions","checkedAttributes","attoptions","cladeOptions","cladeKeeper","dropdivClade","buttonClade","dropContentClade","updateCladeDrop","li","names","binGroups","calculatedScalesKeeper","renderDistStructure","dropUl","cladesGroupKeeper","growSidebarRenderTree","attrDraw","sidebar","cladeBool","traitColorDropDown","renderTreeButtons","renderTree","margin","right","left","lengthHeight","addingEdgeLength","nestedData","treenodes","size","treeSvg","updateCladeTree","assignPosition","array","stepDown","child","findDepth","link","descendants","combEdge","position","parent","notleaves","branchNodes","branchPoint","triangle","clade","uncollapseSub","collapseSub","lengthBool","renderCladeTree","nodeData","findCommonNode","path1","path2","className","subtreeFinder","nodeNames","labelTree","wrap","textInput","addClade","addCladeGroup","clades","observedWidth","predictedWidth","squareDim","timeRange","brushColors","compareColors","light","dark","defaultBarColor","colorBool","selectedClades","groupLabel","branchCount","newNormed","keysToHide","rootNodes","sortedBins","mapNorm","bin","fData","binI","leafAttr","leafData","nodeArray","count","maxO","minO","xO","histogramO","stateKeys","rootNode","colors","entries","histo","h","x1","x0","binWrap","nodeLengthArray","nodeDuplicateCheck","bPointScale","pointGroups","eMove","binsRects","groupBins","branches","axis","axGroup","mainDiv","compareTooltipFlag","filteredAttributes","branchScale","binnedWrap","selected","sum","leafNames","fl","cladeLabel","drawGroupLabels","divWrap","groupHeader","textDiv","branchPointSvg","selectedNodes","from","Set","testNodes","testLinks","pathsListOne","pathsListTwo","testNodesOne","testLinksOne","testNodesTwo","testLinksTwo","mapBins","combined","groupKey","predictedWrap","rootData","contRoot","newy","disRoot","rootStateGroups","maxVal","branchGroup","discreteDist","discreteMiddleGroups","stateRects","av","stateBarsPredicted","xMove","maxBin","maxState","continDist","list","continBinGroups","maxCount","distrib","mirrorlineGen","gindex","brush","parentNode","maxCounts","zero","classLabel","brushedVal","otherBins","descendBins","groupDis","continuousHistogram","oNode","oHisto","oDist","brushedNodes","selectedBranch","secondGrp","doesItExist","datum","classy","notNodes","observedWrap","contOb","contBars","movex","xvalues","discOb","discBars","dRects","offSet","movey","xPoint","padding","renderDistributionComparison","stateBinsPredicted","disWrap","winPosArray","getBoundingClientRect","win","lineThing","brushedDist","otherDist","testH","notNodeNames","notNodeSelectedBranch","notTest","testtest","notTestTest","notNodeSecondGrp","dat","updateRanking","pairs","weights","deltaMax","closeMax","distMax","deltaScale","closeScale","distScale","sortedPairs","delta","deltaRank","closenessRank","distanceRank","totalRank","pairColor","brushes","brushData","pairWraps","scoreWrap","scoreGroups","score","scoreLabel","pairGroupN","species1","species2","neighbors","start","speciesTest","speciesNames","labeledN","spec1N","spec2N","closest1","closest2","branchesN","pairGroup","xAxisG","neighNodes","mouseG","mousePerLine","mouse","xDate","bisect","getElementsByClassName","beginning","end","getTotalLength","floor","pos","getPointAtLength","toFixed","drawSorted","view","document","getElementById","disabled","rankDiv","defaultW","weightPicker","slider","slide","default","displayValue","num","rankingControl","attKeys","drop","generatePairs","removeFilter","filterId","dataFilters","filterIndex","testData","fun","filterFunction","newTestData","newFilterMaster","attType","filFunction","oldData","extra","ex","filterToolbar","formater","nodeId","selectedNode","predicted","observed","numb","filterPred","filterObs","selectorDiv","selectId","dropDownWrapper","buildTreeStructure","getNested","V1","renderCallback","reduce2DropArray","startArray","buttonWrap","phenoOptions","phenogramButton","cladeButton","_children","positionArray","edge","uncollapse","pheno","treemap","groupedBool","sidebarTest","gTest","updateTree","treeData","getLeaves","ids","Clade","collapseTree","yAxis","multinet","tables","links","graph_structure","api_root","workspace","graph","load_tables","nodeTables","node_table","load_nodes","edge_table","edgeTable","load_links","rename_node_vars","rename_link_vars","JSON","parse","stringify","tables_call","nodes_call","table","links_call","_id","_from","_to","savedSelected","attributeList","discreteTraitList","toolbarDiv","load_data","dataLoadAndFormat","then","centData","edgeFile","edgeLengthFile","leafCharFile","resFile","dataName","unique","self","leafChar","edgeLen","char","columns","rows","From","edgeSource","To","newRow","nodeLabels","matchedEdges","attrib","V2","calcLeafAtt","matchedLeaves","all","addedRoot","chosenClade","appLaunch"],"mappings":"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","file":"js/app.40c2cfd8.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Evo-Bio-Design-Study/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([173,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as d3 from 'd3';\n\nexport async function loadData(readFunction, fileString, type){\n    let data = await readFunction(fileString);\n    data.type = String(type);\n    return data;\n}\n\n\n","import * as d3 from \"d3\";\n\nexport const maxTimeKeeper = []\n\n\nexport function pairPaths(pathData, field){\n\n\n    return pathData.flatMap((path, i)=> {\n        let pairs = pathData.filter((f, j)=> j != i);\n        let paired =  pairs.map((p)=> {\n            return {'p1': path, 'p2': p}\n        });\n        return paired.map(m=> {\n            m.distance = getDistance(m);\n            m.deltas = calculateDelta(m, field);\n            m.closeness = calculateCloseness(m, field);\n            \n            return m;\n        })\n    })\n}\n\nfunction getDistance(pair){\n    let verts = pair.p2.map(m=> m.node);\n\n    let test = pair.p1.filter(f=> verts.indexOf(f.node) != -1);\n    let lastNode = test[test.length - 1].node;\n\n    let p1Index = pair.p1.map(m=> m.node).indexOf(lastNode);\n    let p2Index = pair.p2.map(m=> m.node).indexOf(lastNode);\n  \n    let p1 = pair.p1.filter((f, i)=> i >= p1Index);\n    let p2 = pair.p2.filter((f, i)=> i >= p2Index);\n\n    pair.common = pair.p1[p1Index]\n\n    return d3.sum(p1.map(m=> m.edgeLength)) + d3.sum(p2.map(m=> m.edgeLength));\n}\n\nfunction calculateDelta(pair, field){\n   \n    let verts = pair.p2.map(m=> m.node);\n\n    let test = pair.p1.filter(f=> verts.indexOf(f.node) != -1);\n    let lastNode = test[test.length - 1].node;\n\n    let p1Index = pair.p1.map(m=> m.node).indexOf(lastNode);\n    let p2Index = pair.p2.map(m=> m.node).indexOf(lastNode);\n  \n    let p1 = pair.p1.filter((f, i)=> i >= p1Index);\n    let p2 = pair.p2.filter((f, i)=> i >= p2Index);\n\n \n    let range = maxTimeKeeper[0] - p1[0].combLength;\n    let binCount = d3.max([p1.length, p2.length])\n    let binStep = range / binCount;\n   \n    let bins = [...new Array(binCount-1)].map((d, i)=> {\n        return {'bottom': p1[0].combLength + (i*binStep), 'top': p1[0].combLength + ((i+1)*binStep) }\n    })\n   \n    bins = bins.map((d, i)=> {\n        let one = p1.filter(f=> (f.combLength <= d.top) && (f.combLength >= d.bottom))\n        let two = p2.filter(f=> (f.combLength <= d.top) && (f.combLength >= d.bottom))\n        d.one = one;\n        d.two = two;\n        return d;\n    });\n\n    bins = bins.map((b, i)=> {\n        if(b.one.length === 0){\n            b.one = bins[i-1].one;\n        }\n        if(b.two.length === 0){\n            b.two = bins[i-1].two;\n        }\n\n        return b;\n    })\n    \n    let attributes = d3.entries(p1[0].attributes)\n                    .filter(f => f.value.type === 'continuous')\n                    .map(m=> {\n                        let name = m.key;\n                        let valdiffs = bins.map((b, i)=> {\n                            return Math.abs(b.one[0].attributes[name].values.realVal - b.two[0].attributes[name].values.realVal);\n                        });\n                        m.value = d3.max(valdiffs)\n                        return m;\n                    });\n\nreturn attributes;\n\n}\n\nfunction calculateCloseness(pair, field){\n let leaf1 = pair.p1.filter(p=> p.leaf === true)[0].attributes;\n let leaf2 = pair.p2.filter(p=> p.leaf === true)[0].attributes;\n\n return d3.entries(leaf1).filter(f=> f.value.type === 'continuous').map(m=> {\n    \n     m.value = Math.abs(m.value.values.realVal - leaf2[m.key].values.realVal);\n     return m\n });\n}\n\nexport function calculateNewScales(attributes, keyList, colorKeeper){\n\n    return keyList.map((d, i)=> {\n\n        let attData = attributes.flatMap(f=> f[d]);\n        let color = colorKeeper[i] != undefined ? colorKeeper[i][0] : colorKeeper[0][0];\n       \n        if(attData[0].type == 'continuous'){\n            \n            let max = d3.max(attData.flatMap(m=> m.values.upperCI95));\n            let min = d3.min(attData.flatMap(m=> m.values.lowerCI95));\n            let mean = d3.mean(attData.flatMap(m=> m.values.realVal));\n\n            return {\n                'field': d, \n                'type':'continuous',\n                'max': max, \n                'min':  min,\n                'yScale': d3.scaleLinear().range([0, 43]).domain([min, max]).clamp(true),\n                'satScale': d3.scaleLinear().range([0, .9]).domain([min, max]),\n                'colorScale': d3.scaleLinear().range([color, '#f23929']).domain([min, max]),\n                'catColor': color,\n            };\n        }else{\n            let scaleCat = d3.keys(attData[0].values);\n            return { \n                'field': d,\n                'type':'discrete',\n                'stateColors': scaleCat.map((sc, j)=> {\n                    return {'state': sc, 'color': colorKeeper[j][0]};\n                }),\n                'catColor': color,\n                'scales': scaleCat.map(sc=> {\n                let scaleName = sc;\n               \n                let max = 1;\n                let min = 0;\n                return {\n                    'field': d, \n                    'scaleName': scaleName,\n                    'max': max, \n                    'min':  min,\n                    'yScale': d3.scaleLinear().range([45, 0]).domain([min, max]),\n                };\n                \n            }) };\n        }\n    });\n}\n\nexport function calculateScales(calculatedAtt, colorKeeper){\n    return Object.keys(calculatedAtt).map((d, i)=> {\n       \n        if(calculatedAtt[d].type == 'continuous'){\n            \n            let max = d3.max(calculatedAtt[d].rows.map(m=> m.upperCI95));\n            let min = d3.min(calculatedAtt[d].rows.map(m=> m.lowerCI95));\n            let mean = d3.mean(calculatedAtt[d].rows.map(m=> m.realVal));\n            \n            return {\n                'field': d, \n                'type':'continuous',\n                'max': max, \n                'min':  min,\n                'yScale': d3.scaleLinear().range([0, 43]).domain([min, max]).clamp(true),\n                'satScale': d3.scaleLinear().range([0, .9]).domain([min, max]),\n                'colorScale': d3.scaleLinear().range([colorKeeper[i][0], '#f23929']).domain([min, max]),\n                'catColor': colorKeeper[i][0],\n            };\n        }else{\n            let scaleCat = calculatedAtt[d].fields.filter(f=> f!= 'nodeLabels');\n            return { \n                'field': d,\n                'type':'discrete',\n                'stateColors': scaleCat.map((sc, i)=> {\n                    return {'state': sc, 'color': colorKeeper[i][0]};\n                }),\n                'catColor': colorKeeper[i][0],\n                'scales': scaleCat.map(sc=> {\n                let scaleName = sc;\n               \n                let max = 1;\n                let min = 0;\n                return {\n                    'field': d, \n                    'scaleName': scaleName,\n                    'max': max, \n                    'min':  min,\n                    'yScale': d3.scaleLinear().range([45, 0]).domain([min, max]),\n                };\n                \n            }) };\n        }\n    });\n}\n\nexport function matchLeaves(labels, leaves, leafChar, calculatedScales){\n\n        ////MATCHING LABELSS TO THE STUFF/////\n    let  mappedLeafLabels = labels.rows.map(m=> {\n        let label = m.x;\n        return label;\n    });\n\n    return leaves.map((leaf, i)=> {\n      \n        leaf.label = mappedLeafLabels[i];\n\n        //let leafCharIndex = leafChar.rows.map(m=> m[\"\"]);\n      \n        let leafCharIndex = leafChar.rows[0][\"\"] ? leafChar.rows.map(m=> m[\"\"]) : leafChar.rows.map(m=> m[\"species\"]);\n  \n        leaf.node = leaf.V2;\n        let keys = calculatedScales.map(m=> m.field);\n        let attr = {};\n         \n        let chosenOne = leafChar.rows[leafCharIndex.indexOf(leaf.label)];\n \n        keys.forEach((k)=> {\n             let scaleOb = calculatedScales.filter(f=> f.field == k)[0];\n            \n             if(scaleOb.type === 'discrete'){\n                 let thisScale = scaleOb.scales.filter(f=> f.scaleName == chosenOne[k])[0].yScale;\n                 let states = scaleOb.scales.map(m=> m.scaleName).map(state=> {\n                     let value = (state === chosenOne[k])? 1 : 0;\n                    // return {'state': state,  scaleVal: thisScale(value), realVal: value};\n                     return {'state': state, realVal: value};\n                 });\n                 //let states = {'state': leafChar.rows[i][k],  scaleVal: thisScale(1), realVal: 1}\n                 attr[k] = {'states': states, 'label': k, 'type': scaleOb.type, leaf: true};\n             }else if(scaleOb.type === 'continuous'){\n                 let scale = scaleOb.yScale;\n                 //attr[k] = {'scaleVal': scale(chosenOne[k]), 'scaledHigh': 0, 'scaledLow': 0, 'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n                 attr[k] = {'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n \n             }else{\n                 attr[k] = 'error in leaf matching';\n             }\n         });\n\n         leaf.clade = chosenOne.clade;\n         leaf.attributes = attr;\n         leaf.leaf = true;\n     \n         return leaf;\n     });\n}\n\nexport function matchEdges(edges, edgeLen, calculatedAtt, calculatedScales){\n    return edges.rows.map((edge, i)=> {\n        let attrKeys = Object.keys(calculatedAtt);\n        let index = calculatedAtt[attrKeys[0]].rows.map(m=> m['nodeLabels']).indexOf(edge.V2);\n        edge.edgeLength = edgeLen.rows[i].x;\n        edge.node = edge.V2;\n        if(index > -1){ \n            attrKeys.forEach(attr=> {\n                if(calculatedAtt[attr].type == 'continuous'){\n                    let scale = calculatedScales.filter(f=> f.field == attr)[0].yScale;\n                    let res = calculatedAtt[attr].rows[index];\n                   // res.scaleVal = scale(res.estimate);\n                   // res.scaledLow = scale(res.lowerCI95);\n                    //res.scaledHigh = scale(res.upperCI95);\n                    res.realVal = res.estimate;\n                    res.type = 'continuous';\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = res;\n                }else{\n                    let scales = calculatedScales.filter(f=> f.field == attr)[0].scales;\n                    let row = calculatedAtt[attr].rows[index];\n                    let states = scales.map(s=> {\n                       // return {'state': s.scaleName,  scaleVal: s.yScale(row[s.scaleName]), realVal: row[s.scaleName]};\n                        return {'state': s.scaleName, realVal: row[s.scaleName]};\n                    });\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = {'states':states, 'type': 'discrete'};\n                }\n            });\n        }\n        return edge;\n    });\n\n}\nexport function rootAttribute(paths, calculatedAtt, calculatedScales){\n\n    let rootAtt = calculatedAtt.filter(f=> f.node === paths[0][0].node)[0];\n\n    Object.keys(rootAtt).filter(f=> f != 'node').map(att=> {\n        rootAtt[att].scales = calculatedScales.filter(f=> f.field === att)[0];\n    });\n\n    return paths.map((p, i)=> {\n        p[0].attributes = rootAtt;\n        p[0].root = true;\n        return p\n    });\n\n};\nexport function combineLength(paths){\n\n    let maxTime = paths.map(path=> d3.sum(path.map(p=> p.edgeLength)))[0];\n    maxTimeKeeper.push(maxTime);\n    return paths.map(path=> {\n        return path.map((node, i, n)=> {\n            node.maxTime = maxTime;\n            node.combLength = d3.sum(n.filter((f, j)=> i >= j).map(m=> m.edgeLength));\n            return node;\n        })\n    })\n\n}\n\n// export function normPaths(paths, calculatedAtt, calculatedScales){\n//     paths.forEach((p, i)=> {\n//         p[0].attributes = {};\n//         Object.keys(calculatedAtt).map(att=> { \n//             if(calculatedAtt[att].type == 'continuous'){\n//                 let root = calculatedAtt[att].rows.filter(f=> (f.nodeLabels == p[0].node) || (f.nodeLabels == ('node ' + p[0].node)))[0];\n//                 p[0].attributes[att] = {};\n                \n//                 let scale = calculatedScales.filter(f=> f.field == att)[0].yScale;\n            \n//                 p[0].attributes[att].realVal = root.estimate;\n//                 p[0].attributes[att].upperCI95 = root.upperCI95;\n//                 p[0].attributes[att].lowerCI95 = root.lowerCI95;\n//                 p[0].attributes[att].scale = scale;\n//                 p[0].attributes[att].type = 'continuous';\n//             }else if(calculatedAtt[att].type == 'discrete'){\n//                 let root = calculatedAtt[att].rows.filter(f=> f.nodeLabels == p[0].node)[0];\n//                 let scales = calculatedScales.filter(f=> f.field == att)[0].scales;\n//                 let rootAttr = scales.map(s=> {\n//                     //return {'state': s.scaleName,  scaleVal: s.yScale(root[s.scaleName]), realVal: root[s.scaleName]};\n//                     return {'state': s.scaleName, realVal: root[s.scaleName]};\n//                 });\n//                 p[0].attributes[att] = {'states':rootAttr, 'type': 'discrete'};\n               \n//             }else{\n//                 console.error('type not found');\n//             }\n//         });\n//     });\n    \n//     let maxBranch = d3.max(paths.map(r=> r.length));\n\n//     //SCALES for X, Y /////\n//     let xScale = d3.scaleLinear().range([0, 1000]).clamp(true);\n \n//     let normedPaths = paths.map((p, i)=> {\n//         p.xScale = xScale.domain([0, maxBranch - 1]);\n     \n//         let leafIndex = p.length - 1;\n//         let lengths = p.map(l=> l.edgeLength);\n//         let prevStep = 0;\n//         return p.map((m, j)=> {\n//             let node = Object.assign({}, m);\n//             //INTEGRATE THE DISTNACES HERE WHEN THEY WORK\n//             let step = node.edgeLength + prevStep;\n//             node.edgeMove = (j < leafIndex) ? step : 1;\n//             prevStep = prevStep + node.edgeLength;\n         \n//             node.move = (j < leafIndex) ? p.xScale(j) : p.xScale(maxBranch - 1);\n        \n//             return node;\n//         });\n//     });\n\n//     return normedPaths;\n// }\n\nexport function filterKeeper(){\n\n    this.filterArray = new Array();\n    this.attributeFilter = false;\n\n    this.addFilter = function(filter){\n        this.filterArray.push(filter);\n        return this.filterArray;\n    };\n    this.removeFilter = function(index){\n        this.filterArray = this.filterArray.filter((f, i)=> i != index);\n        return this.filterArray;\n    };\n}\n\nexport function formatAttributeData(pathData, scales, filterArray){\n\n\n\n    let keys = (filterArray == null)? Object.keys(pathData[0][0].attributes).filter(f=> f != 'node' && f != 'leaf' && f != 'length' && f != 'root'): filterArray;\n   \n    let newData = pathData.map(path=> {\n        return keys.map((key)=> {\n            return path.map((m)=> {\n                let speciesLabel = path[path.length - 1].node;\n                \n                if(m.attributes[key].type === 'continuous'){\n                    m.attributes[key].species = speciesLabel;\n                    m.attributes[key].color = scales.filter(f=> f.field === key)[0].catColor;\n                    m.attributes[key].move = m.combineLength;\n                    m.attributes[key].combLength = m.combLength;\n                    m.attributes[key].node = m.node;\n                    m.attributes[key].edgeMove = m.edgeLength;\n                    m.attributes[key].edgeLength = m.edgeLength;\n                    m.attributes[key].label = key;\n                    m.attributes[key].yScale = m.attributes[key].scales.yScale;\n                    m.attributes[key].satScale = m.attributes[key].scales.satScale;\n                    m.attributes[key].colorScale = m.attributes[key].scales.colorScale;\n                    if(m.leaf){\n                        m.attributes[key].leaf = m.leaf;\n                    }\n                    m.attributes[key].leaf = m.leaf;\n                    return m.attributes[key];\n                }else if(m.attributes[key].type === 'discrete'){\n                    if(m.leaf === true){\n                        let states = d3.entries(m.attributes[key].values);\n                     \n                        m.attributes[key].leaf = m.leaf;\n                        let state = m.attributes[key];\n                        state.states = {field: key, state: m.attributes[key].values[key]}\n                        state.species = speciesLabel;\n                        state.winState = m.attributes[key].values[key] ?  m.attributes[key].values[key] : d3.entries(m.attributes[key].values);\n                        state.color = m.attributes[key].scales.stateColors.filter(f=> {\n                            return f.state.includes(state.winState)})[0].color;\n\n                        \n                        state.move = m.combLength;\n                        state.combLength = m.combLength;\n                        state.node = m.node;\n                        state.edgeMove = m.edgeLength;\n                        state.edgeLength = m.edgeLength;\n                        state.attrLabel = key;\n                        return state;\n                    }else{\n                        let states = m.attributes[key].states ? m.attributes[key].states : d3.entries(m.attributes[key].values);//.filter(f => f.state != undefined);\n\n                        return states.map((st, j)=> {\n                            st.state = st.key;\n                            st.value = st.value;\n                            \n                            st.color = m.attributes[key].scales.stateColors.filter(f=> f.state === st.key)[0];\n                           \n                            st.move = m.combLength;\n                            st.combLength = m.combLength;\n                            st.node = m.node;\n                            st.edgeMove = m.edgeLength;\n                            st.edgeLength = m.edgeLength;\n                            st.attrLabel = key;\n                            st.species = speciesLabel;\n                            return st;\n                        });\n                    }\n             \n                }else{\n                    console.error('attribute type not found');\n                }\n            });\n        });\n    });\n    return newData;\n}","/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {array of leaf nodes in graph} leafArray \n * @param {string for property} source\n * @param {string for property} target  \n */\nexport function allPaths(edgeArray, leafArray, source, target){\n    return leafArray.map(le=> getPath(edgeArray, le, [le], source, target));\n}\n\nexport function getNested(node, edgeArray){\n    node.children = edgeArray.filter(f=> String(f.V1) === String(node.node));\n    node.name = String(node.node);\n    if(node.children.length > 0){\n        node.children.forEach(c=> getNested(c, edgeArray));\n    }else{\n        return node;\n    }\n    return node;\n}\n\nexport function calculateMovingAverage(data, i) {\n\n    if (movingAverage === 0) {\n        return data[i][yValue];\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        sum += x;\n    }\n\n    return sum / count;\n};\n\nexport function calculateMovingStandardDeviation(data, i, avg) {\n\n    if (movingAverage === 0) {\n        return 0;\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        var dx = x - avg;\n        sum += (dx * dx);\n    }\n\n    var variance = sum / count;\n    return Math.sqrt(variance);\n};\n\n/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {one row of the leaf array} leaf \n * @param {array that holds the constructed path} pathKeeper \n * @param {string for source header} source (V1)\n * @param {string for target header} target (V2)\n */\nexport function getPath(edgeArray, leaf, pathKeeper, source, target){\n    \n    let path = edgeArray.filter(ed=> {\n        return ed[target] === leaf[source];\n    });\n    \n    if(path.length > 0){\n        pathKeeper.push(path[0]);\n        return getPath(edgeArray, path[0], pathKeeper, source, target);\n    }else{\n        pathKeeper.push({'root': true, 'node': leaf[source], 'edgeLength': 0.0});\n        return pathKeeper.reverse();\n    }\n}\n\n\n/**\n * \n * @param {*} pathArray \n * @param {*} nodes \n * @param {*} arrayOfArray \n * @param {*} nameArray \n * @param {*} depth \n */\nexport function pullPath(pathArray, nodes, arrayOfArray, nameArray, depth){\n\n    nodes.forEach((node, i)=> {\n        node.depth = depth;\n        node.id = depth + '.' + i;\n       // node.edgeLength = node.edge_data.weight;\n        if(notEmpty(node.children)){\n            pathArray.push(Object.assign({}, node));\n            pullPath([...pathArray], [...node.children], arrayOfArray, nameArray, depth+1);\n        }else{\n            nameArray.push(node.node);\n            node.flag = true;\n            arrayOfArray.push([...pathArray, Object.assign({},node)]);\n        }\n    });\n    return arrayOfArray;\n}\n\nfunction notEmpty(childArray){\n    if(childArray == undefined){\n        return false;\n    }else if(childArray.length == 0){\n        return false;\n    }else{\n        return true;\n    }\n}\n","import * as d3 from \"d3\";\n\nexport function dropDown(div, optionArray, dropText, dropId){\n    let dropdiv = div.append('div').classed(`dropdown ${dropId}`, true);\n    dropdiv.style('display', 'inline-block')\n    let button = dropdiv.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text(dropText);\n    let dropContent = dropdiv.append('div').attr('id', dropId).classed('dropdown-content', true);\n    dropContent.append('a').text('text').attr('font-size', 11);\n    let options = dropContent.selectAll('a').data(optionArray).join('a').text(d=> d.field);\n\n    options.on('click', (d, i, n)=> dropContent.classed('show', false));\n\n    button.on('click', (d, i, n)=> {\n        if(dropContent.classed('show')){\n            dropContent.classed('show', false);\n        }else{\n            dropContent.classed('show', true);\n        }\n    });\n    options.raise()\n    return options;\n}\n\nexport function updateDropdown(optionArray, dropId){\n    d3.select(`#${dropId}`).selectAll('a').data(optionArray).join('a').text(d=> d.field);\n}","import * as d3 from \"d3\";\nimport { branchPaths, renderPaths, renderAttributes, drawContAtt, drawDiscreteAtt, drawPathsAndAttributes } from './renderPathView';\nimport { formatAttributeData } from './dataFormat';\nimport { filterMaster } from './filterComponent';\nimport { dataMaster, collapsed, colorKeeper } from './index';\nimport { renderDistibutions } from \"./distributionView\";\n\nexport let selectedPaths = [];\nexport let comparisonKeeper = [];\n\nexport function pathSelected(selectedPath, otherPaths, scales) {\n\n    let selectedDiv = d3.select('div#selected');\n    let main = d3.select('div#main');\n    if (selectedPath === null) {\n\n        selectedPaths = [];\n\n        d3.select('div#selected').selectAll('*').remove();\n        selectedDiv.style('height', 0);\n        d3.select('div#main').style('padding-top', '0px');\n        let main = d3.select('div#main');\n        drawPathsAndAttributes([...otherPaths], main, scales, false);\n\n    } else {\n      \n        selectedPaths = selectedPaths.concat(selectedPath);\n        let commonNodes = renderSelectedView([...selectedPaths], [...otherPaths], selectedDiv, scales);\n        let sortedPaths = sortOtherPaths([...selectedPaths], [...otherPaths], [...commonNodes]);\n        \n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let pathGroups = drawPathsAndAttributes(sortedPaths.map(s => s.data), main, scales, false);\n\n        main.style('padding-top', '250px');\n    }\n}\nfunction getCommonNodes(paths){\n    let maxBranch = d3.max(paths.map(p => p.length));\n    let longestBranch = paths.filter(path => path.length === maxBranch)[0];\n    let startBranch = longestBranch.filter(f=> f.leaf != true);\n    let commonNodeStart = startBranch;\n    //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n    paths.map(path => {\n        commonNodeStart = [...path].filter(f => {\n            return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n    });\n\n    let children = paths.map(path => {\n        path = (path[0].leaf === true) ? path.reverse() : path;\n        let nodeIndex = path.map(p => p.node);\n        let thresh = nodeIndex.indexOf(commonNodeStart[commonNodeStart.length - 1].node);\n        let subset = path.filter((f, i) => i > thresh);\n        return subset;\n    });\n\n    commonNodeStart[commonNodeStart.length - 1].children = children.map((path, i) => {\n        let max = d3.max(path.map(p => p.edgeMove)) - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n        return path.map((chil, j, n) => {\n            chil.parentBase = commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.move = chil.edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.base = (j === 0) ? 0 : n[j - 1].edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            let parentScale = d3.scaleLinear().domain([0, 1]).range([0, 1000])\n            let scaledParentMove = parentScale(commonNodeStart[commonNodeStart.length - 1].edgeMove);\n            chil.xScale = d3.scaleLinear().domain([0, max]).range([0, (1000 - scaledParentMove)]);\n            chil.level = i;\n            return chil;\n        });\n    });\n\n    return commonNodeStart;\n}\nexport function sortOtherPaths(pathData, otherPaths, commonNode) {\n\n    if(pathData.length > 1){\n\n        if(commonNode != null){\n\n            let chosenPath = commonNode.reverse().map(m => m.node);\n            let rankedPaths = otherPaths.map(path => {\n                let step = 0;\n                let test = path.reverse().map((node, i) => {\n                    if (chosenPath.indexOf(node.node));\n                    return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n                }).filter(f => f.indexOf > -1);\n                let distance = (test[0].indexOf + test[0].pathIndex);\n                return { 'data': path.reverse(), 'distance': distance };\n            });\n            let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        \n            return sortedData;\n        }\n        console.error('multiple paths without common node');\n    }else{\n\n        let chosenPath = pathData[0].reverse().map(m => m.node);\n    \n        let rankedPaths = otherPaths.map(path => {\n            let step = 0;\n            let test = path.reverse().map((node, i) => {\n                if (chosenPath.indexOf(node.node));\n                return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n            }).filter(f => f.indexOf > -1);\n            let distance = (test[0].indexOf + test[0].pathIndex);\n            return { 'data': path.reverse(), 'distance': distance };\n        });\n        let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        return sortedData;\n    }\n\n}\nfunction renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency){\n\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', 'translate(0, 20)')\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data([commonNodeStart]).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n        pathBars.attr('height', (35 + (25 * commonNodeStart[commonNodeStart.length - 1].children.length)));\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales)\n\n        /////////\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(145, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', (d, i) => {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n                return x(d[d.length - 1].edgeMove)\n            })\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        nodeGroups.classed('common-node', true);\n\n        let childNodeWrap = nodeGroups.filter(c => c.children != undefined).selectAll('g.child').data(d => d.children).join('g').classed('child', true);\n\n        let childNodes = childNodeWrap.selectAll('g.node').data(d => d).join('g').classed('node', true)\n        childNodes.attr('transform', (d, i, n) => {\n            return 'translate(' + d.xScale(d.move) + ', ' + (d.level * 20) + ')';\n        });\n\n        childNodeWrap.append('path').attr('d', (d, i, n) => {\n            let pathArray = [{ 'x': 0, 'y': 0 }, { 'x': 0, 'y': i }];\n            d.map(m => {\n                pathArray.push({ 'x': m.xScale(m.move), 'y': m.level })\n            });\n            let line = d3.line()\n                .curve(d3.curveMonotoneY)\n                .x(function(d) {\n                    return d.x;\n                })\n                .y(d => (d.y * 20))\n            return line(pathArray);\n        }).attr('stoke-width', '2px').attr('fill', 'none').attr('stroke', 'gray');\n\n        childNodeWrap.on('mouseover', (d, i)=> {\n            let specArray = d.map(m=> m.species);\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let commonHover = [...commonNodeStart].map(c=> c.node).concat(d.map(n=> n.node));\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            treeLinks.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', (d, i)=> {\n            d3.selectAll('.hover').classed('hover', false);\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        let childCirc = childNodes.append('circle').attr('r', 7).attr('fill', 'red').attr('y', 5);\n\n        childCirc.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        childNodes.filter(f => f.leaf === true).append('text').text(d => d.label).attr('x', 9).attr('y', 4);\n        //selectWrap.attr('transform', 'translate('+(50+(20 *commonNodeStart[commonNodeStart.length - 1].children.length))+')')\n       \n\n}\nexport function addRemoveBubble(group, scales){\n\n    let pathRemove = group.append('g').classed('x-icon', true);\n    pathRemove.attr('transform', 'translate(15, 10)');\n    pathRemove.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathRemove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n    pathRemove.style('cursor', 'pointer');\n    pathRemove.on('click', (d, i, n) => {\n        d3.selectAll('.high').classed('high', false);\n        d3.selectAll('.low').classed('low', false);\n        treeNodes.select('.selected').classed('selected', false);\n        pathSelected(null, dataMaster[0], scales);\n    });\n\n}\nexport function renderComparison(group, otherPaths, selectedDiv, scales){\n \n    let buttonGroupTest = selectedDiv.select('.button-wrap');\n    let buttonGroup = buttonGroupTest.empty() ? selectedDiv.append('div').classed('button-wrap', true) : buttonGroupTest;\n\n\n    \n    buttonGroup.style('display','inline-block').style('width', '900px').style('height', '50px');\n    let main = d3.select('div#main');\n    main.style('padding-top', '300px');\n\n    if(group != null){\n        let usedColors = comparisonKeeper.map(m=> m.groupColor);\n        let newColor = colorKeeper.find(c => usedColors.indexOf(c[0]) === -1);\n        group.groupColor = newColor[0];\n        comparisonKeeper.push(group);\n    }\n\n    if(comparisonKeeper.length > 1){\n        let compareButtonTest = d3.select('#toolbar').select('#compare-button');\n        let compareButton = compareButtonTest.empty() ? d3.select('#toolbar').append('button').text('Normal Mode').attr('id', 'compare-button').classed('btn btn-info', true) : compareButtonTest;\n        compareButton.on('click', ()=> {\n            compareButton.text() === \"Normal Mode\" ? compareButton.text('Compare Mode') : compareButton.text('Normal Mode');\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        });\n    }\n\n    let comparisonCombined = scales.map((sc, i)=> {\n        let newAtt = {'field': sc.field, 'type': sc.type, 'data': []}\n        comparisonKeeper.map((com, i)=> {\n            let atts = formatAttributeData(com.data, scales, [sc.field]);\n           \n            let added = atts.flatMap(att=> {\n                return att.map(a => {\n                    return a.map(m=> {\n                        let standard = m.leaf === true ? 0 : (m.upperCI95 - m.realVal) / 2;\n                        m.variance = standard * standard;\n                        return m;\n                    });\n                })\n            })\n\n            newAtt.data.push({'group': {'first': com.first, 'second': com.second, 'color': com.groupColor}, 'data': sc.type === 'continuous' ? added : atts.flatMap(a=> a)});\n        })\n        return newAtt;\n    });\n\n    let button = buttonGroup.selectAll('button').data(comparisonKeeper).join('button').classed('btn btn-info', true).style('background', d=> d.groupColor);\n    button.selectAll('span').data(t=> [t]).join('span').text(t=> {\n        return t.first ? `${t.first[1]} / ${t.second[1]}` : t.state;\n    }).append('span').text(t=> t.data.length).classed(\"badge badge-light\", true)\n    \n    let xOut = button.selectAll('i').data(d=> [d]).join('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    xOut.on('click', (d, i)=> {\n        let filteredComp = comparisonKeeper.filter(f=> f.groupColor != d.groupColor);\n        comparisonKeeper = filteredComp;\n        if(comparisonKeeper.length > 0){\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        }else{\n            selectedDiv.selectAll('*').remove();\n            selectedDiv.style('height', '0px');\n            main.style('padding-top', '0px');\n        }\n    });\n\n    let selectedTest = selectedDiv.select('.comparison-svg');\n    let selectedTool = selectedTest.empty() ? selectedDiv.append('svg').classed('comparison-svg', true) : selectedTest;\n    selectedDiv.style('height', '300px').style('width', '100%');\n    selectedTool.style('height', '300px');\n\n    let attWraps = selectedTool.selectAll('.att-wrapper').data(comparisonCombined.filter(f=> f.type === 'continuous').map((com)=>{\n       \n        let max = d3.max(com.data.flatMap(d=> d.data.flatMap(m=> m.map(f=> f.upperCI95)))) + .2;\n        let min = d3.min(com.data.flatMap(d=> d.data.flatMap(m=> m.map(f=> f.lowerCI95)))) - .2;\n        \n        com.data.map(c=> {\n            let binLength = 6;\n            //let max = scales.filter(f=> f.field === com.field)[0].max;\n           // let min = scales.filter(f=> f.field === com.field)[0].min;\n            let normBins = new Array(binLength).fill().map((m, i)=> {\n                let step = 1 / binLength;\n                let base = (i * step);\n                let top = ((i+ 1)* step);\n                return {'base': base, 'top': top, 'binI': i, 'max': max, 'min':min }\n            });\n\n            let internalNodes = c.data.map(path => path.filter(node=> node.leaf != true));\n            let leafNodes = c.data.flatMap(path => path.filter(node=> node.leaf === true));\n\n            c.bins = normBins.map((n, i, nodes)=> {\n                let edges = internalNodes.flatMap(path => path.filter(node=> {\n                    return node.edgeMove >= n.base && node.edgeMove <= n.top;\n                } ));\n                n.data = edges;\n                let mean = d3.mean(edges.map(e=> e.realVal));\n                n.mean = mean === undefined ? normBins[i-1].mean : mean;\n                let standard = Math.sqrt(d3.mean(edges.map(e=> e.variance)));\n                n.meanStandard = edges.length === 0 ? 0 : standard;\n                let sigma2 = standard * 2;\n                n.upCon95 = mean === undefined ? normBins[i-1].upCon95 : mean + sigma2;\n                n.lowCon95 = mean === undefined ? normBins[i-1].lowCon95 : mean - sigma2;\n                return n;\n            });\n            c.leaves = leafNodes;\n           \n            return c;\n        })\n        \n        return com;\n    }));\n    attWraps.exit().remove();\n    let attWrapsEnter = attWraps.enter().append('g').classed('att-wrapper', true);\n\n    let attLabels = attWrapsEnter.append('text').text(d=> d.field).style('text-anchor', 'end')\n                    .style('font-size', '11px').attr('transform', 'translate(120, 35)');\n\n    attWraps = attWrapsEnter.merge(attWraps);\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+(10+(i * 70))+')');\n\n    let innerWrap = attWraps.selectAll('g.inner-group').data(d=> [d]).join('g').classed('inner-group', true);\n    innerWrap.attr('transform', 'translate(150, 0)');\n    let wrapRect = innerWrap.selectAll('rect.outline-rect').data(d=> [d]).join('rect').classed('outline-rect', true)\n                    .attr('width', 800).attr('height', 60).attr('fill', '#fff').attr('stroke', 'gray');\n    \n    if(d3.select('#compare-button').empty() || d3.select('#compare-button').text() === \"Normal Mode\"){\n            let lineGen = d3.line()\n            .x((d, i)=> {\n                let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n                return x(i);\n            })\n            .y(d=> {\n            let y = d3.scaleLinear().domain([d.min, d.max])\n                y.range([60, 1]);\n                return y(d.mean);\n    });\n\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> d.data).join('g').classed('path-groups', true);\n    pathGroups.selectAll('*').remove();\n    let paths = pathGroups.append('path').attr('d', d=> { \n        let scale = d.bins[0].data[0].yScale\n        d.bins = d.bins.map((b, i, n)=> {\n            if(b.mean === undefined){\n                b.mean = d.bins[i-1].mean;\n                d.missing = true;\n            }\n           \n            b.yScale = d3.scaleLinear().domain([b.min, b.max]).range([60, 1])\n            return b;\n        });\n        return lineGen(d.bins);\n    }).classed('path', true);\n\n    var areaG = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i)=> {\n        let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n        return x(i);\n    })\n    .y0(d=> {\n        let y = d.yScale;\n        y.range([60, 1]);\n     \n        return y(d.lowCon95);\n    })\n    .y1(d=> {\n        let y = d.yScale;\n        y.range([60, 1]);\n     \n        return y(d.upCon95); \n    });\n\n    let confGroups = innerWrap.selectAll('g.conf-groups').data(d=> d.data).join('g').classed('conf-groups', true);\n    confGroups.selectAll('*').remove();\n    let conf = confGroups.append('path').attr('d', d=> { \n        d.bins = d.bins.map((b, i, n)=> {\n            if(b.upCon95 === NaN){\n                b.upCon95 = d.bins[i-1].upCon95;\n                d.missing = true;\n            }\n            if(b.lowCon95 === NaN){\n                b.lowCon95 = d.bins[i-1].lowCon95;\n                d.missing = true;\n            }\n\n            return b;\n        });\n        return areaG(d.bins);\n    }).classed('path', true);\n\n    paths.style('fill', 'none');\n    paths.style('stroke', d=> d.group.color);\n    paths.style('stroke-width', '2px');\n\n    conf.style('fill', d=> d.group.color);\n    conf.style('opacity', 0.15);\n\n    let yAxisG = innerWrap.append('g').classed('y-axis', true);\n\n    innerWrap.on('mousemove', function(d, i) {\n     \n        let scale = d3.scaleLinear().domain([d.data[0].bins[0].min, d.data[0].bins[0].max]).range([1, 60]);\n        let axisGroupTest = d3.select(this).select('.y-axis');\n        let axisGroup = axisGroupTest.empty() ? d3.select(this).append('g').classed('y-axis', true) : axisGroupTest;\n        \n        if(d3.select('#compare-button').empty() || d3.select('#compare-button').text()==='Normal Mode'){\n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)')\n            axisGroup.call(d3.axisLeft(scale).ticks(5));\n        }else{\n            let pathD = d3.select(this).select('.path-groups').selectAll('path');\n            let maxDiff = pathD.data().map(d=> d[0].maxDiff)[0];\n            \n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)');\n            let newScale = d3.scaleLinear().domain([maxDiff, 0]).range([0, 60]);\n            axisGroup.call(d3.axisLeft(newScale).ticks(5));\n        }\n\n    \n    }).on('mouseleave', function(){\n        let axisGroup = d3.select(this).select('.y-axis');\n        axisGroup.remove();\n    });\n    \n}else{\n\n    innerWrap.selectAll('.path-groups').remove();\n    innerWrap.selectAll('g.conf-groups').remove();\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> {\n        let startBins = d.data[0].bins;\n        let difArray = [];\n        for(let i = 1; i < d.data.length; i ++){\n            let diffs = []\n            d.data[i].bins.map((b, j)=>{\n                if(b.mean === undefined){\n                    b.mean = d.data[i].bins[j-1].mean;\n                }\n                if(startBins[j].mean === undefined){\n                    startBins[j].mean = startBins[j-1].mean;\n                }\n                let maxDiff = d.data[0].bins[0].max - d.data[0].bins[0].min;\n                diffs.push({'diff':Math.abs(startBins[j].mean - b.mean), 'maxDiff': maxDiff});\n            });\n            difArray.push(diffs);\n        }\n        return difArray;\n    }).join('g').classed('path-groups', true);\n\n    let lineGen = d3.line()\n        .x((d, i)=> {\n            let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n            return x(i);\n        })\n        .y(d=> {\n            let y = d3.scaleLinear().domain([0, d.maxDiff]).clamp(true);\n            y.range([60, 0]);\n            return y(d.diff);\n        });\n\n    let paths = pathGroups.append('path').attr('d', d=> { \n        return lineGen(d);\n    });\n\n    paths.style('fill', 'none');\n    paths.style('stroke', 'black');\n    paths.style('stroke-width', '2px');\n}\n\n/////////////////////////\nlet obsDistWrap = attWraps.selectAll('.observed-dist-wrap').data(d=> {\n  \n        let max = d3.max(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n        let min = d3.min(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n\n        let x = d3.scaleLinear().domain([min, max]).range([0, 200]);\n    \n        let histogram = d3.histogram()\n        .value(function(d) { return d.realVal; })  \n        .domain(x.domain())  \n        .thresholds(x.ticks(10)); \n        \n        let leafData = d.data.map(m=> {\n            let newLeaves = [...m.leaves].map(leaf => {\n                leaf.x = x;\n                leaf.group = m.group;\n                return leaf;\n            });\n            return {'binData':histogram(m.leaves), 'data': newLeaves, 'group': m.group, 'xScale': x};\n        });\n        return [{'data':leafData, 'xScale': x}];\n    }).join('g').classed('observed-dist-wrap', true);\n\n    obsDistWrap.attr('transform', 'translate(970, 0)');\n  \n    let xAxis = obsDistWrap.selectAll('g.axis-x').data(d=> [d]).join('g').classed('axis-x', true);\n    xAxis.attr('transform', 'translate(0, 50)')\n    xAxis.each((d, i, nodes)=> {\n        d3.select(nodes[i]).call(d3.axisBottom(d.xScale).ticks(5))\n    });\n\n    let distGroups = obsDistWrap.selectAll('.observed-group').data(d=> {\n        return d.data.map((m, i, n)=> {\n            m.index = i;\n            m.groupLength = n.length;\n            return m;\n        });\n    }).join('g').classed('observed-group', true);\n\n    let lines = distGroups.selectAll('.line').data(d => {\n            let mean = d3.mean(d.data.map(r=> r.realVal))\n            let vals = {'mean': mean, 'group':d.group, 'x':d.xScale}\n            return [vals];\n    }).join('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.mean)-1.5)+',0)')\n    .attr('height', 50).attr('width', 3).attr('fill', d=> d.group.color).style('opacity', '0.4')\n\n    let circWrap = distGroups.selectAll('.circ-wrap').data((d, i)=> [d]).join('g').classed('circ-wrap', true).attr('transform', (d, i, n)=> {\n        let move = d3.scaleLinear().domain([0, d.groupLength]).range([0, 60]);\n        return 'translate(0,'+(move(d.index+0.5))+')'});\n\n    let distCirc = circWrap.selectAll('circle.disDots').data(d=> d.data).join('circle').attr('r', 3)\n    .attr('cx', (d, i) => {\n        return d.x(d.realVal);\n    }).attr('cy', (d, i, n)=> {\n        return 0;\n    }).attr('fill', d=> d.group.color);\n}\nexport function renderSelectedView(pathData, otherPaths, selectedDiv, scales) {\n\n    let attributeHeight = 50;\n\n    let selectedSpecies = pathData.flatMap(p => p.filter(f => f.leaf === true).map(n => n.node));\n    let treeNodes = d3.select('#sidebar').select('svg').selectAll('.node');\n    treeNodes.filter(node => selectedSpecies.indexOf(node.data.node) > -1).classed('selected', true);\n\n    ////FILTER MASTER TO HIDE ATTRIBUTES THAT ARE DESELECTED FROM FILTERBAR\n    let attrHide = filterMaster.filter(f => f.type === 'hide-attribute').length > 0 ? filterMaster.filter(f => f.type === 'hide-attribute').map(m => m.attribute) : [];\n    let attrFilter = attrHide.length > 0 ? scales.filter(sc => {\n        return attrHide.indexOf(sc.field) === -1;\n    }).map(m => m.field) : null;\n\n    ////IF THE SELECTED DIV IS THERE ALREADY USE THAT/////\n    let selectedToolTest = selectedDiv.select('.selected-toolbar');\n    let selectedTool = selectedToolTest.empty() ? selectedDiv.append('div').classed('selected-toolbar', true) : selectedToolTest;\n    selectedTool.selectAll('*').remove();\n\n    ///////////////////////\n    let sortByDistanceDiv = selectedTool.append('div').style('display', 'inline-block');\n    sortByDistanceDiv.append('text').text('Topology: ');\n    let sortByDistanceButton = sortByDistanceDiv.append('button').classed('btn btn-secondary btn-sm', true);\n    sortByDistanceButton.text('Sort Most to Least');\n    sortByDistanceButton.on('click', () => sortPaths(sortByDistanceButton));\n\n    /////////////Sorting by attribute///////////////\n    let attrKeys = scales.map(m => m.field);\n    let attrSortWrap = selectedTool.append('div').style('display', 'inline-block');\n    attrSortWrap.append('h6').text('Sort by: ').style('display', 'inline');\n\n    let radioDiv = attrSortWrap.selectAll('div.attr-radio').data(attrKeys).join('div').classed('attr-radio form-check form-check-inline', true);\n    let radio = radioDiv.append('input').attr('type', 'radio').property('name', 'attribute-radio-sort').property('value', d => d).attr('id', (d, i) => 'radio-' + i).classed(\"form-check-input\", true);\n    radioDiv.append('label').text(d => d).property('for', (d, i) => 'radio-' + i).classed(\"form-check-label\", true);\n\n    let svgTest = selectedDiv.select('svg.select-svg');\n    let svg = svgTest.empty() ? selectedDiv.append('svg').classed('select-svg', true) : svgTest;\n\n    svg.selectAll('*').remove();\n\n    let branchFrequency = pathData.flatMap(row => row.flatMap(f => f.node)).reduce(function(acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n            acc[curr] = 1;\n        } else {\n            acc[curr] += 1;\n        }\n        return acc;\n    }, {});\n\n    ///RENDERING SELECTED PATHS////\n    if (pathData.length === 1) {\n\n        /////////////////////////////////////////////////\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', (d, i) => 'translate(0,20)');\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales)\n\n        /////////\n        selectedGroups.on('mouseover', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => {\n                return d.map(m => m.node).indexOf(f.data.node) > -1;\n            }).classed('hover', true);\n            treeLinks.filter(f => d.map(m => m.node).indexOf(f.data.node) > -1).classed('hover', true);\n            return d3.select(this).classed('hover', true);\n        }).on('mouseout', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n            let treeLinks = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n            return d3.select(this).classed('hover', false);\n        });\n\n        let speciesTitle = selectedGroups.append('text').text(d => {\n            let string = d.filter(f => f.leaf === true)[0].label;\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        });\n\n        speciesTitle.attr('x', 25).attr('y', 15);\n\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(150, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', 1000)\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        circle.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        let speciesNodeLabel = nodeGroups.filter(f => f.label != undefined).append('text').text(d => {\n            let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n            return string;\n        }).attr('x', 10).attr('y', 5);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(0,' + (i * 60) + ')');\n\n        let nodes = selectedGroups.select('.time-line').selectAll('.node');\n        nodes.on('mouseover', (d, i) => {\n\n            let nearest = otherPaths.filter(path => {\n                let nodearray = path.flatMap(f => f.node);\n                return nodearray.indexOf(d.node) > -1;\n            });\n\n            let nearestA = nearest[0];\n            let nearestB = nearest[1];\n           \n        });\n\n        //////PLAYING WITH FUNCTION TO CALULATE DISTANCES\n\n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let attributeWrapper = selectedGroups.append('g').classed('attribute-wrapper', true);\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attributeGroups = renderAttributes(attributeWrapper, attData, scales, null);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(10,' + (i * ((attributeHeight + 5) * (Object.keys(d[1].attributes).length + 1))) + ')');\n\n        drawContAtt(attributeGroups);\n        drawDiscreteAtt(attributeGroups, scales, false, false);\n\n        //sizeAndMove(svg, attributeWrapper, pathData, (attrMove * attributeHeight));\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attributeWrapper.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n      \n        return pathData;\n\n    } else if(pathData.length > 1 && pathData.length < 5) {\n       \n        let commonNodeStart = getCommonNodes(pathData);\n        renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency);\n\n        /////END PATH RENDER///////\n        let attWrap = svg.append('g').classed('attribute-wrapper', true);\n        let attributeData = commonNodeStart[commonNodeStart.length - 1].children.map(ch => {\n            return [...commonNodeStart].concat(ch);\n        });\n\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attDataComb = attData[0].map((att, i)=> {\n            let species = pathData[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < attData.length; index++ ){\n                let species = pathData[index].filter(f=> f.leaf === true)[0].label;\n                let last = attData[index][i].length - 1\n                attData[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': attData[index][i]})\n            }\n            return attribute;\n        });\n\n        function findMaxState(states, offset){\n            let maxP = d3.max(states.map(v=> v.realVal));\n            let notMax = states.filter(f=> f.realVal != maxP);\n            let winState = states[states.map(m=> m.realVal).indexOf(maxP)]\n            winState.other = notMax;\n            winState.offset = offset;\n    \n            return winState;\n        }\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'edgeMove': m.edgeMove, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n\n       let attGroups = attWrap.selectAll('g').data(mappedDis).join('g').classed('attr', true);\n       attGroups.attr('transform', (d, i) => 'translate(145,' + (i * (attributeHeight + 10)) + ')');\n\n       attGroups.append('text')\n        .text(d=> d.label)\n        .style('text-anchor', 'end')\n        .style('font-size', 11)\n        .attr('transform', 'translate(0,'+(attributeHeight/2)+')');\n\n       let wrapRect = attGroups.append('rect').attr('width', 1010);\n       wrapRect.attr('height', attributeHeight);\n       wrapRect.style('fill', '#fff');\n       wrapRect.style('stroke', 'gray');\n       wrapRect.style('opacity', 0.5);\n\n       attGroups.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n     \n       let speciesGrp = attGroups.selectAll('g').data(d=> {\n            d.data = d.data.map(m=> {\n                m.type = d.type;\n                return m;\n            });\n            return d.data;\n        }).join('g').classed('species', true);\n\n       let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n           return y(d.realVal) + d.offset;\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([attributeHeight-2, 1]);\n           return y(d.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n           d3.select(n[i]).classed('selected', true);\n       }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).classed('selected', false);\n       });\n\n       let disGroup = speciesGrp.filter(sp=> {\n        return sp.type === 'discrete';\n        });\n\n       let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n       branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate('+distance+', 0)';\n        });\n\n        let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 5, 2]);\n            return y(d.realVal) + d.offset;\n        }).attr('cx', 5);\n\n        bCirc.attr('fill', (d, i)=> d.color);\n\n        let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n        otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n                return y(c.realVal);\n            }).attr('fill', (c)=> c.color).style('opacity', 0.1);\n\n        otherCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n\n        bCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n        \n        /////AXIS ON HOVER////\n        branchGrpDis.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let conGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'continuous';\n        });\n\n        let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n        branchGrpCon.attr('transform', (d)=> {\n         let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n             let distance = x(d.edgeMove);\n             return 'translate('+distance+', 0)';\n         });\n\n         /////AXIS ON HOVER////\n        branchGrpCon.on('mouseover', (d, i, n)=> {\n            let y = d.yScale;\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let MeanRect = branchGrpCon.append('rect');\n   \n        MeanRect.attr('width', 10).attr('height', 3);\n        MeanRect.attr('y', (d, i) => {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0])\n            return y(d.realVal);\n        });\n\n        let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n        confiBars.attr('width', 10).attr('height', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.lowerCI95) - y(d.upperCI95);\n        });\n\n        confiBars.attr('y', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.upperCI95);\n        })\n        confiBars.style('opacity', 0.1);\n\n        //tranforming elements\n        svg.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(0, 60)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n\n\n    }else{\n       \n        /////////\n        //getting common node\n        ///\n\n        let maxBranch = d3.max(pathData.map(p => p.length));\n        let longestBranch = pathData.filter(path => path.length === maxBranch)[0];\n        let startBranch = longestBranch.filter(f=> f.leaf != true);\n        let commonNodeStart = startBranch;\n        //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n        pathData.map(path => {\n            commonNodeStart = [...path].filter(f => {\n                return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n        });\n\n        svg.remove();\n        let remove = selectedTool.append('g').classed('x-icon', true);\n        remove.attr('transform', 'translate(15, 10)');\n        remove.append('circle').attr('r', 7).attr('fill', '#fff');\n        remove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n        remove.style('cursor', 'pointer');\n        remove.on('click', (d, i, n) => {\n            d3.selectAll('.high').classed('high', false);\n            d3.selectAll('.low').classed('low', false);\n            treeNodes.select('.selected').classed('selected', false);\n            pathSelected(null, dataMaster[0], scales);\n        });        \n\n        /////////\n        renderDistibutions(pathData, selectedDiv, scales);\n        selectedDiv.style('height', '550px');\n\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n    }\n    \n}\n\nfunction sortPaths(sortButton) {\n    if (sortButton.text() === 'Sort Most to Least') {\n        sortButton.text('Sort Least to Most');\n    } else {\n        sortButton.text('Sort Most to Least');\n    }\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport * as d3Array from 'd3-array'\nimport {pathSelected, renderComparison} from './selectedPaths';\nimport {formatAttributeData, maxTimeKeeper} from './dataFormat';\nimport {filterMaster, nodeFilter, getLatestData, leafStateFilter, getScales} from './filterComponent';\nimport { drawBranchPointDistribution } from './distributionView';\nimport { dropDown } from './buttonComponents';\nimport { groupedView } from './viewControl';\n\nconst dimensions = {\n    rectWidth: 15,\n    rectHeight: 40,\n    collapsedHeight: 20,\n}\n\nexport function drawPathsAndAttributes(pathData, main){\n\n    let scales = getScales();\n\n    let nodeTooltipFlag = true;\n\n    let collapsed = d3.select('#scrunch').attr('value');\n  \n    main.select('#main-path-view').selectAll('*').remove();\n\n    let pathGroups = renderPaths(pathData, main);\n  \n      /// LOWER ATTRIBUTE VISUALIZATION ///\n    let attributeWrapper = pathGroups.append('g').classed('attribute-wrapper', true);\n  \n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n\n    let attData = formatAttributeData(pathData, scales, shownAttributes);\n\n    let predictedAttrGrps = renderAttributes(attributeWrapper, attData, collapsed);\n    let attributeHeight = (collapsed === 'true')? 22 : 45;\n    pathGroups.attr('transform', (d, i)=> 'translate(10,'+ (i * ((attributeHeight + 5)* (shownAttributes.length + 1))) +')');\n    \n    let cGroups = drawContAtt(predictedAttrGrps, collapsed);\n    let dGroups = drawDiscreteAtt(predictedAttrGrps, collapsed, false);\n    sizeAndMove(main.select('#main-path-view'), attributeWrapper, pathData, (shownAttributes.length * attributeHeight));\n\n    let leafStates = d3.selectAll('.discrete-leaf');\n    leafStates.on('click', (d, i)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#state-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.winState);\n            d3.select(\"#state-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-state\").on('click', ()=> {\n                leafStateFilter(d, scales);\n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n            });\n\n            d3.select(\"#select-by-state\").on('click', ()=> {\n                let data = getLatestData();\n                let test = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState === d.winState;\n                });\n\n                let notIt = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState != d.winState;\n                });\n            \n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n\n                pathSelected(test, notIt, scales);\n\n            });\n\n        }});\n\n    return pathGroups;\n\n}\nexport function sizeAndMove(svg, attribWrap, data, attrMove){\n        //tranforming elements\n    svg.style('height', ((data.length * (attrMove + 52))) + 'px');\n    attribWrap.attr('transform', (d)=> 'translate(140, 25)');\n        ///////////////////////////////////\n}\nexport function renderPaths(pathData, main){\n\n    let scales = getScales();\n\n    ////YOU SHOULD MOVE THESE APPENDING THINGS OUT OF HERE///////\n    /////Rendering ///////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    \n    let nodeTooltipFlag = false;\n\n    let pathWrapTest = svg.select('.path-wrapper');\n    let pathWrap = pathWrapTest.empty() ? svg.append('g').classed('path-wrapper', true) : pathWrapTest;\n    pathWrap.attr('transform', (d, i)=> 'translate(0,20)');\n\n      /////Counting frequency of nodes//////\n    let branchFrequency = pathData.flatMap(row=> row.flatMap(f=> f.node)).reduce(function (acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n          acc[curr] = 1;\n        } else {\n          acc[curr] += 1;\n        }\n        return acc;\n        }, {});\n\n     ///Scales for circles ///\n    let circleScale = d3.scaleLog().range([6, 12]).domain([1, d3.max(Object.values(branchFrequency))]);\n    let pathGroups = pathWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n    let pathBars = pathGroups.append('rect').classed('path-rect', true);\n    pathBars.attr('y', -8);\n\n    //////////\n    ///Selecting species\n    /////////\n    let pathAdd = pathGroups.append('g').classed(\"fas fa-search-plus\", true);\n    pathAdd.attr('transform', 'translate(15, 10)');\n    pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathAdd.append('text').text('+').attr('transform', 'translate(-5, 5)');\n    pathAdd.style('cursor', 'pointer');\n\n    pathAdd.on('click', (d, i, n)=>{\n\n        let notIt = d3.selectAll(n).filter((f, j)=> j != i).classed('selected-path', false);\n     \n        if(d3.select(n[i]).classed('selected-path')){\n            d3.select(n[i]).classed('selected-path', false);\n            pathSelected(null, notIt.data(), scales);\n        }else{\n            d3.select(n[i]).classed('selected-path', true);\n            pathSelected([d], notIt.data(), scales);\n        }\n    });\n\n    /////////\n    pathGroups.on('mouseover', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let treeLinks  = d3.select('#sidebar').selectAll('.link');\n        treeNode.filter(f=> {\n            return d.map(m=> m.node).indexOf(f.data.node) > -1;\n        }).classed('hover', true);\n        treeLinks.filter(f=> d.map(m=> m.node).indexOf(f.data.node) > -1).classed('hover', true);\n        return d3.select(this).classed('hover', true);\n    }).on('mouseout', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n        let treeLinks  = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n        return d3.select(this).classed('hover', false);\n    });\n\n    let speciesTitle = pathGroups.append('text').text(d=> {\n       let string = d.filter(f=> f.leaf === true)[0].node;\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    });\n\n    speciesTitle.attr('x', 25).attr('y', 15);\n\n    let timelines = pathGroups.append('g').classed('time-line', true);\n    timelines.attr('transform', (d, i)=> 'translate(150, 0)');\n\n    let lines = timelines.append('line')\n    .attr('x1', 0)\n    .attr('x2', 1000)\n    .attr('y1', 15)\n    .attr('y2', 15);\n\n    let nodeGroups = timelines.selectAll('.node').data((d)=> {\n        return d}).join('g').attr('class', (d, i, n)=> {\n            return d3.select(n[n.length - 1]).data()[0].node + \" node\";\n        });\n   \n    nodeGroups.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return 'translate('+ distance +', 10)';});\n\n    nodeGroups.on('click', (d, i, n)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#branch-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.node);\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-node\").on('click', ()=> {\n                nodeFilter(d.node, scales);\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n            });\n\n            d3.select(\"#select-by-node\").on('click', ()=> {\n                let data = getLatestData();\n                let test = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) > -1;\n                });\n                let notIt = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) === -1;\n                });\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n                pathSelected(test.data(), notIt.data(), scales);\n            });\n        }\n    });\n\n    let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d=> {\n        return circleScale(branchFrequency[d.node]);\n    }).attr('class', (d, i)=> 'node-'+d.node);\n\n    circle.on('mouseover', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> f.data.node === d.node).classed('selected-branch', true);\n        return hovers.classed('hover-branch', true);\n    }).on('mouseout', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        return hovers.classed('hover-branch', false);\n    });\n\n    let speciesNodeLabel = nodeGroups.filter(f=> f.label != undefined).append('text').text(d=> {\n        let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n        return string;\n    }).attr('x', 10).attr('y', 5);\n\n    return pathGroups;\n}\nexport function renderAttributes(attributeWrapper, data, collapsed){\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n    let predictedAttrGrps = attributeWrapper.selectAll('g').data((d, i)=> {\n        return data[i]}).join('g');\n    predictedAttrGrps.classed('predicated-attr-groups', true);\n    predictedAttrGrps.attr('transform', (d, i) => 'translate(0, '+(i * (attributeHeight + 5))+')');\n\n    let attrLabel = predictedAttrGrps.append('text').text(d=> {\n        return d[d.length - 1].label ? d[d.length - 1].label : d[d.length - 1].attrLabel\n    });\n    attrLabel.classed('attribute-label', true);\n    attrLabel.attr('transform', 'translate(-15, 20)');\n\n    return predictedAttrGrps;\n}\nfunction collapsedPathGen(data){\n    data.map((p, i)=>{\n        let step = i === 0 ? 0 : 1;\n        let test = (p.realVal > data[i-step].realVal) ? 1 : 18;\n        p.change = test;\n    })\n}\nasync function continuousPaths(innerTimeline, collapsed){\n\n    innerTimeline.data().forEach(path => {\n        collapsedPathGen(path);\n    });\n\n    //THIS IS THE PATH GENERATOR FOR THE CONTINUOUS VARIABLES\n    let height = (collapsed === 'true')? dimensions.collapsedHeight : dimensions.rectHeight;\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return distance; })\n    .y(d=> {\n        let y = d.scales.yScale;\n        y.range([height, 0]);\n        if(collapsed === 'true'){\n            return d.change;\n        }else{\n            return y(d.values.realVal);\n        }\n    });\n\n    let innerPaths = innerTimeline.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", \"inner-line\")\n    .style('stroke', (d)=> d[0].color);\n\n    return innerPaths;\n    ///////////////////////////////////////////////////////////\n}\nexport function drawContAtt(predictedAttrGrps, collapsed){\n\n    let continuousAtt = predictedAttrGrps.filter(d=> {\n        return (d[d.length - 1] != undefined) ? d[d.length - 1].type === 'continuous' : d.type === 'continuous';\n    });\n\n    let attributeHeight = (collapsed === 'true') ? dimensions.collapsedHeight : dimensions.rectHeight;\n\n    let innerTimeline = continuousAtt.append('g').classed('attribute-time-line', true);\n    /////DO NOT DELETE THIS! YOU NEED TO SEP CONT AND DICRETE ATTR. THIS DRAWS LINE FOR THE CONT/////\n    let innerPaths = continuousPaths(innerTimeline, collapsed);\n ////////\n    let attribRectCont = innerTimeline.append('rect').classed('attribute-rect', true);\n    attribRectCont.attr('height', attributeHeight);\n    let attributeNodesCont = innerTimeline.selectAll('g').data(d=> d).join('g').classed('attribute-node', true);\n\n    let innerBars = attributeNodesCont.append('g').classed('inner-bars', true);\n\n    // let innerRect = innerBars.append('rect').classed('attribute-inner-bar', true);\n    // innerRect.attr('height', attributeHeight).attr('width', dimensions.rectWidth);\n\n    innerBars.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return 'translate('+ distance +', 0)';});\n      \n    let rangeRect = innerBars.append('rect').classed('range-rect', true);\n    rangeRect.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n       \n        let y = d.scales.yScale;\n        y.range([attributeHeight, 0]);\n        let range = d.leaf ? 0 : y(d.values.lowerCI95) - y(d.values.upperCI95);\n        let barHeight = (collapsed === 'true') ? dimensions.collapsedHeight : range;\n        return barHeight;\n    });\n    rangeRect.attr('transform', (d, i)=> {\n        let y = d.scales.yScale;\n        y.range([attributeHeight, 0]);\n        let move = (d.leaf || (collapsed === 'true')) ? 0 : y(d.values.upperCI95);\n        return 'translate(0, '+ move +')';\n    });\n    rangeRect.style('fill', (d)=> {\n        return d.colorScale(d.values.realVal);\n    });\n    rangeRect.attr('opacity', (d)=> {\n        return d.satScale(d.values.realVal);\n    });\n    if(collapsed != 'true'){\n        innerBars.append('rect').attr('width', dimensions.rectWidth).attr('height', 4)\n        .attr('transform', (d, i)=> {\n            let y = d.scales.yScale;\n            y.range([attributeHeight, 0]);\n            return 'translate(0, '+ y(d.values.realVal) +')';})\n        .attr('fill', d=> d.color).classed('val-bar', true);\n    }\n\n    /////AXIS ON HOVER////\n    innerBars.on('mouseover', (d, i, n)=> {\n        let y = d.scales.yScale;\n        y.range([0, attributeHeight]);\n        d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(200)\n          .style(\"opacity\", .9);\n        let f = d3.format(\".3f\");\n        tool.html('mean: '+f(d.values.realVal) +\"</br>\"+\"</br>\"+ 'upperCI: '+ f(d.values.upperCI95) +\"</br>\"+\"</br>\"+ 'lowerCI: '+ f(d.values.lowerCI95))\n          .style(\"left\", (d3.event.pageX) + \"px\")\n          .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        tool.style('height', 'auto');\n       \n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).select('g.y-axis')\n        d3.select(n[i]).select('g.y-axis').remove();\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    return attributeNodesCont;\n   \n}\nexport function findMaxState(states, offset){\n    let maxP = d3.max(states.map(v=> v.values.realVal));\n    let notMax = states.filter(f=> f.values.realVal != maxP);\n    let winState = states[states.map(m=> m.values.realVal).indexOf(maxP)]\n    winState.other = notMax;\n    winState.offset = offset;\n    return winState;\n}\n    //BEGIN TEST\nfunction drawLeaves(attWraps, groupBy){\n    //THIS IS HARD CODED AND SHOULD NOT BE\n\n    let numSpecies = 100;\n    let height = 40;\n    //CONTINUOUS \n    let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap-first.continuous').data(d=> {\n            let totalVal = attWraps.data().filter(f=> f.label === d.label).map(m=> m.data);\n            let totalArray = totalVal.flatMap(p=> p.flatMap(f=> f.paths[f.paths.length - 1].realVal));\n            let max = d3.max(totalArray);\n            let min = d3.min(totalArray);\n            let totalMean = d3.mean(totalArray);\n        \n            let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n            let newVal = d.data.map((m, i)=> {\n                m.index = i;\n                return {'value': m.paths[m.paths.length - 1].values.realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n            });\n            let groupMean = d3.mean(newVal.map(v=> v.value));\n            return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n        }).join('g').classed('observe-wrap-first continuous', true);\n        \n        leafWraps.attr('transform', 'translate(850, 0)');\n        \n        let xAxis = leafWraps.append('g').classed('axis-x', true);\n        xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n        xAxis.each((d, i, nodes)=> {\n            d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n        });\n        \n        let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n        \n        let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n        \n        let distCircGroupOut = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n        let distcirclesOut = distCircGroupOut.selectAll('circle').data(d=> d.dotVals).join('circle');\n        distcirclesOut.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n\n        //DISCRETE//\n        let leafWrapsD = attWraps.filter(f=> f.type === 'discrete').selectAll('g.observe-wrap-first.discrete').data(d=> {\n          return [d];\n        }).join('g').classed('observe-wrap-first discrete', true);\n\n        let rects = leafWrapsD.filter(f=> {\n            return f.label != groupBy;\n        }).selectAll('rect').data(d=> {\n            let groupedData = d3Array.groups(d.data.map(m=> m.paths[m.paths.length - 1]), d=> d.state);\n            groupedData.sort((a, b)=> b[1].length - a[1].length)\n            return groupedData;\n        }).join('rect').attr('height', 15).attr('width', (d, i, n)=>{\n            let scale = d3.scaleLinear().domain([0, d3.sum(d3.selectAll(n).data().map(m=> m[1].length))])\n            .range([5, 170]);\n            d.width = scale(d[1].length);\n            return scale(d[1].length);\n        });\n\n        rects.attr('x', (d, i, n)=> {\n            if(i === 0){ return 0}\n            else {\n                d3.selectAll(n).filter((f, j)=> j< i);\n                let move = d3.sum(d3.selectAll(n).filter((f, j)=> j< i).data().map(m=> m.width));\n                return move;}\n        }).attr('y', 12)\n\n        rects.attr('fill', d=> d[1][0].color);\n\n        rects.on('mouseover', (d, i, n)=> {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            \n            tool.html(d[0] + \"</br>\" + d[1].length)\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY + 20) + \"px\");\n\n              d3.selectAll(n).filter((f, j)=> j != i).attr('opacity', 0.3);\n          \n        }).on('mouseout', (s, i, n)=> {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n\n              d3.selectAll(n).filter((f, j)=> j != i).attr('opacity', 1)\n        })\n\n        leafWrapsD.attr('transform', 'translate(850, 0)');\n\n        let ratio = leafWrapsD.filter(f=> f.label === groupBy)\n            .selectAll('text').data(d=> [d]).join('text').text(d=> {\n                let paths = d.data[d.data.length - 1].paths;\n                return `${paths[paths.length - 1].state}: ${d.data.length} / ${numSpecies}`\n            });\n        ratio.style('text-anchor', 'middle')\n        ratio.style('font-size', '12px')\n        ratio.attr('x', 90).attr('y', 25)\n        \n    }\nexport function drawGroups(stateBins, scales){\n    \n    let groupedBool = d3.select('#show-drop-div-group').attr('value', 'grouped');\n    \n    let height = 40;\n    let selectedTool = d3.select('#selected');\n    selectedTool.selectAll('*').remove();\n \n    let main = d3.select('#main');\n    main.style('padding-top', 0);\n\n    d3.select('#toolbar').append('text').text(stateBins[0].field)\n\n    let splitOnArray = [{'field':'None'}].concat(scales.filter(f=> (f.field != stateBins[0].field) && f.type === 'discrete'));\n    let dropOptions = dropDown(d3.select('#toolbar'), splitOnArray, 'Split On','show-drop-div-group');\n\n    ////THIS SPLITS THE DATA////\n    dropOptions.on('click', (d, i, n)=> {\n        d3.select('#toolbar').append('text').text(d.field);\n        \n        if(d.type === 'discrete'){\n            let newBins = stateBins.map(state=> {\n                let newBinData = d.scales.map(sc=> {\n                    let field = sc.field;\n                    let name = sc.scaleName;\n                    let newData = state.data.filter(pa=> {\n                        let leaf = pa.filter(le=> le.leaf === true)[0];\n                        return leaf.attributes[field].winState === name;\n                    });\n                    return {'field': field, 'state': name, 'data': newData }\n                });\n                state.data = newBinData;\n                return state;\n            });\n\n            //////RENDERING NEED TO SEPARATE OUT/////\n           \n           let main = d3.select('#main');\n           main.selectAll('*').remove();\n           main.style('padding-top', '40px');\n           let firstGroupDiv = main.selectAll('div.first-group').data(newBins).join('div').classed('first-group', true);\n           \n           let firstGroupSvg = firstGroupDiv.append('svg');\n           firstGroupSvg.attr('height', s=> (s.data.length*270));\n           let firstGroup = firstGroupSvg.append('g');\n          \n           let firstLabel = firstGroup.append('text').text(f=> f.state).attr('transform', 'translate(10, 10)');\n\n           let secondGroup = firstGroup.selectAll('g.second-group').data(g=> {\n               let newGroups = g.data.map((m)=>{\n                   let newM = {};\n                   newM.first = [g.field, g.state];\n                   newM.second = [m.field, m.state];\n                   newM.data = m.data\n                   newM.leaves = m.data.flatMap(path=> path.filter(f=> f.leaf === true));\n                   return newM\n               });\n               return newGroups}).join('g').classed('second-group', true);\n\n           secondGroup = secondGroup.filter(f=> f.data.length > 0);\n           secondGroup.attr('transform', (s, i)=> 'translate(30,'+(20 + (i * 270))+')');\n\n           secondGroup.each((s, i, n)=> {\n            let branchBar = drawBranchPointDistribution(s.data, d3.select(n[i]));\n            branchBar.select('rect').attr('x', -80).attr('fill','gray');\n            branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n            \n            branchBar.select('.leaf-label').append('text').text((t, i) =>': '+ t.data.length).attr('transform', 'translate(45, 0)');\n            branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n    \n            branchBar.select('line').attr('stroke', '#fff');\n\n            let groupLabels = d3.select(n[i]).append('g');\n\n            //groupLabels.\n            let pathAdd = groupLabels.append('g').classed(\"fas fa-search-plus\", true);\n            pathAdd.attr('transform', 'translate(-10, 15)');\n            pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n            pathAdd.append('text').text('+').attr('transform', 'translate(-5, 3)').attr('fill', 'gray');\n        \n            pathAdd.style('cursor', 'pointer');\n\n            pathAdd.on('click', ()=> {\n                let other = d3.selectAll(n).filter((f,j)=> j != i);\n                renderComparison(s, other.data(), d3.select('#selected'), scales);\n            });\n\n            let stateLabel = groupLabels.append('text').text((s, i)=> s.second[1]);\n            stateLabel.attr('transform', (d, i)=> 'translate(3, 20)');\n            stateLabel.attr('fill', '#fff');\n           });\n\n           let innerGroup = secondGroup.filter(f=> f.data.length > 0).append('g').classed('inner-wrap', true);\n           innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n       \n           let attWraps = innerGroup.selectAll('.att-wrapper').data((d)=> {\n               let atts = formatAttributeData(d.data, scales, null);\n             \n               let attDataComb = atts[0].map((att, i)=> {\n                  \n                   let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n\n                   att[att.length - 1].offset = 0;\n                   let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n                   for(let index = 1; index < atts.length; index++ ){\n                       let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                       let last = atts[index][i].length - 1\n                       atts[index][i][last].offset = (index * 8);\n                       attribute.data.push({'species': species, 'paths': atts[index][i]});\n                   }\n                   \n                   return attribute;\n               });\n\n              let mappedDis = attDataComb.map(dis=> {\n                  dis.data = dis.data.map((spec, i)=> {\n                      spec.paths = spec.paths.map(m=> {\n                            if(dis.type === 'discrete'){\n                                let offset = 5 * i;\n                                let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'combLength': m.combLength, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                                return maxProb;\n                            }else{\n                                return m;\n                            }\n                        });\n                   return spec;\n                  });\n        \n                  dis.leaves = dis.data.flatMap(f=> f.paths.filter(p=> p.leaf === true));\n                  return dis;\n              });\n              return mappedDis;\n           }).join('g').classed('att-wrapper', true);\n\n           let innerWrapRect = attWraps.append('rect').attr('width', 800);\n\n            innerWrapRect.attr('height', height);\n            innerWrapRect.style('fill', '#fff');\n            innerWrapRect.style('stroke', 'gray');\n\n            attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n            wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n            svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n            let labels = attWraps.append('text')\n            .text(d=> d.label)\n            .style('text-anchor', 'end')\n            .style('font-size', 11)\n            labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n////WORKING ON STATE SHIFT VIEW///////\n            let shiftWraps = attWraps.filter(f=> f.type === 'discrete').selectAll('g.shift-wrap').data(d=> {\n       \n                let test = d.data.flatMap(m=> m.paths.filter((f, i)=> {\n                    if(i===0) return (i === 0);\n                    if(i > 0) return (m.paths[i-1].state != f.state)\n                    if(i < m.paths.length - 1) return (m.paths[i+1].state != f.state);\n                }));\n             \n                return [test];\n            }).join('g').classed('shift-wrap', true);\n\n            shiftWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxisShift = shiftWraps.append('g').classed('axis-x', true);\n            xAxisShift.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxisShift.each((d, i, nodes)=> {\n                let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 200]);\n                d3.select(nodes[i]).call(d3.axisBottom(x).ticks(5));\n            });\n\n            let circGroupShift = shiftWraps.append('g').attr('transform', 'translate(0, 20)');\n\n            let shiftCircles = circGroupShift.selectAll('circle.shift').data(d=> d).join('circle').classed('shift', true);\n            shiftCircles.attr('r', 4).attr('cx', (d, i)=> {\n                let x = d3.scaleLinear().domain([0,maxTimeKeeper[0]]).range([0, 200]);\n                return x(d.combLength)\n            });\n            shiftCircles.attr('fill', d=> d.color).style('opacity', 0.4);\n\n//////DRAW OBSERVED DISTRIBUTIONS/////\n            let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap').data(d=> {\n                let totalVal = attWraps.data().filter(f=> f.label === d.label).flatMap(m=> m.leaves.map(l=> l.realVal));\n                let max = d3.max(totalVal);\n                let min = d3.min(totalVal);\n                let totalMean = d3.mean(totalVal);\n\n                let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n                let newVal = d.leaves.map((m, i)=> {\n                    m.index = i;\n                    return {'value': m.realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n                });\n                let groupMean = d3.mean(newVal.map(v=> v.value));\n                return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n            }).join('g').classed('observe-wrap', true);\n\n            leafWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxis = leafWraps.append('g').classed('axis-x', true);\n            xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxis.each((d, i, nodes)=> {\n                d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n            });\n\n            let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n\n            let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n\n            let distCircGroup = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n            let distcircles = distCircGroup.selectAll('circle').data(d=> d.dotVals).join('circle');\n            distcircles.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n\n            distcircles.on('mouseover', (d, i, n)=> {\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n           \n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n\n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n\n            ////DRAW SPECIES GROUPS IN THE ATTRIBUTES\n\n            let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n                d.data = d.data.map(m=> {\n                    m.type = d.type;\n                    return m;\n                });\n                return d.data;\n            }).join('g').classed('species', true);\n\n            let lineGenD = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n                    let distance = d.combLength;\n                    return x(distance);\n                    })\n                .y(d=> {\n                    let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n                    return y(d.realVal);\n                });\n\n            let lineGenC = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n                    let distance = d.combLength;\n                    return x(distance);\n                })\n                .y(d=> {\n                    let y = d.scales.yScale;\n                    y.range([height-2, 1]);\n                    return y(d.values.realVal) + 2;\n                });\n\n            let innerStatePaths = speciesGrp.append('path')\n                .attr(\"d\", d=> {\n                        return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n                    })\n                .attr(\"class\", (d, i)=> {\n                        return d.species + \" inner-line\"})\n                .style('stroke-width', 0.7)\n                .style('fill', 'none')\n                .style('stroke', 'gray');\n\n            innerStatePaths.on('mouseover', (d, i, n)=> {\n               \n                d3.select(n[i]).classed('selected', true);\n                distcircles.filter(f=> f.species === d.species).classed('selected', true).style('opacity', 1);\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n                \n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n            let disGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'discrete';\n            });\n\n            let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n            branchGrpDis.attr('transform', (d)=> {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n                    let distance = x(d.combLength);\n                    return 'translate('+distance+', 0)';\n            });\n\n            let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n                let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n                return y(d.realVal);\n            }).attr('cx', 5);\n\n            bCirc.classed('win-state', true);\n\n            bCirc.attr('fill', (d, i, n)=> {\n                if(i === 0){\n                    return d.color;\n                }else if(i === n.length - 1){\n                    if(d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }else{\n                    if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }\n            });\n\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n          let distance = x(d.combLength);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n    branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', dimensions.rectWidth).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     });\n     confiBars.style('opacity', 0.1);\n           \n           //drawGroups(stateBins, scales);\n    }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        selectedTool.select('#show-drop-div-group').classed('show', false);\n    });\n    /////END SPLIT VIEW//////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    svg.selectAll('*').remove();\n\n    svg.attr('height', (stateBins.length * (height + 20)));\n    svg.append('g').attr('transform', 'translate(500, 40)').append('text').text(stateBins[0].field)\n\n    let wrappers = svg.selectAll('.grouped').data(stateBins).join('g').classed('grouped', true);\n    wrappers.each((d, i, n)=> {\n        let branchBar = drawBranchPointDistribution(d.data, d3.select(n[i]));\n        branchBar.select('rect').attr('x', -80).attr('fill','gray');\n        branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n        \n        branchBar.select('.leaf-label').append('text').text((d, i) =>': '+ d.data.length).attr('transform', 'translate(45, 0)');\n        branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n\n        branchBar.select('line').attr('stroke', '#fff');\n    });\n\n    let groupLabels = wrappers.append('g');\n   \n\n     //groupLabels.\n     let pathAdd = groupLabels.append('g').classed(\"fas fa-search-plus\", true);\n     pathAdd.attr('transform', 'translate(20, -5)');\n     pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n     pathAdd.append('text').text('+').attr('transform', 'translate(5, 3)').attr('fill', 'gray');\n \n     pathAdd.style('cursor', 'pointer');\n\n     pathAdd.on('click', (d, i, n)=> {\n         let other = d3.selectAll(n).filter((f,j)=> j != i);\n         renderComparison(d, other.data(), d3.select('#selected'), scales);\n     });\n\n     groupLabels.append('text').text((d, i)=> d.state);\n     groupLabels.attr('transform', (d, i)=> 'translate(40, 16)');\n     groupLabels.style('text-anchor', 'end');\n     groupLabels.attr('fill', '#fff');\n\n    let innerGroup = wrappers.append('g').classed('inner-wrap', true);\n    innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n    let attWraps = innerGroup.selectAll('.att-wrapper').data((d, i)=> {\n        let atts = formatAttributeData(d.data, scales, null);\n\n       \n        let attDataComb = atts[0].map((att, i)=> {\n            let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < atts.length; index++ ){\n                let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                let last = atts[index][i].length - 1;\n                atts[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': atts[index][i]})\n            }\n            return attribute;\n        });\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'combLength': m.combLength, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n       return mappedDis;\n    }).join('g').classed('att-wrapper', true);\n\n    let innerWrapRect = attWraps.append('rect').attr('width', 800);\n    innerWrapRect.attr('height', height);\n    innerWrapRect.style('fill', '#fff');\n    innerWrapRect.style('stroke', 'gray');\n\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n    wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n    \n    svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n       //END EXPERIMENT\n    drawLeaves(attWraps, stateBins[0].field);\n\n    let labels = attWraps.append('text')\n    .text(d=> d.label)\n    .style('text-anchor', 'end')\n    .style('font-size', 11)\n    labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n    let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n        d.data = d.data.map(m=> {\n            m.type = d.type;\n            return m;\n        });\n        return d.data;\n    }).join('g').classed('species', true);\n\n    let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n           let distance = d.combLength;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n           return y(d.values.realVal);\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n           let distance = d.combLength;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([height-2, 1]);\n           return y(d.values.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n        d3.select(n[i]).classed('selected', true);\n    }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).classed('selected', false);\n    });\n\n    let disGroup = speciesGrp.filter(sp=> {\n     return sp.type === 'discrete';\n     });\n\n    let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n            let distance = x(d.combLength);\n            return 'translate('+distance+', 0)';\n     });\n\n    let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n         let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n         //return y(d.realVal) + d.offset;\n         return y(d.values.realVal);\n     }).attr('cx', 5);\n\n     bCirc.classed('win-state', true);\n\n     bCirc.attr('fill', (d, i, n)=> {\n        if(i === 0 || i === n.length - 1){\n            return d.color;\n            /*\n        }else if(i === n.length - 1){\n            if(d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }*/\n        }else{\n            if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }\n        }\n     });\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 800]);\n          let distance = x(d.combLength);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n     branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', dimensions.rectWidth).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     })\n     confiBars.style('opacity', 0.1);\n\n     /////HIGHLIGHTING NODES IN A TREE ON HOVER//////\n     d3.selectAll('.att-wrapper').selectAll('.branch').on('mouseover', (d, i, n)=> {\n         let treeNode  = d3.select('#sidebar').selectAll('.node');\n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', true);\n      \n    }).on('mouseout', (d, i, n)=> {\n       \n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', false);\n    })\n     \n}\nexport function drawDiscreteAtt(predictedAttrGrps, collapsed, bars){\n\n    let discreteAtt = predictedAttrGrps.filter(d=> {\n        return d[d.length - 1].type === 'discrete';\n    });\n\n   // discreteAtt.selectAll('*').remove();\n\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n\n    let innerTimelineDis = discreteAtt.append('g').classed('attribute-time-line', true);\n\n    innerTimelineDis.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n    \n    let statePath = innerTimelineDis.selectAll('g').data(d=> {\n        \n        // let disct = d.map(m=> {\n        //     console.log('m', d, m)\n        //     let test = (m.leaf == true) ? m.states.map(s=> {\n        //         s.combLength = m.combLength;\n        //         s.color = m.color;\n        //         return s;\n        //     }) : m;\n        //     return test;\n        // });\n        let disct = d;\n       \n        let keys = disct[0].map(s=> s.state);\n        let lines = keys.map(key=> {\n             return disct.map(m=> m.leaf ? m : m.filter(f=> f.state == key)[0]);\n        });\n        return lines;\n    }).join('g').classed('state-path', true);\n\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        let distance = x(d.combLength);\n        return distance + 7;})\n    .y(d=> {\n        let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n        return d.value ? y(d.value) : y(1);\n    });\n\n    let innerStatePaths = statePath.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", (d, i)=> d[0].species + \" inner-line\")\n    .style('stroke-width', 0.7)\n    .style('stroke', (d)=> {\n        return d[0].color;\n    });\n\n    let attribRectDisc = innerTimelineDis.append('rect').classed('attribute-rect', true);\n    attribRectDisc.attr('height', attributeHeight);\n    let attributeNodesDisc = innerTimelineDis.selectAll('.attribute-node-discrete').data(d=> {\n        return d;}).join('g');\n\n    attributeNodesDisc.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, 1000]);\n        if(d[0]){\n           // let distance = (moveMetric === 'move') ? d[0].move : x(d[0].combLength);\n           let distance = x(d[0].combLength);\n            return 'translate('+distance+', 0)';\n        }else{\n           // let distance = (moveMetric === 'move') ? d.move : x(d.combLength);\n            let distance = x(d.combLength);\n            return 'translate('+distance+', 0)';\n        }\n    });\n\n    attributeNodesDisc.append('rect').attr('width', dimensions.rectWidth).attr('height', attributeHeight).attr('opacity', 0);\n\n    attributeNodesDisc.append('line').attr('x1', 10).attr('x2', 10).attr('y1', 0).attr('y2', attributeHeight);\n\n        /////AXIS ON HOVER////\n    attributeNodesDisc.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, attributeHeight]);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n        })\n\n    attributeNodesDisc.attr('class', (d, i, n)=> {\n        let path = d3.selectAll(n).data();\n        return path[path.length - 1].species;\n    }).classed('attribute-node-discrete', true);\n\n    if(bars === false){\n\n        let stateDots = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dots').data(d=> {\n            \n            return d;\n        }).join('circle').classed('dots', true);\n        \n        stateDots.attr('cx', 10).attr('cy', (d)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 2, 2]);\n            return d.realVal? y(d.realVal) : y(d.value);\n        }).attr('r', 2);\n        \n        stateDots.style('fill', (d, i, n)=> {\n           \n            /*\n            let speciesPath = d3.selectAll('.attribute-node-discrete.'+ d.species)//.filter(f=> f.type === 'discrete');\n           \n            let nodeArray = speciesPath.data().map(m=> {\n                return m.node ? m.node : m[0].node;\n            });\n            let index = nodeArray.indexOf(d.node);\n           \n            */\n            //return d.color\n            return 'gray';\n        });\n    \n        stateDots.filter(f=> f.realVal > 0.5).attr('r', 4);\n/*\n        let maxDots = stateDots.filter((f, i, n)=> {\n           \n            return f.realVal === d3.max(d3.selectAll(n).data().map(m=> m.realVal));\n        });\n*/\n        \n\n        ////NEED TO ADD COLOR ON STATE CHANGE////\n    \n        stateDots.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n        ////NEED TO MAKE A FUNCTION TO ASSIGN COLOR OF STATES//////\n    \n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }else{\n        attributeNodesDisc.filter((att, i)=> {\n            return att[0] != undefined;}).append('rect').attr('height', attributeHeight).attr('width', dimensions.rectWidth).attr('fill', '#fff')\n        let stateBars = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dis-rect').data(d=> {\n            return d;\n        }).join('rect').classed('dis-rect', true);\n\n        stateBars.attr('width', dimensions.rectWidth).attr('height', (d, i)=> {\n         \n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            return y(d.realVal);\n        });\n\n        stateBars.attr('fill', (d, i)=> d.color);\n        stateBars.attr('opacity', '0.7');\n        stateBars.attr('stroke', '#fff');\n        stateBars.attr('transform', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            let probability = d3.selectAll(n).data().sort((a, b)=> b.realVal - a.realVal);\n            let chosenIn = probability.map(p=> p.state).indexOf(d.state);\n         \n            if(chosenIn === 0){\n                    return 'translate(0,0)';\n            }else{\n                ///need to make this a reduce function///\n                let valueAdd = 0;\n                    for(let step = 0; step < chosenIn; step++){\n                        valueAdd = valueAdd + probability[step].realVal;\n                    }\n                return 'translate(0,'+(y(valueAdd))+')';\n            }\n        });\n\n        stateBars.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n\n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }\n\n    return attributeNodesDisc;\n}\n\n","import '../styles/index.scss';\n\nimport * as d3 from \"d3\";\nimport {dataMaster, calculatedScalesKeeper} from './index';\nimport { updateMainView } from './viewControl';\n\nexport let filterMaster = [];\n\nexport function removeFilter(filterId, scales){\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n    let filterIndex = dataFilters.map(f=> f.filterId).indexOf(filterId);\n\n    if(filterIndex != dataFilters.length - 1){\n   \n        let baseData = filterIndex === 0? dataMaster[0] : dataFilters[filterIndex - 1].data;\n    \n        let testData = [...baseData];\n\n        let filterToolbar = d3.select(\"#toolbar\");\n\n        let badges = filterToolbar.selectAll('.filter-tag').remove();\n  \n        for(let i = filterIndex + 1; i < dataFilters.length; i ++){\n       \n            let fun = dataFilters[i].filterFunction;\n            if(dataFilters[i].attributeType === 'continuous'){\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].predictedFilter, dataFilters[i].observedFilter);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'c-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }else{//discrete\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].fromState, dataFilters[i].toState);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'd-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }\n        }\n    }\n    let newFilterMaster = filterMaster.filter(f=> f.filterId != filterId);\n\n    filterMaster = newFilterMaster;\n}\n\nexport function addFilter(filterType, attType, filterId, filFunction, oldData, newData, extra){\n    let filterOb = {'filterType': filterType, 'attributeType': attType, 'filterId': filterId, 'filterFunction':filFunction, 'before-data': oldData, 'data': newData}\n    if(extra != null){\n        extra.forEach(ex=> {\n            filterOb[ex[0]] = ex[1];\n        });\n    }\n    filterMaster.push(filterOb);\n    return filterOb;\n}\n\nexport function getLatestData(){\n    let data = filterMaster.length > 0 ? filterMaster[filterMaster.length - 1].data : dataMaster[0];\n    return data;\n}\n\nexport function getScales(){\n    return calculatedScalesKeeper[calculatedScalesKeeper.length - 1];\n}\n\n///NEED TO BREAK THESE OUT INTO SEPARATE FILTERS\nexport function toggleFilters(filterButton, main, scales){\n    console.log(filterButton, main, scales)\n\n    let filterDiv = d3.select('#filter-tab');\n    let data = getLatestData();\n\n    if(filterDiv.classed('hidden')){\n        filterButton.text('Hide Filters');\n        filterDiv.classed('hidden', false);\n        main.style('padding-top', '200px');\n\n        //move metric is 'edgeLength'\n\n        //renderAttToggles(filterDiv, data, scales);\n        stateFilter(filterDiv, filterButton, data, main, scales);\n        queryFilter(filterDiv, filterButton, data, main, scales);\n\n    }else{\n        filterButton.text('Show Filters');\n        filterDiv.selectAll('*').remove();\n        filterDiv.classed('hidden', true);\n        main.style('padding-top', '0px');\n    }\n}\nfunction addFilterTag(data, scales){\n\n    let filterToolbar = d3.select('#toolbar');\n\n    if(data.attributeType === 'continuous'){\n\n        let formater = d3.format(\".2s\");\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        d3.select(button).datum(data);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        let label = button.append('h6').text(data.selectedOption + \"  Predicted: \"+ formater(data.predictedFilter[0]) + \"-\" + formater(data.predictedFilter[1]) + \" Observed: \" + formater(data.observedFilter[0]) + \"-\" + formater(data.observedFilter[1]));\n        let xSpan = label.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            let filterLine = filterMaster.filter(f=> f.filterType === 'data-filter').filter(f=> data.attribute != f.attribute);\n            ////YOU NEED TO CHANGE THIS TO REMOVE FILTER FUNCTION\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'discrete'){\n     \n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(data.state[0]);\n        button.append('i').classed('fas fa-arrow-right', true);\n        button.append('h6').text(data.state[1] + '  ');\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'branch'){\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(' At Branch: ' + data.nodeId);\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView('Summary View');\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }\n    \n}\nfunction stateFilter(filterDiv, filterButton, normedPaths, main, moveMetric, scales){\n    let keys = ['Select a Trait'].concat(Object.keys(normedPaths[0][0].attributes));\n        let selectWrapper = filterDiv.append('div').classed('filter-wrap', true);\n        selectWrapper.style('width', '200px');\n        selectWrapper.append('h6').text('State Transition:');\n        let attButton = stateChange(selectWrapper, keys, 'attr-select', '');\n\n        let attProps = selectWrapper.append('div').classed('attribute-properties', true);\n\n        attButton.on(\"change\", function(d) {\n            var selectedOption = d3.select(this).property(\"value\");\n            let options = scales.filter(f=> f.field === selectedOption)[0];\n            attProps.selectAll('*').remove();\n\n            if(options.type === \"discrete\"){\n                let optionArray = ['Any'];\n                let optKeys = options.scales.map(s=> s.scaleName);\n                optionArray = optionArray.concat(optKeys);\n                let button1 = stateChange(attProps, optionArray, 'predicted-state', 'From');\n                let button2 = stateChange(attProps, optionArray, 'observed-state', 'To');\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n                    let fromState = button1.node().classList[0];\n                    let toState = button2.node().classList[0];\n\n                      ////GOING TO ADD FILTERING HERE//// NEED TO BREAK INTO ITS OWN THING/////\n                      \n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n              \n                    //let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n                    let data = getLatestData();\n              \n                    let test = discreteFilter(data, selectedOption, fromState, toState);\n\n                    let filId = 'd-'+filterMaster.filter(f=> f.attributeType === 'discrete').length;\n                    let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n                    updateMainView('Summary View');\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    /////ADD THE FILTER TO THE TOOLBAR////\n                    addFilterTag(filterOb, scales);\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }else{\n                \n                let yScale = d3.scaleLinear().domain([options.min, options.max]).range([60, 0]);\n               \n                let continRanges = attProps.append('svg');\n                continRanges.attr('width', 200).attr('height', 100);\n                let data = [{'label':'Ancestors', 'type': 'predicted'}, {'label':'Leaves', 'type': 'observed'}];\n                let ranges = continRanges.selectAll('.range').data(data).join('g').classed('range', true);\n\n                ranges.attr('transform', (d, i)=> 'translate('+((i*125)+',20)'));\n\n                let brushBars = ranges.append('g');\n                brushBars.attr('transform', 'translate(10, 10)');\n\n                let labels = ranges.append('text').text((d)=> d.label+ ': ');\n                labels.attr('x', 0).attr('y', 0);\n                let wrapperRect = brushBars.append('rect').attr('width', 20).attr('height', 50);\n                wrapperRect.attr('x', 10);\n\n                brushBars.append(\"g\")\n                .attr(\"class\", \"axis axis--y\")\n                .attr(\"transform\", \"translate(10,0)\")\n                .call(d3.axisLeft(yScale).ticks(3));\n                \n                let brushMoved = function(){\n                    var s = d3.event.selection;\n                    if (s == null) {\n                      handle.attr(\"display\", \"none\");\n                    \n                    } else {\n                      var sx = s.map(yScale.invert);\n                    }\n                };\n                let xBrush = d3.brushY().extent([[10,0], [30, 60]]).on(\"end\", brushMoved);\n                let brushGroup = brushBars.append('g').call(xBrush);\n                brushGroup.call(xBrush.move, [0, 60]);\n\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n\n                    let selections = brushGroup._groups[0].map(m=> m.__brush.selection.map(s=> s[1]));\n                    let predictedFilter = selections[0].map(yScale.invert).sort();\n                    let observedFilter = selections[1].map(yScale.invert).sort();\n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n\n                    let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n\n                    let test = continuousFilter(data, selectedOption, predictedFilter, observedFilter);\n\n                    let filId = 'c-'+filterMaster.filter(f=> f.attributeType === 'continuous').length;\n                    let filterOb = addFilter('data-filter', 'continuous', filId, continuousFilter, [...data], [...test], [['selectedOption', selectedOption], ['predictedFilter', predictedFilter], ['observedFilter', observedFilter]]);\n\n                    updateMainView('Summary View');\n\n                    /////ADD THE FILTER TO THE TOOLBAR/////\n                    addFilterTag(filterOb, scales);\n\n                    ///DIMMING THE FILTERED OUT NODES//////\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }\n         });\n}\nexport function nodeFilter(selectedNode, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path.map(node => node.node).indexOf(selectedNode) > -1;\n    });\n\n    let filId = 'b-'+filterMaster.filter(f=> f.attributeType === 'branch').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'branch', filId, nodeFilter, [...data], [...test], [['nodeId', selectedNode]])\n    addFilterTag(filterOb, scales);\n    updateMainView('Summary View');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\nexport function leafStateFilter(selectedState, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path[path.length - 1].attributes[selectedState.label].winState === selectedState.winState;\n    });\n\n    let filId = 'l-'+filterMaster.filter(f=> f.attributeType === 'leaf').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'leaf', filId, nodeFilter, [...data], [...test], [['leafState', [selectedState.label, selectedState.winState]]])\n    addFilterTag(filterOb, scales);\n    updateMainView('Summary View');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\n\nfunction continuousFilter(data, selectedOption, predicted, observed){\n\n    return data.filter(path=> {\n        let filterArray = path.map(node=> {\n            let numb = node.attributes[selectedOption].realVal;\n            if(node.leaf == true){\n                return numb > observed[0] && numb < observed[1];\n            }else{\n                return numb > predicted[0] && numb < predicted[1];\n            }\n        });\n        return filterArray.indexOf(false) === -1;\n    });\n}\nfunction discreteFilter(data, selectedOption, fromState, toState){\n    if(selectedOption != undefined){\n        return data.filter(path=> {\n            let filterPred = path.filter(f=> f.leaf != true).map(node=> {\n                let states = node.attributes[selectedOption].states;\n                if(fromState === 'Any'){\n                    return true;\n                }else{\n                    return states.filter(st=> st.state === fromState).length > 0 && states.filter(st=> st.state === fromState)[0].realVal > 0.75;\n                }\n            });\n            let filterObs = path.filter(f=> f.leaf === true).map(node=> {\n            let win = node.attributes[selectedOption].winState;\n            if(toState === 'Any'){\n                return true;\n            }else{\n                return win === toState;\n            }\n            });\n            return filterPred.indexOf(true) > -1 && filterObs.indexOf(true) > -1;\n        });\n    }\n}\nfunction queryFilter(filterDiv, filterButton, normedPaths, main, scales){\n\n    let moveMetric = 'edgeLength';\n\n    let searchDiv = filterDiv.append('div').classed('search-bar-div', true);\n        searchDiv.append('h6').text('Query Filter:');\n        let form = searchDiv.append('form').classed('form-inline', true);\n        let input = form.append('input').classed('form-control mr-sm-2', true);\n        input.attr('type', 'search').attr('placeholder', 'Search by Species').attr('aria-label', 'Search');\n        let searchButton = form.append('button').classed('btn btn-outline-success my-2 my-sm-0', true).attr('type', 'button').append('i').classed(\"fas fa-search\", true);\n        searchButton.on('click', ()=> {\n\n            let queryArray = input.node().value.split(' ').map(m=> m.toLowerCase());\n\n            let test = normedPaths.filter(path=> {\n                let species = path.filter(node=> node.leaf === true)[0].label;\n                return queryArray.indexOf(species) > -1;\n            });\n\n             ////DRAW THE PATHS\n         \n             updateMainView('Summary View');\n\n            let filterToolbar = d3.select(\"#toolbar\");\n            let button = filterToolbar.append('button').classed('btn btn-info', true);\n            let span = button.append('span').classed('badge badge-light', true);\n            span.text(test.length);\n            button.append('h6').text('Query Filter');\n            let xSpan = button.append('i').classed('close fas fa-times', true);\n            xSpan.on('click', ()=> {\n                updateMainView('Summary View');\n                button.remove();\n            });\n            d3.select('#main-path-view').style('height', ()=>{\n                return ((test.length * 60) + (Object.keys(test[0][0].attributes).length * 100) + 'px');\n            });\n\n            ////HIDE THE FILTER BAR/////\n            filterButton.text('Show Filters');\n            filterDiv.selectAll('*').remove();\n            filterDiv.classed('hidden', true);\n            main.style('padding-top', '0px');\n        });\n\n}\nfunction renderAttToggles(filterDiv, normedPaths, scales){\n\n    console.log(normedPaths, scales.map(m=> m.field))\n\n    ////NEED TO GET RID OF TOGGLE SVG\n   // let keys = Object.keys(normedPaths[0][0].attributes);\n   let keys = scales.map(m=> m.field);\n    let presentFilters = filterMaster.filter(f=> f.type === 'hide-attribute');\n    let noShow = presentFilters.length > 0 ? presentFilters.map(m=> m.attribute) : [];\n\n    let wrapper = filterDiv.append('div').classed('filter-wrap', true);\n    wrapper.style('width', '150px');\n   \n    let svg = wrapper.append('svg').classed('attr-toggle-svg', true);\n\n   let title = svg.append('text').text('Attributes: ');\n    title.attr('x', 20).attr('y', 10);\n    \n    let labelWrap = svg.append('g').attr('transform', 'translate(20, 25)');\n    let labelGroups = labelWrap.selectAll('g').data(keys).join('g'); \n    \n    labelGroups.attr('transform', (d, i)=> 'translate(0,'+(i* 25)+')');\n\n    let toggle = labelGroups.append('circle').attr('cx', 0).attr('cy', 0);\n    toggle.classed('toggle', true);\n    let shownToggs = toggle.filter(t=> noShow.indexOf(t) === -1);\n   \n    shownToggs.classed('shown', true);\n    shownToggs.style('fill', (d, i)=>{\n        return scales.filter(f=> f.field === d)[0].catColor;\n    });\n\n    toggle.on('click', function(d, i){\n        let togg = d3.select(this);\n        toggleCircle(togg, scales);\n        filterMaster.push({'type':'hide-attribute', 'attribute':d, 'before-data': [...normedPaths]});\n        let newKeys = d3.selectAll('.shown');\n        let hideKeys = scales.filter(sc=> newKeys.data().indexOf(sc.field) === -1);\n        let newFilMaster = filterMaster.filter(f=> f.type != 'hide-attribute');\n        hideKeys.forEach(key=> {\n            newFilMaster.push({'type':'hide-attribute', 'attribute':key.field, 'before-data': [...normedPaths], 'data': [...normedPaths]});\n        });\n        filterMaster = newFilMaster;\n    \n        updateMainView(\"Summary View\");\n    });\n    let labelText = labelGroups.append('text').text(d=> d).style('font-size', 10);\n    labelText.attr('transform', 'translate(10, 4)');  \n    \n}\nfunction stateChange(selectorDiv, keys, selectId, label){\n\n    let dropDownWrapper = selectorDiv.append('div').classed('selector', true);\n    let header = dropDownWrapper.append('h6').text(label);\n\n    \t// create the drop down menu of cities\n\tlet selectOp = dropDownWrapper\n    .append(\"select\")\n    .attr(\"id\", selectId).attr('class', 'Any');\n    \n    let options = selectOp.selectAll(\"option\")\n    .data(keys).join(\"option\");\n\n    options.text(d=> d).attr(\"value\", d=> d);\n\n    d3.select(\"#\"+selectId).on(\"change\", function(d) {\n       var selectedOption = d3.select(this).property(\"value\");\n       d3.select(this).attr('class', selectedOption);\n    });\n\n    return d3.select('#'+ selectId);\n}\nfunction toggleCircle(circle, scales){\n    if(circle.classed('shown')){\n        circle.classed('shown', false);\n        circle.style('fill', '#fff');\n    }else{\n        circle.classed('shown', true);\n        circle.style('fill', (d, i)=> scales.filter(f=> f.field === d)[0].catColor);\n    }\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {drawPathsAndAttributes, drawDiscreteAtt, drawGroups} from './renderPathView';\nimport {toggleFilters, getLatestData} from './filterComponent';\nimport { updateMainView } from './viewControl';\nimport { collapsed, calculatedScalesKeeper } from '.';\nimport { dropDown } from './buttonComponents';\nimport { cladesGroupKeeper, chosenCladesGroup, cladeKeeper } from './cladeMaker';\nimport { binGroups, renderDistStructure } from './distributionView';\n\n\nexport function findBrushedNodes(){\n    let brushes = d3.select('#toolbar').selectAll('.brush-span');\n    let brushData =  [];\n    brushes.each(e => brushData.push(e))\n  \n    let nodes = brushData.flatMap(m=> m.nodes);\n    return nodes;\n}\nexport function toolbarControl(toolbar, main, calculatedScales){\n\n    let viewArray = [{'field':'Summary View'},{'field':'Path View'},{'field':'Pair View'}, /*{'field':'Clade View'}*/ ];\n\n    let viewDrop = dropDown(toolbar, viewArray, viewArray[0].field, 'change-view');\n\n    viewDrop.on('click', (d, i, n)=> {\n        let group = chosenCladesGroup[chosenCladesGroup.length - 1];\n        updateMainView(d.field, group.groups);\n        d3.select('.dropdown.change-view').select('button').node().value = d.field;\n        d3.select('.dropdown.change-view').select('button').text(d.field)\n        d3.select('#change-view').classed('show', false);\n    });\n    \n    let filterButton = toolbar.append('button').attr('id', 'view-filter');\n    filterButton.attr('class', 'btn btn-outline-secondary').text('Show Filters');\n    filterButton.on('click', ()=> toggleFilters(filterButton, main, calculatedScales));\n    ///LENGTH BUTTON CODE\n\n    let scrunchButton = toolbar.append('button').attr('id', 'scrunch');\n    scrunchButton.attr('class', 'btn btn-outline-secondary').text('Collapse Attributes');\n    scrunchButton.attr('value', false);\n    scrunchButton.on('click', ()=> toggleScrunch(scrunchButton, main, calculatedScales));\n\n    let discreteViewButton = toolbar.append('button').attr('id', 'discrete-view');\n    discreteViewButton.attr('class', 'btn btn-outline-secondary').text('Switch to Discrete Bars');\n    discreteViewButton.attr('value', false);\n    \n    discreteViewButton.on('click', ()=> {\n        let discretePredictedGroups = d3.selectAll('.predicated-attr-groups');\n        if(discreteViewButton.text() === 'Switch to Discrete Bars'){\n            discreteViewButton.text('Switch to Discrete Dots');\n            drawDiscreteAtt(discretePredictedGroups, collapsed, true);\n        }else{\n            discreteViewButton.text('Switch to Discrete Bars');\n            drawDiscreteAtt(discretePredictedGroups, collapsed, false);\n        }\n    });\n\n    let optionArray = [{'field':'None'}];\n\n    calculatedScales.map(m=> {\n        if(m.type === 'discrete'){\n            optionArray.push(m);\n        }\n    });\n\n    let dropOptions = dropDown(toolbar, optionArray, 'Group By', 'show-drop-div-group');\n    toolbar.select('#show-drop-div-group').attr('value', 'ungrouped');\n\n    d3.select('.dropdown.show-drop-div-group').select('button').style('display', 'none')\n\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            let data = getLatestData();\n            let stateBins = d.scales.map(m=> {\n                return {'field': m.field, 'state': m.scaleName, 'data': []}});\n           \n            stateBins.map(state=> {\n               state.data = data.filter(paths=> {\n                    let node = paths.filter(no=> no.leaf === true);\n                        return node[0].attributes[state.field].winState === state.state;\n                });\n            });\n           d3.select('#main').selectAll('*').remove();\n           drawGroups(stateBins, calculatedScales);\n        }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        toolbar.select('#show-drop-div-group').classed('show', false);\n    });\n\n    /////ATTRIBUTE DROP DOWN\n    let attributeOptions = calculatedScales.map(m=> m.field).filter(f=> f != \"Clade\");\n    let checkedAttributes = attributeOptions.length > 11 ? attributeOptions.slice(0, 8) : attributeOptions;\n\n    let dropdiv = toolbar.append('div').classed(`dropdown attribute-show`, true);\n    dropdiv.style('display', 'inline-block')\n    let button = dropdiv.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text('Shown Attributes');\n    let dropContent = dropdiv.append('div').attr('id', 'attribute-show').classed('dropdown-content', true);\n    let dropUl = dropContent.append('ul');\n    \n    let attoptions = dropUl.selectAll('li').data(attributeOptions).join('li')\n    let checkBox = attoptions.append('input').attr('type', 'checkbox');\n    attoptions.append('text').text(d=> ` ${d}`);\n\n    let checkedDefault = attoptions.filter(f=> checkedAttributes.indexOf(f) > -1).select('input');\n    checkedDefault.each((d, i, n) => n[i].checked = true);\n\n    button.on('click', (d, i, n)=> {\n        if(dropContent.classed('show')){\n            dropContent.classed('show', false);\n            updateMainView('Summary View', chosenCladesGroup[chosenCladesGroup.length - 1].groups)\n        }else{\n            dropContent.classed('show', true);\n        }\n    });\n\n    // /////CLADE VIEW////\n    // let cladePickerDrop = dropDown(toolbar, cladesGroupKeeper, `Clades Shown: ${cladesGroupKeeper[0].field}`, 'change-clade');\n    // d3.select('#change-clade').selectAll('a').on('click', (d, i, n)=> {\n    //     d3.select('.dropdown.change-clade').select('button').text(`Clades Shown: ${d.field}`)\n    //     chosenCladesGroup.push(d)\n    //     updateMainView('Summary View', d.groups);\n    // });\n    // if(cladesGroupKeeper.length === 0){\n    //     d3.select('.dropdown.change-clade').select('button').text(d.field);\n    // }\n\n    /////ATTRIBUTE DROP DOWN\n    let cladeOptions = cladeKeeper;\n   // let checkedClades = attributeOptions.length > 11 ? attributeOptions.slice(0, 2) : attributeOptions;\n\n    let dropdivClade = toolbar.append('div').classed(`dropdown clade-show`, true);\n    dropdivClade.style('display', 'inline-block')\n    let buttonClade = dropdivClade.append('button').classed('btn dropbtn btn-secondary dropdown-toggle', true).text('Shown Clades');\n\n    let dropContentClade = dropdivClade.append('div').attr('id', 'clade-show').classed('dropdown-content', true);\n    let dropUlClade = dropContentClade.append('ul');\n\n    let options = updateCladeDrop(dropUlClade, cladeOptions);\n\n    buttonClade.on('click', (d, i, n)=> {\n        if(dropContentClade.classed('show')){\n            dropContentClade.classed('show', false);\n           \n           let test = d3.select('#clade-show').selectAll('li').selectAll('input').filter((f, j, li)=> {\n                return li[j].checked === true});\n            \n                let groups = test.data().map((m=> {\n                let names = m.nodes.map(path => path[path.length - 1].node);\n                let data = getLatestData().filter(path => names.indexOf(path[path.length - 1].node) > -1);\n                \n                let group = binGroups(data, m.field, calculatedScalesKeeper[0], 8);\n                return {'label': m.field, 'paths': data, 'groupBins': group};\n           }));\n\n           d3.select('#summary-view').remove();\n           \n           renderDistStructure(main, groups);  \n\n        }else{\n            dropContentClade.classed('show', true);\n        }\n    });\n}\n\nexport function updateCladeDrop(dropUl, cladeOptions){\n\n    let options = dropUl.selectAll('li').data(cladeOptions).join('li')\n    let checkBox = options.selectAll('input').data(d=> [d]).join('input').attr('type', 'checkbox');\n    options.selectAll('text').data(d=> [d]).join('text').text(d=> ` ${d.field}`);\n    \n    if(cladeOptions.length < 1){\n        d3.select('.dropdown.clade-show').select('button').classed('hidden', true);\n    }else{\n        d3.select('.dropdown.clade-show').select('button').classed('hidden', false);\n    }\n\n    return options;\n    \n    // let checkedDefault = options.filter(f=> checkedAttributes.indexOf(f) > -1).select('input');\n}\n////COLLAPSES THE NODES DOWN\nfunction toggleScrunch(button, main, calculatedScales){\n\n    let data = getLatestData();\n   \n    if(button.text() === 'Collapse Attributes'){\n        button.text('Expand Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', true);\n        drawPathsAndAttributes(data, main, calculatedScales);\n    }else{\n        button.text('Collapse Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', false);\n        drawPathsAndAttributes(data, main, calculatedScales);\n    }\n}","import {dataMaster, nestedData, calculatedScalesKeeper} from './index';\nimport { updateDropdown } from './buttonComponents';\nimport * as d3 from \"d3\";\nimport { addingEdgeLength, assignPosition, renderTree, renderTreeButtons, traitColorDropDown } from './sidebarComponent';\nimport { maxTimeKeeper } from './dataFormat';\nimport { getLatestData, getScales } from './filterComponent';\nimport { renderDistStructure, binGroups } from './distributionView';\nimport { updateMainView } from './viewControl';\nimport { pullPath } from './pathCalc';\nimport { updateCladeDrop } from './toolbarComponent';\n\nexport const cladesGroupKeeper = []\nexport const chosenCladesGroup = []\nexport const cladeKeeper = []\n\n\n\nexport function growSidebarRenderTree(attrDraw){\n\n    let sidebar = d3.select('#sidebar');\n    let cladeBool = null;\n\n    sidebar.classed('clade-view', true);\n    d3.select('#main').classed('clade-view', true);\n\n    sidebar.select('.tree-svg').remove();\n    sidebar.select('.button-wrap').selectAll('*').remove();\n\n    traitColorDropDown(getScales(), sidebar.select('.button-wrap'), growSidebarRenderTree);\n\n    let x = sidebar.select('.button-wrap').append('div')\n    .style('position', 'absolute')\n    .style('right', '5px')\n    .style('top', '18px')\n    .append('i')\n    .classed('close fas fa-times', true)\n    .style('padding-right', '10px');\n\n    x.on('click', ()=> {\n     \n        sidebar.classed('clade-view', false);\n        d3.select('#main').classed('clade-view', false);\n\n        sidebar.selectAll('*').remove();\n\n        ////REDRAW SIDEBAR\n        renderTreeButtons(getLatestData(), sidebar, false);\n        renderTree(sidebar, null, true, false);\n\n    });\n\n    const dimensions =  {\n        margin : {top: 10, right: 90, bottom: 50, left: 20},\n        width : 400,\n        height : (getLatestData().length * 7),\n        lengthHeight: 500,\n    }\n   \n    renderCladeTree(sidebar, null, dimensions);\n\n    let leaf = sidebar.select('.tree-svg').selectAll('.node--leaf');\n    let nodes = sidebar.select('.tree-svg').selectAll('.node');\n    let link = sidebar.select('.tree-svg').selectAll('.link');\n\n    let nodeData = getLatestData();\n  \n    function  findCommonNode(path1, path2, className){\n\n        let common = path1.filter(f=> path2.map(m=> m.node).indexOf(f.node) > -1);\n        let subtreeFinder = [nestedData[0]];\n        let commonNodeMark = nodes.filter(f=> f.data.node === common[common.length - 1].node);\n      \n        common.map(m=> m.node).map((m, i)=> {\n            if(i > 0){\n                let child = subtreeFinder[subtreeFinder.length - 1].children.filter(f=> {\n                    return f.node === m})[0];\n                subtreeFinder.push(child)\n            }\n        })\n\n        let paths = pullPath([subtreeFinder[subtreeFinder.length - 1]], subtreeFinder[subtreeFinder.length - 1].children, [], [], 0);\n        \n        let nodeNames = paths.flatMap(path => path.map(p=> p.node))\n        nodes.filter(f=> nodeNames.indexOf(f.data.node) > -1).select('circle').classed(className, true);//.attr('fill', 'orange');\n        link.filter(f=> nodeNames.filter((n)=> n != common[common.length - 1].node).indexOf(f.data.node) > -1).classed(className, true);//.style('stroke', 'orange');\n\n        return paths;\n\n    }\n   \n    labelTree(leaf);\n\n    if(attrDraw != null){\n       // let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = nodes.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaf.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaf.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        nodes.selectAll('circle').attr('fill', 'gray');\n    }\n\n    leaf.on('click', (d, i, n)=> {\n   \n        d3.select(n[i]).select('circle').attr('fill', 'orange').attr('r', '5');\n        if(cladeBool === null){\n            cladeBool = d;\n        }else{\n            let dat1 = nodeData.filter(f=> f[f.length-1].node === cladeBool.data.node)[0];\n            let dat2 = nodeData.filter(f=> f[f.length-1].node === d.data.node)[0];\n            let paths = findCommonNode(dat1, dat2, 'selected');\n\n            let wrap = sidebar.select('.button-wrap').append('form').classed(\"form-inline\", true)\n            .append('div').classed(\"form-group\", true).style('width', '300px');\n            \n            let textInput = wrap.append('input').attr('type', 'text')\n            .classed('form-control', true)\n            .attr('placeholder', 'Clade Name');\n\n            let button = wrap.append('div').classed('input-group-append', true).append('button').attr('type', 'button').classed('btn btn-outline-secondary', true);\n            button.text('Add Clade');\n            \n            button.on('click', ()=> {\n                let name = textInput.node().value != \"\" ? textInput.node().value : `Clade-${cladeKeeper.length}`\n                addClade(name, paths);\n                growSidebarRenderTree(null);\n                let ul = d3.select('div#clade-show').selectAll('ul');\n                updateCladeDrop(ul, cladeKeeper);\n            });\n            cladeBool = null;\n        }\n    });\n    leaf.on('mouseover', (d, i, n)=> {\n        if(cladeBool!=null){\n            let dat1 = nodeData.filter(f=> f[f.length-1].node === cladeBool.data.node)[0];\n            let dat2 = nodeData.filter(f=> f[f.length-1].node === d.data.node)[0];\n            findCommonNode(dat1, dat2, 'selected-hover');\n        }\n\n    }).on('mouseout', ()=> {\n        sidebar.selectAll('.selected-hover').classed('selected-hover', false);\n    });\n\n   sidebar.select('.tree-svg').classed('clade-view', true).append('g').classed('overlay-brush', true);\n\n}\n\nexport function addClade(name, nodes){\n    console.log('in add clade',name, nodes)\n    cladeKeeper.push({field: name, nodes: nodes})\n}\n\nexport function addCladeGroup(name, clades, nodes){\n    cladesGroupKeeper.push({field: name, names: clades, groups:nodes});\n    return {field: name, names: clades, groups:nodes};\n}\n\nexport function removeCladeGroup(clades){\n    cladeKeeper = cladeKeeper.filter(f=> f.groupKey != clades.groupKey);\n}\n\n\nfunction createNewCladeGroup(div, scales){\n    let cladeNames = []\n    let clades = []\n    d3.selectAll('.clade-name').each((e, i, n)=> {\n       cladeNames.push(n[i].value);\n       let rectTest = d3.select(`.rect-${i + 1}`).node().getBoundingClientRect();\n       let nodes = div.select('.tree-svg.clade-view').selectAll('.node--leaf').filter((f, j, node)=> {\n           let circPos = node[j].getBoundingClientRect();\n           return circPos.y >= rectTest.y-4 && circPos.y <= ((rectTest.y + rectTest.height) - 4);\n       })\n       nodes.select('circle').attr('fill', 'red');\n       clades.push({'clade': n[i].value , 'nodes': nodes.data().map(m=> m.data)})\n    });\n \n    let groupName = d3.select('.group-name').node().value;\n    let chosenGroup = addCladeGroup(groupName, cladeNames, clades);\n    updateDropdown(cladesGroupKeeper, 'change-clade');\n    let groups = groupDataByClade(scales, getLatestData(), chosenGroup);\n\n    d3.select('.dropdown.change-clade').select('button').text(`Clades Shown: ${chosenGroup.field}`);\n\n    updateMainView('Summary View', groups);\n    renderTree(d3.select('#sidebar'), null, true, false)\n}\n\n// function cladeToolbar(div, scales){\n\n//     let toolBar = div.append('div').classed('clade-toolbar', true);\n//     let textInput = toolBar.append('input')\n//     .classed('group-name', true)\n//     .attr('type', 'text')\n//     .attr('value', 'Name Your Group');\n  \n//     let addCladeGroupButton = toolBar.append('button').text('Add Clade Group');\n//     addCladeGroupButton.on('click', ()=> createNewCladeGroup(div, scales));\n\n//     let inputGroup = toolBar.append('div').classed('input-group input-number-group', true);\n//     let minusButton = inputGroup.append('button').text('-');\n   \n//     let numberText = inputGroup.append('input')\n//         .attr('value', 3)\n//         .attr('min', 0)\n//         .attr('max', 10)\n//         .attr('type', 'number')\n//         .classed('input-number', true);\n\n//     let plusButton = inputGroup.append('button').text('+');\n\n//     let nameWrap = inputGroup.append('div').classed('name-input-wrap', true);\n//     minusButton.on('click', ()=> {\n//         let num = numberText.attr('value');\n//         numberText.attr('value', +num - 1);\n//         addTextInputForGroups(+numberText.attr('value'), nameWrap);\n//     });\n\n//     plusButton.on('click', ()=> {\n//         let num = numberText.attr('value');\n//         numberText.attr('value', +num + 1);\n//         addTextInputForGroups(+numberText.attr('value'), nameWrap);\n//     });\n\n//     addTextInputForGroups(+numberText.attr('value'), nameWrap);\n\n//     function addTextInputForGroups(index, nameWrap){\n       \n//         nameWrap.selectAll('*').remove();\n//         d3.selectAll('.overlay-brush').selectAll('rect').remove();\n//         for(let ind = 0; ind < index; ind = ind + 1){\n//             nameWrap.append('input')\n//             .classed('clade-name', true)\n//             .attr('value', `Group ${ind+1}`)\n//             .attr('type', 'text');\n\n//             let rectGroup = d3.select('.overlay-brush').append('g').classed(`group-${ind}`, true)\n\n//             let rect = rectGroup.append('rect')\n//             .classed(`rect-${ind + 1}`, true)\n//             .attr('height', 100)\n//             .attr('width', 910)\n//             .attr('opacity', 0.3)\n//             .attr('transform',  (d, i, n)=> `translate(${0},${((800 / index) * ind)})`);\n\n//             let rectSizer = rectGroup.append('rect').attr('class', `handle-${ind}`)\n//             .attr('width', 700)\n//             .attr('height', 20)\n//             .attr('y', rect.node().getBoundingClientRect().y + 20)\n//             .attr('opacity', 0)\n//             .call(d3.drag()\n//             .on('drag', function(){\n//                 let dragPos = d3.mouse(this);\n//                 let dragY = d3.event.y\n//                 d3.select(this).attr('y', dragPos[1]);\n//                 let height = +d3.select(`.rect-${ind + 1}`).attr('height')\n//                 let rectY = d3.select(`.rect-${ind + 1}`).node().getBoundingClientRect().bottom;\n//                 d3.select(`.rect-${ind + 1}`).attr('height', height + (dragY-rectY) + 70);\n//             }));\n            \n//             rect.call(d3.drag().on('drag', function(){\n//                 let dragPos = d3.mouse(this);\n//                 let dragY = d3.event.y\n//                 d3.select(this).attr('y', dragPos[1]);\n//                 let rectH = d3.select(`.rect-${ind + 1}`).node().getBoundingClientRect().height;\n//                 d3.select(`.handle-${ind}`).attr('y', dragY + (rectH - 20));\n//             }))\n//         }\n//     }\n// }\n\nfunction labelTree(nodes){\n    nodes.append('text')\n    .text(d=> d.data.node)\n    .attr('font-size', 9)\n    .attr('x', 4)\n    .attr('y', 2)\n}\n\nexport async function createCladeView(div, scales){\n    drawTreeForGroups(div);\n    cladeToolbar(div, scales);\n}\n\nexport function renderCladeTree(sidebar, att, dimensions){\n\n     addingEdgeLength(0, nestedData[0]);\n    \n    let treeFun = data => {\n        const root = d3.hierarchy(data);\n        return d3.tree().size([dimensions.width, dimensions.height])(root);\n      }\n\n    let treenodes = treeFun(nestedData[0]);\n\n    let treeSvg = sidebar.append(\"svg\").classed('tree-svg', true);\n    let g = treeSvg.append(\"g\").classed('tree-g', true);\n   \n    ////Break this out into other nodes////\n    updateCladeTree(treenodes, dimensions, treeSvg, g, att, true);\n    \n    /////END TREE STUFF\n    ///////////\n}\n\nexport function findDepth(node, array){\n    function stepDown(n){\n        if(n.children != null){\n            n.children.forEach(child=> {\n                stepDown(child);\n            })\n        }else{\n            array.push(n);\n        }\n    }\n    stepDown(node);\n    return array;\n}\n\nexport function updateCladeTree(treenodes, dimensions, treeSvg, g, attrDraw, length){\n    \n    assignPosition(treenodes, 0);\n\n    treeSvg.attr(\"width\", dimensions.width + dimensions.margin.left + dimensions.margin.right)\n    .attr(\"height\", dimensions.height + (dimensions.height / 1.5));\n\n    findDepth(treenodes, []);\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.width]).clamp(true);\n    let yScale = d3.scaleLinear().range([dimensions.height, 0]).domain([0, getLatestData().length])\n    g.attr('transform', `translate(30, ${dimensions.height / 1.9})`);\n\n    let link = g.selectAll(\".link\")\n    .data( treenodes.descendants().slice(1))\n    .join(\"path\")\n    .attr(\"class\", \"link\");\n\n    link.transition()\n    .duration(500)\n    .attr(\"d\", function(d) {\n       \n           return \"M\" + xScale(d.data.combEdge) + \",\" + yScale(d.position)\n           + \"C\" + (xScale(d.data.combEdge) + xScale(d.parent.data.combEdge)) / 2 + \",\" + yScale(d.position)\n           + \" \" + (xScale(d.parent.data.combEdge)) + \",\" + yScale(d.position)\n           + \" \" + xScale(d.parent.data.combEdge) + \",\" + yScale(d.parent.position);\n     \n    });\n\n    // adds each node as a group\n    var node = g.selectAll(\".node\")\n    .data(treenodes.descendants(), d => d.data.node)\n    .join(\"g\")\n    .attr(\"class\", function(d) { \n    return \"node\" + \n    (d.children ? \" node--internal\" : \" node--leaf\"); });\n\n    // adds the circle to the node\n    node.selectAll('circle').data(d=> [d]).join(\"circle\")\n      .attr(\"r\", 3);\n\n    node.transition()\n    .duration(500)\n    .attr(\"transform\", function(d) { \n            return \"translate(\" + xScale(d.data.combEdge) + \",\" + yScale(d.position) + \")\"; \n    });\n\n    if(attrDraw != null){\n        let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = node.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaves.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)//f.data.attributes[attrDraw.field].winState === att.state;\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaves.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        node.selectAll('circle').attr('fill', 'gray');\n    }\n\n    node.on('mouseover', (d, i, n)=> {\n        let paths = d3.select('#main-path-view').selectAll('.paths');\n        let points = d3.select('#main-summary-view').selectAll('.branch-points');\n        points.filter(f=> f.node === d.data.node).classed('selected', true);\n\n        let selectedPaths = paths.filter(path=> {\n            let nodes = path.map(m=> m.node);\n            return nodes.indexOf(d.data.node) > -1;\n        }).classed('hover', true);\n        selectedPaths.selectAll('g').filter(g=> g.node === d.data.node).classed('selected', true);\n        d3.select(n[i]).classed('selected-branch', true);\n\n        if(d.data.label){\n            let tool = d3.select('#tooltip');\n            tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n          \n            tool.html(`${d.data.label.charAt(0).toUpperCase() + d.data.label.slice(1)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n        }\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.selectAll('.paths.hover').classed('hover', false);\n        d3.selectAll('g.selected').classed('selected', false);\n        d3.select(n[i]).classed('selected-branch', false);\n\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    let leaves = node.filter(f=> f.data.children.length == 0);\n\n    node.selectAll('text').remove();\n    node.selectAll('.triangle').remove();\n\n    let branchNodes = node.filter(n=> n.branchPoint === true);\n    branchNodes.each((b, i, n)=> {\n        if(b.children === null){\n            let triangle = d3.select(n[i]).append('path').classed('triangle', true).attr('d', d3.symbol().type(d3.symbolTriangle).size('400'))\n            triangle.attr('transform', `rotate(-90) translate(0, 65) scale(.9 4)`);\n            triangle.attr('fill', 'gray').style('opacity', 0.3);\n            let text = d3.select(n[i]).selectAll('text').data(d=> [d]).join('text').text(b.clade);\n            text.attr('transform', 'translate(55, 5)');\n        }\n    })\n    branchNodes.select('circle').attr('fill', 'red').attr('r', 4.5);\n    branchNodes.on('click', (d, i, n)=> {\n        if(d.children == null){\n            uncollapseSub(d);\n        }else{\n            collapseSub(d);\n        }\n        let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n        updateCladeTree(treenodes, dimensions, treeSvg, treeSvg.select('g'), attrDraw, lengthBool);\n      \n    });\n\n    node.raise();\n    node.selectAll('circle').raise();\n\n    return node;\n}","import '../styles/index.scss';\nimport {formatAttributeData, maxTimeKeeper} from './dataFormat';\nimport * as d3 from \"d3\";\nimport {filterMaster, getLatestData, getScales} from './filterComponent';\nimport { pullPath } from './pathCalc';\nimport { renderTree } from './sidebarComponent';\nimport { chosenCladesGroup } from './cladeMaker';\nimport { updateMainView } from './viewControl';\n\nconst dimensions = {\n    height: 80,\n    observedWidth : 200,\n    predictedWidth : 900,\n    margin : 20,\n    squareDim : 15,\n    timeRange: 895\n}\n\nconst brushColors = [\n    ['#64B5F6', '#F39C12'],\n    ['#6A1B9A', '#FDD835'],\n]\n\nconst compareColors = [{light: '#F8C471', dark: '#F39C12'}, {light: '#A3E4D7', dark: '#17A589'}]\n\nconst defaultBarColor = '#baaaaa'//#DCD4D4';\n\nlet colorBool = 0;\nconst selectedClades = [[]];\n\nexport function groupDistributions(pathData, mainDiv, groupAttr){\n\n    let scales = getScales();\n\n    let groupKeys = scales.filter(f=> f.field === groupAttr)[0].scales.map(s=> s.scaleName)\n  \n    let branchBinCount = d3.median(pathData.map(m=> m.length)) - d3.min(pathData.map(m=> m.length))\n   \n    let pathGroups = groupKeys.map(group => {\n        let paths = pathData.filter(path => {\n            return group.includes(path[path.length - 1].attributes[groupAttr].values[groupAttr]);\n        });\n\n        let groupBins = binGroups(paths, group, scales, branchBinCount);\n        return {'label': group, 'paths': paths, 'groupBins': groupBins}\n    });\n\n    renderDistStructure(mainDiv, pathGroups);\n}\nexport function binGroups(pathData, groupLabel, scales, branchCount){\n\n    let attrHide = filterMaster.filter(f=> f.type === 'hide-attribute').map(m=> m.attribute);\n    \n    let keys = scales.map(s=> s.field).filter(f=> attrHide.indexOf(f) === -1);\n\n    let newNormed = [...pathData];\n    let keysToHide = attrHide.length > 0 ? scales.filter(f=> attrHide.indexOf(f.field) === -1).map(m=> m.field) : null;\n\n    formatAttributeData(newNormed, scales, keysToHide);\n\n    let maxBranch = d3.max(newNormed.map(p=> p.length)) - 1;\n  \n    let max = maxTimeKeeper[0]\n\n    let normBins = new Array(branchCount).fill().map((m, i)=> {\n            let step = max / branchCount;\n            let base = (i * step);\n            let top = ((i + 1)* step);\n            return {'base': base, 'top': top, 'binI': i , 'step':step}\n    });\n\n    let internalNodes = newNormed.map(path => path.filter(node=> (node.leaf != true) && (node.root != true)));\n    let leafNodes = newNormed.flatMap(path => path.filter(node=> node.leaf === true));\n    let rootNodes = newNormed.flatMap(path => path.filter(node=> node.root === true));\n\n    normBins.map((n, i)=> {\n        let edges = internalNodes.flatMap(path => path.filter(node=> {\n                return node.combLength > n.base && node.combLength <= n.top;\n        } ));\n        n.data = edges;\n        return n;\n    });\n\n    let sortedBins = keys.map(key=> {\n        let scale = scales.filter(f=> f.field === key)[0];\n    \n        let mapNorm = normBins.map(bin => {\n            if(bin.data.length > 0){\n                bin.fData = bin.data.map(d=> {\n                    return d.attributes[key];\n                })\n            }else{\n                bin.fData = [];\n            }\n            return {'data': bin.fData, 'range': [bin.base, bin.top], 'index': bin.binI, 'key': key };\n        });\n       \n        let leafAttr = leafNodes.map(m=> m.attributes[key]);\n        let leafData = {'data': leafAttr};\n   \n        if(scale.type === 'continuous'){\n            let x = d3.scaleLinear().domain([scale.min, scale.max]).range([0, dimensions.height]);\n    \n            let histogram = d3.histogram()\n            .value(function(d) { return d.values.realVal; })  \n            .domain(x.domain())  \n            .thresholds(x.ticks(20)); \n  \n            mapNorm.map((n, i, nodeArray)=> {\n                n.type = scale.type;\n                n.bins = histogram(n.data);\n                n.domain = [scale.max, scale.min];\n                n.bins.count = branchCount;\n                n.bins.groupLabel = groupLabel;\n\n                if(d3.mean(n.bins.map(m=> m.length)) === 0){\n                    if(i === 0){\n                         n.bins = histogram(rootNodes.map(m=> m.attributes[key]));\n                         n.data = rootNodes.map(m=> m.attributes[key]);\n                         n.bins.count = branchCount;\n\n                    }else{\n                        n.bins = nodeArray[i-1].bins;\n                        n.data = nodeArray[i-1].data;\n                    }\n                }\n                return n;\n            });\n\n            //Histogram for observed////\n            let maxO = d3.max(leafAttr.flatMap(v=> +v.values.realVal));\n            let minO = d3.min(leafAttr.flatMap(v=> +v.values.realVal));\n            let xO = d3.scaleLinear().domain([minO, maxO]).range([0, dimensions.height])\n\n            let histogramO = d3.histogram()\n            .value(function(d) { \n                return +d.values.realVal; })  \n            .domain(xO.domain())  \n            .thresholds(xO.ticks(20)); \n\n            leafData.bins = histogramO(leafAttr);\n      \n            let newK = {'key': key, \n                    'branches': [...mapNorm], \n                    'type': scale.type, \n                    'leafData': leafData, \n                    'rootData': rootNodes.map(m=> m.attributes[key])[0]}\n   \n            return newK;\n\n        }else{\n            //HANDLING DISCRETE//\n            let states = leafAttr[0].scales.scales;\n           \n            let stateKeys = states[0].state? states.map(s=> s.state) : states.map(s=> s.scaleName)\n          \n            let rootNode = rootNodes[0].attributes[key]\n            rootNode.bins = d3.entries(rootNodes[0].attributes[key].values).map(m=> {       \n                let states = [{'state': m.key, 'value':m.value}];\n                return {state: states, branchCount:branchCount, color : scale.stateColors.filter(f=> f.state === m.key)[0], max:80};\n               });\n            \n            mapNorm.bins = null\n            leafData.bins = states.map(s=> {\n                return leafAttr.filter(f=> s.scaleName.includes(f.states.state))});\n   \n            let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.height]);\n            let y = d3.scaleLinear().domain([0, 1]).range([0, 40]);\n\n            let histogram = d3.histogram()\n            .value(function(d) { return d.value; })  \n            .domain(y.domain())  \n            .thresholds(y.ticks(10)); \n  \n            mapNorm.map((n, i, nodeArray)=> {\n                \n                let colors = scale.stateColors;\n                n.bins = stateKeys.map(state=> {\n                    let test = n.data.flatMap(m=> Object.entries(m.values).filter(f=> f[0] === state))\n                    .map(m=> {\n                        return {'state': m[0], 'value':m[1]}\n                    });\n                    \n                    return {state: test, branchCount:branchCount, histogram: histogram(test), color : colors.filter(f=> f.state === state)[0], max:80};\n                });\n                //IF WE DONT HAVE ANY BRANCHES< WE ASSUME THAT THEY ARE THE SAME AS THE PREVIOUS\n                if(n.bins[0].state.length === 0){\n                    if(i === 0){\n                        n.bins = d3.entries(rootNode.values).map(m=> {\n                            let histo = histogram([+m.value]).map(h=>{\n                                if(m.value <= h.x1 && m.value >= h.x0){\n                                    h.push(+m.value);\n                                }\n                                return h;\n                             });\n                             let states = [{'state': m.key, 'value':m.value}];\n                             return {state: states, branchCount:branchCount, histogram: histo, color : colors.filter(f=> f.state === m.key)[0], max:80};\n                            });\n                        \n                    }else{\n                        n.bins = nodeArray[i-1].bins;\n                    }\n                }\n\n                n.type = scale.type;\n                return n;\n            });\n\n            let newK = {'key': key, \n                        'branches': [...mapNorm], \n                        'type': scale.type, \n                        'leafData': leafData, \n                        'rootData': rootNodes.map(m=> m.attributes[key])[0],\n                        'stateKeys': stateKeys,\n                        'maxCount': d3.max(mapNorm.map(n=> n.data.length))\n                    }\n            return newK;\n        }\n    });\n\n    sortedBins.group = groupLabel;\n    sortedBins.branchCount = branchCount;\n    sortedBins.keys = keys;\n    return sortedBins;\n}\nexport function drawBranchPointDistribution(data, svg){\n\n    let branchBar = svg.append('g').classed('branch-bar', true);\n    branchBar.append('rect').classed('point-dis-rect', true)\n        .attr('height', 25)\n        .attr('x', -10)\n        .attr('y', -10)\n       .attr('fill', 'none')\n\n    let binWrap = branchBar.append('g').attr('transform', 'translate(102, -10)');\n\n    branchBar.append('line')\n        .attr('y1', 2)\n        .attr('y2', 2)\n        .attr('x1', '100')\n        .attr('x2', dimensions.predictedWidth)\n        .attr('stroke', 'gray')\n        .attr('stroke-width', .25);\n\n    branchBar.append('text').text('Root').attr('transform', 'translate(70, 7)');\n    let leafLabel = branchBar.append('g').classed('leaf-label', true).attr('transform', `translate(${dimensions.predictedWidth + 200}, 7)`);\n    leafLabel.append('text').text('Leaves');\n\n    let nodeLengthArray = [];\n    let nodeDuplicateCheck = []\n\n    data.paths.map(path=> {\n        path.filter(n=> n.leaf != true).map(node=> {\n            if(nodeDuplicateCheck.indexOf(node.node) == -1){\n                nodeDuplicateCheck.push(node.node);\n                nodeLengthArray.push({'node': node.node, 'eMove': node.combLength });\n            }\n        })\n    });\n\n    let bPointScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange]);\n    let pointGroups = branchBar.selectAll('g.branch-points').data(nodeLengthArray)\n        .join('g').attr('class', (d, i)=> d.node).classed('branch-points', true);\n\n    pointGroups.attr('transform', (d, i) => {\n        return `translate(${(105 + bPointScale(d.eMove))}, 0)`});\n    pointGroups.append('circle').attr('r', 5).attr('fill', '#fff').attr('opacity', 0.5);\n\n    let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange]);\n    \n    let binsRects = binWrap\n        .selectAll('rect.bin')\n        .data(data.groupBins[0].branches.map(m=> m.range))\n        .join('rect')\n        .classed('bin', true);\n\n    binsRects.attr('width', (d, i, n)=> {\n        return x(d[1]) - x(d[0]);\n    }).attr('height', 20);\n\n    binsRects.attr('transform', (d, i, n)=> {\n        let step = x(d[1]) - x(d[0]);\n        return `translate(${step*i},0)`});\n\n    binsRects.attr('fill', 'gray').attr('stroke-width', 2).attr('stroke', 'white');\n\n    let axis = d3.axisBottom(x);\n    let axGroup = branchBar.append('g').call(axis)\n    axGroup.attr('transform', 'translate(103, 10)');\n    axGroup.select('path').attr('stroke-width', 0);\n\n    return branchBar;\n}\nexport function drawGroupLabels(pathData, svg, groupLabel){\n\n    let leafNames = pathData[0].leafData.data.map(m=> m.node);\n    let nodeNames = getLatestData().filter(f=> leafNames.indexOf(f[f.length - 1].node) > -1).flatMap(fl=> fl.map(m=> m.node))\n\n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n\n    let cladeLabel = svg.append('g').classed('clade-label', true).attr('transform', 'translate(10, 0)');\n    cladeLabel.append('rect')\n        .attr('width', 50)\n        .attr('height', (pathData.keys.length * (dimensions.height+ 15)))\n        .attr('fill', 'gray')\n        .style('opacity', 0.2)\n        .on('mouseover', (d, i)=>{\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f=> {\n                return nodeNames.indexOf(f.data.node) > -1;\n            }).classed('hover clade', true);\n        \n        treeLinks.filter(f=> {\n            return nodeNames.indexOf(f.data.node) > -1;\n        }).classed('hover clade', true);\n\n        let species = d.paths.map(m=> m[m.length - 1].label);\n        }).on('mouseout', (d, i)=> {\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.classed('hover clade', false);\n            treeLinks.classed('hover clade', false);\n        });\n\n    cladeLabel.append('text').text(d=> d.label)\n    .style('text-anchor', 'middle')\n    .attr('transform', `translate(23, ${(shownAttributes.length * (dimensions.height+ 15)/2)}), rotate(-90)`);\n\n    return cladeLabel;\n}\n/**\n * \n * @param {*} mainDiv \n * @param {*} pathGroups \n */\nexport function renderDistStructure(mainDiv, pathGroups){\n\n    let compareTooltipFlag = false;\n   \n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n   \n    let groupWrap = mainDiv.append('div').attr('id', 'summary-view');\n    let groupDivs = groupWrap.selectAll('.group-div').data(pathGroups).join('div').classed('group-div', true);\n\n    groupDivs.each((d, i, node)=> {\n       let filteredAttributes = d.groupBins.filter(f=> {\n           return shownAttributes.indexOf(f.key) > -1;\n       });\n\n        let group = d3.select(node[i]);\n        group.style('text-align', 'center');\n        group.append('text').text(d.label);\n        group.append('text').text(` : ${d.paths.length} Paths` );\n\n        //////Starting something new/////\n        let svg = group.append('svg');\n        svg.attr('class', 'main-summary-view');\n        svg.attr('id', `${d.label}-svg`);\n        svg.attr('height', (shownAttributes.length * (dimensions.height + 5))+ 50);\n    \n        let branchBar = drawBranchPointDistribution(d, svg);\n        branchBar.attr('transform', 'translate(55, 10)');\n\n        group.classed(d.label, true);\n    \n        let branchScale = d3.scaleLinear().domain([0, d.groupBins.branchCount]).range([0, dimensions.timeRange]);\n        let pointGroups = branchBar.selectAll('g.branch-points');\n      \n        let wrap = svg.append('g').classed('summary-wrapper', true);\n        wrap.attr('transform', 'translate(70, 50)');\n    \n        let binnedWrap = wrap.selectAll('.attr-wrap').data(filteredAttributes).join('g').attr('class', d=> d.key + ' attr-wrap');\n    \n        binnedWrap.attr('transform', (d, i, n)=>  {\n                if(i === 0){\n                    return 'translate(0,0)';\n                }else{\n                    let selected = d3.selectAll(n).filter((f, j)=>j < i).data();\n                    let sum = d3.sum(selected.flatMap(s=> s.type === 'continuous'? dimensions.height+5 : (s.stateKeys.length*(dimensions.squareDim+4))));\n                    d.sum = sum;\n                    return `translate(0, ${sum})`;\n                }\n        });\n\n        let label = binnedWrap.append('text')\n        .text(d=> d.key);\n\n        label.filter(f=> f.type === 'continuous')\n        .attr('y', 40)\n        .attr('x', 80)\n        .style('text-anchor', 'end')\n        .style('font-size', 11);\n\n        label.filter(f=> f.type === 'discrete')\n        .attr('y', (d, i)=> 3)\n        .attr('x', d=> -((d.stateKeys.length)*(dimensions.squareDim)/2))\n        .style('text-anchor', 'middle')\n        .style('font-size', 11)\n        .attr('transform', 'rotate(-90)');\n    \n        let groupLabelBars = drawGroupLabels(d.groupBins, svg, d.label);\n\n        groupLabelBars.on('click', (d, i, n)=> {\n            if(compareTooltipFlag){\n                compareTooltipFlag = false;\n                d3.select(\"#compare-tooltip\").classed(\"hidden\", true);\n            }else{\n                   \n                compareTooltipFlag = true;\n                d3.select(\"#compare-tooltip\")\n                    .style(\"left\", (d3.event.pageX) + \"px\")\n                    .style(\"top\", (d3.event.pageY - 28) + \"px\")\n                    .select(\"#value\")\n                    .text(d.node);\n\n                d3.select(\"#compare-tooltip\").classed(\"hidden\", false);\n                d3.select('#select-for-compare').on('click', ()=> {\n\n                    compareTooltipFlag = false;\n                    d3.select(\"#compare-tooltip\").classed(\"hidden\", true);\n                    d3.select(n[i]).select('rect').attr('fill', '#F5B041');\n\n                    selectedClades[selectedClades.length - 1].push(Object.assign({},d));\n                    if(selectedClades[selectedClades.length - 1].length > 1){\n                        mainDiv.selectAll('*').remove();\n                        mainDiv.select('#compare-wrap').remove();\n                        console.log('rendering',mainDiv, selectedClades[selectedClades.length - 1], branchScale)\n                        renderDistributionComparison(mainDiv, selectedClades[selectedClades.length - 1], branchScale);\n                    }\n                });\n            }\n        });\n           \n       // });\n        renderDistibutions(binnedWrap, branchScale, pointGroups);\n    });\n}\n\nfunction renderDistributionComparison(div, data, branchScale){\n\n\n    let shownAttributes = d3.select('#attribute-show').selectAll('input').filter((f, i, n)=> n[i].checked === true).data();\n  \n    let divWrap = div.append('div').attr('id', 'compare-wrap');\n\n    let groupHeader = divWrap.append('div').classed('compare-header', true).style('margin', 'auto');\n\n    let textDiv = groupHeader.append('div').attr('height', 50).attr('width', 200).style('margin-left', '460px');\n    let branchPointSvg  = groupHeader.append('svg');\n\n    let pointData = {paths: data[0].paths.concat(data[1].paths), groupBins: data[0].groupBins}\n    let branchBar = drawBranchPointDistribution(pointData, branchPointSvg);\n    branchBar.attr('transform', 'translate(-30, 10)')\n\n    //'#DCD4D4'\n\n    branchBar.selectAll('rect.bin').attr('stroke', '#fff').attr('stroke-width', '3px');\n    let pointGroups = branchBar.selectAll('g.branch-points');\n  \n    let xOut = groupHeader.append('div')\n    .style('position', 'absolute')\n    .style('left', '5px')\n    .style('top', '65px')\n    .append('i')\n    .classed('close fas fa-times', true)\n    .style('padding-left', '10px');\n    \n    xOut.on('click', (d, i, n)=> {\n        divWrap.remove();\n        selectedClades.push(new Array());\n        updateMainView('Summary View', chosenCladesGroup[chosenCladesGroup.length-1].groups);\n        d3.select('#sidebar').selectAll('.node').remove();\n        d3.select('#sidebar').selectAll('.link').remove();\n        renderTree(d3.select('#sidebar'), null, true);\n    });\n\n    if(data.length > 1){\n//ADD THIS BACK IN//\n       // renderTree(d3.select('#sidebar'), null, true);\n\n        d3.select('#toolbar').selectAll('.brush-span').remove();\n       \n        let selectedNodes = Array.from(new Set(data.flatMap(f=> f.paths).flatMap(p=> p.map(m=> m.node))));\n   \n        let testNodes = d3.select('#sidebar').selectAll('.node').filter(f=> selectedNodes.indexOf(f.data.node) === -1);\n        let testLinks = d3.select('#sidebar').selectAll('.link').filter(f=> selectedNodes.indexOf(f.data.node) === -1);\n\n        testNodes.attr('opacity', 0.3)\n        testLinks.attr('opacity', 0.3)\n\n        let pathsListOne = Array.from(new Set(data[0].paths.flatMap(p=> p.map(m=> m.node))));\n        let pathsListTwo = Array.from(new Set(data[1].paths.flatMap(p=> p.map(m=> m.node))));\n\n        let testNodesOne = d3.select('#sidebar').selectAll('.node').filter(f=> pathsListOne.indexOf(f.data.node) > -1);\n        let testLinksOne = d3.select('#sidebar').selectAll('.link').filter(f=> pathsListOne.indexOf(f.data.node) > -1);\n\n        testNodesOne.attr('opacity', .8).selectAll('circle').attr('fill', compareColors[0].dark)\n        testLinksOne.attr('opacity', .8).style('stroke', compareColors[0].dark)\n\n        let testNodesTwo = d3.select('#sidebar').selectAll('.node').filter(f=> pathsListTwo.indexOf(f.data.node) > -1);\n        let testLinksTwo = d3.select('#sidebar').selectAll('.link').filter(f=> pathsListTwo.indexOf(f.data.node) > -1);\n\n        testNodesTwo.attr('opacity', .8).selectAll('circle').attr('fill', compareColors[1].dark)\n        testLinksTwo.attr('opacity', .8).style('stroke', compareColors[1].dark)\n\n        textDiv.append('i')\n        .classed('fas fa-arrow-left', true)\n        .style('margin-right', '10px');\n\n        data.forEach((d, i)=> {\n        textDiv.append('span')\n            .text(d.label)\n            .classed('badge badge-secondary', true)\n            .style('padding', '5px')\n            .style('margin-bottom', '7px')\n            .style('background', compareColors[i].light)\n        });\n\n        textDiv.append('i')\n        .classed('fas fa-arrow-right', true)\n        .style('margin-left', '10px');\n        \n    }\n    let svg = divWrap.append('svg').attr('class', 'compare-svg').style('padding-top', '50px');\n\n    ////COMBINEDATA///\n    if(data.length > 1){\n       \n        let startBins = data[0].groupBins.filter(f=> shownAttributes.indexOf(f.key) > -1);\n        let mapBins = data[1].groupBins.filter(f=> shownAttributes.indexOf(f.key) > -1);\n        let combined = startBins.map((d, i, n)=> {\n         \n            d.branches = [...d.branches].map((b, j)=> {\n                \n                b.bins = [{key:data[0].label, value: b.bins, index:0},\n                          {key:data[1].label, value: mapBins[i].branches[j].bins, index:1}\n                         ];\n             \n                b.data = [{key: data[0].label, \n                            value: b.data.map(m=>{\n                                    m.groupKey = data[0].label;\n                                    m.index = 0;\n                                    return m;\n                                    }), \n                            index: 0},\n                        \n                        { key: data[1].label, \n                            value : mapBins[i].branches[j].data.map(m=> {\n                                    m.groupKey = data[1].label;\n                                    m.index = 1;\n                                    return m;\n                            }), \n                         index: 1 }];\n                return b;\n            });\n          \n           if(d.type === 'continuous'){\n\n            d.leafData.data = [{key: data[0].label, \n                value: d.leafData.data.map(m=>{\n                        m.groupKey = data[0].label;\n                        m.index = 0;\n                        return m;\n                        }), \n                index: 0},\n            \n            { key: data[1].label, \n                value : mapBins[i].leafData.data.map(m=> {\n                        m.groupKey = data[1].label;\n                        m.index = 1;\n                        return m;\n                }), \n             index: 1 }];\n\n             d.leafData.bins = [{key:data[0].label, value: d.leafData.bins, index:0},\n             {key:data[1].label, value: mapBins[i].leafData.bins, index:1}\n                ];\n\n\n\n           }else{\n\n            d.leafData.data = [{key: data[0].label, \n                value: d.leafData.data.map(m=>{\n                        m.groupKey = data[0].label;\n                        m.index = 0;\n                        return m;\n                        }), \n                index: 0},\n            \n            { key: data[1].label, \n                value : mapBins[i].leafData.data.map(m=> {\n                        m.groupKey = data[1].label;\n                        m.index = 1;\n                        return m;\n                }), \n             index: 1 }];\n\n             d.leafData.bins = [\n                \n                {key:data[0].label, keys: d.stateKeys, value: d.leafData.bins, index:0},\n                {key:data[1].label, keys: d.stateKeys, value: mapBins[i].leafData.bins, index:1}\n\n                ];\n\n           }\n           \n            return d;\n        });\n\n        let wrap = svg.append('g').attr('class', 'group-wrap').attr('transform', 'translate(30, 10)');\n        let binnedWrap = wrap.selectAll('.attr-wrap').data(combined).join('g').classed('attr-wrap', true);\n        svg.attr('height', (combined.length * (dimensions.height + 5)));\n        \n        binnedWrap.attr('transform', (d, i, n)=>  {\n            if(i === 0){\n                    return 'translate(0,0)';\n            }else{\n                let selected = d3.selectAll(n).filter((f, j)=>j < i).data();\n                let sum = d3.sum(selected.flatMap(s=> s.type === 'continuous'? dimensions.height+5 : (s.stateKeys.length*(dimensions.squareDim+4))));\n                d.sum = sum;\n                return `translate(0, ${sum})`;\n            }\n        });\n\n        let label = binnedWrap.append('text')\n            .text(d=> d.key);\n    \n            label.filter(f=> f.type === 'continuous')\n            .attr('y', 40)\n            .attr('x', 80)\n            .style('text-anchor', 'end')\n            .style('font-size', 11);\n    \n            label.filter(f=> f.type === 'discrete')\n            .attr('y', (d, i)=> 3)\n            .attr('x', d=> -((d.stateKeys.length)*(dimensions.squareDim)/2))\n            .style('text-anchor', 'middle')\n            .style('font-size', 11)\n            .attr('transform', 'rotate(-90)');\n\n        /////FROM DISCRETE DRAW\n\n        let predictedWrap = binnedWrap.append('g').classed('predicted', true);\n        predictedWrap.attr('transform', 'translate(25, 0)');\n        predictedWrap.filter(f=> f.type === 'discrete').append('g').classed('win-line', true);\n\n        //ROOT RENDERING\n        let root = predictedWrap.selectAll('g.root').data(d=> {\n            return [d.rootData]}).join('g').classed('root', true);\n        root.attr('transform', `translate(60,0)`);\n\n        let contRoot = root.filter(f=> f.type === \"continuous\");\n        contRoot.append('rect')\n            .attr('height', dimensions.height)\n            .attr('width', 12)\n            .attr('fill', '#fff')\n            .style('stroke-width', '0.5px')\n            .style('stroke', 'black')\n    \n        let rootRange = contRoot.append('rect')\n            .attr('width', 12)\n            .attr('height', d=> {\n                let newy = d.scales.yScale;\n                newy.range([(dimensions.height - 5), 0]);\n                return newy(d.values.lowerCI95) - newy(+d.values.upperCI95)\n            }).attr('transform', (d, i) => {\n                let newy = d.scales.yScale;\n                newy.range([(dimensions.height - 5), 0]);\n                return 'translate(0,'+newy(+d.values.upperCI95)+')'\n            }).style('opacity', 0.5)//.attr('fill', \"rgba(133, 193, 233)\")\n            .attr('fill', defaultBarColor);\n    \n        let rootAv = contRoot.append('rect').attr('width', 12).attr('height', 3);\n        \n        rootAv.attr('transform', (d, i) => {\n                let newy = d.scales.yScale;\n                newy.range([dimensions.height, 0]);\n                let mean = +d.values.realVal;\n                return 'translate(0,'+newy(mean)+')';\n        }).attr('fill', '#004573');\n    \n           // Discrete Root\n        let disRoot = root.filter(f=> f.type === \"discrete\");\n        let rootStateGroups = disRoot.selectAll('g.root-state-groups').data(d=> {\n            return d.bins}).join('g').classed('root-state-groups', true);\n    \n        rootStateGroups.append('text')\n            .text((d, i)=> d.color.state)\n            .attr('y', 10)\n            .attr('x', -3)\n            .style('font-size', 10)\n            .style('text-anchor', 'end');\n    \n        rootStateGroups.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n        rootStateGroups.append('rect')\n            .attr('height', dimensions.squareDim)\n            .attr('width', dimensions.squareDim)\n            .attr('fill', '#fff').attr('opacity', 1);\n    \n        let rootRects = rootStateGroups.append('rect')\n            .classed('color-rect', true)\n            .attr('height', dimensions.squareDim)\n            .attr('width', dimensions.squareDim);\n    \n        rootRects.attr('fill', (d, i)=> {\n                return `rgba(89, 91, 101, ${d.state[0].value})`;\n            }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n    \n        let winStateRoot = disRoot.selectAll('g.root-state-groups')\n            .filter((f, j, n)=>{\n                let maxVal = d3.max(d3.selectAll(n).data().map(m=> m.state[0].value));\n                return f.color.state === d3.selectAll(n).data().filter(m=> m.state[0].value === maxVal)[0].color.state;\n            }).classed('win', true);\n    \n        winStateRoot.select('rect.color-rect').attr('fill', (c, i)=> {\n                return c.color.color;\n            }).attr('opacity', (c)=>{\n                let sum = d3.sum(c.state.flatMap(s=> s.value));\n                return sum/c.state.length;\n            });\n\n        ////BRANCHES\n        let branchGroup = predictedWrap.selectAll('g.branch-bin').data(d=> {\n            return d.branches}).join('g').classed('branch-bin', true);\n    \n        branchGroup.attr('transform', (d, i, n)=> {\n            let step = n.length < 11 ? (d.range[1] - d.range[0]) / 5 : 0\n            let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange])\n                return 'translate('+(100 + (branchScale(i)) + x(step)) +', 0)'});\n\n        let discreteDist = branchGroup.filter(f=> f.type === 'discrete').append('g');\n\n        discreteDist.attr('transform', 'translate(5, 0)');\n\n        let discreteMiddleGroups = discreteDist.selectAll('g.middle-group')\n            .data(d=> {\n                let bins = d.bins.map(b=> {\n                    b.key = d.key;\n                    return b;\n                })\n                return bins})\n            .join('g')\n            .classed('middle-group', true)\n            .attr('transform', (d, i)=> { \n                let move = d.index === 0 ? -(dimensions.squareDim/2) : 0 ;\n                return `translate(${move}, 0)`});\n\n        let stateRects = discreteMiddleGroups\n        .selectAll('rect.state-rect')\n        .data(d=> {\n            let bins = d.value.map(v=> {\n                v.key = d.key;\n                return v;\n            })\n            return bins})\n        .join('rect')\n        .classed('state-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim/2);\n\n        stateRects.attr('fill', (d, i, n)=> {\n            let sum = d3.sum(d.state.map(m=> m.value))\n            let av = sum / d.state.length;\n            let scale = d3.scaleLinear().domain([0, 1]).range([0, 1]);\n            return `rgba(89, 91, 101, ${scale(av)})`;\n        }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n        stateRects.attr('transform', (d, i)=> {\n            return `translate(0, ${(3.5+(i*(dimensions.squareDim+2)))})`\n        });\n\n        let discreteBinGroups = discreteDist.selectAll('g.group')\n                .data(d=> d.bins)\n                .join('g')\n                .classed('group', true)\n                .attr('transform', (d, i)=> { \n                    let move = d.index === 0 ? (-40 - (dimensions.squareDim/2)) : (dimensions.squareDim/2)\n                    return `translate(${move}, 0)`});\n\n        let stateBarsPredicted = discreteBinGroups.selectAll('g.histo-bars')\n            .data(d=> {\n                let binvalue = d.value.map(v=> {\n                    v.index = d.index;\n                    return v;\n                })\n            return binvalue}).join('g')\n        .classed('histo-bars', true);\n\n        stateBarsPredicted.attr('transform', (d, i)=> {\n            let dev = d3.deviation(d.state.map(m=> m.value));\n            let mean = d3.mean(d.state.map(m=> m.value));\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 40]).clamp(true);\n            let xMove = d.index === 0 ? (40 - x(mean)) : 0;\n            return `translate(${xMove}, ${3.5+(i*(dimensions.squareDim+2))})`\n        });\n\n        let bars = stateBarsPredicted.append('rect')\n            .attr('height', dimensions.squareDim)\n            .attr('width', (d, i, n)=> {\n        let dev = d3.deviation(d.state.map(m=> m.value));\n        let mean = d3.mean(d.state.map(m=> m.value));\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 40]).clamp(true);\n            return x(mean)\n        })\n        .attr('fill', d=> d.color.color)\n        .attr('opacity', 0.3);\n\n        stateRects.on('mouseover', (d, i, n)=> {\n           \n            let sum = d3.sum(d.state.map(m=> m.value))\n            let av = sum / d.state.length;\n            let tool = d3.select('#tooltip');\n            tool.transition()\n                .duration(200)\n                .style(\"opacity\", .9);\n            \n            let f = d3.format(\".3f\");\n              \n            tool.html(`${d.key} </br> ${d.state[0].state} : ${f(av)}`)\n                .style(\"left\", (d3.event.pageX - 40) + \"px\")\n                .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n    \n        }).on('mouseout', ()=>{\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n        });\n\n        discreteMiddleGroups.each((d, i, node)=>{\n            let maxBin = 0;\n            let maxState = null;\n            d.value.map(m=> {\n                if(d3.sum(m.state.flatMap(s=> s.value)) > maxBin){\n                    maxBin = d3.sum(m.state.flatMap(s=> s.value));\n                    maxState = m.color.state;\n                }\n            });\n      \n            let winStates = d3.select(node[i]).selectAll('rect.state-rect')\n                .filter((f, j, n)=>{\n                    return f.color.state === maxState;\n                }).classed('win', true)\n                .attr('fill', (c)=> {\n                    return c.color.color;\n                }).attr('opacity', (c)=>{\n                    let sum = d3.sum(c.state.flatMap(s=> s.value));\n                    return sum/c.state.length;\n                })\n        });\n    \n        //////PREDICTED CONTINUOUS\n\n          //CONTIN PREDICTED\n        let continDist = branchGroup.filter(f=> f.type === 'continuous');\n\n        continDist.on('mouseover', (d, i, node)=> {\n            let newData = d.data;\n            let list = newData[0].value.concat(newData[1].value).map(m=> m.node);\n            let selected = pointGroups.filter(p=> {\n                return list.indexOf(p.node) > -1}).classed('selected', true);\n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f=> list.indexOf(f.data.node) > -1).classed('selected-branch', true);\n            let y = d3.scaleLinear().domain(d.domain).range([0, dimensions.height])\n            let axis = d3.select(node[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n        }).on('mouseout', (d, i, node)=> {\n            d3.selectAll(\".branch-points.selected\").classed('selected', false);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            d3.select(node[i]).select('.y-axis').remove();\n        });\n\n        let continBinGroups = continDist.selectAll('g.group').data(d=> {\n            return d.bins;\n        }).join('g').attr('class', d=> `g-${d.index} group`)//.classed('group', true);\n\n        continBinGroups.each((d, i, nodes)=> {\n            d.maxCount = d3.sum(d.value.map(m=> m.length));\n            d.value.maxCount = d3.sum(d.value.map(m=> m.length));\n            let distrib = d3.select(nodes[i])\n                .selectAll('g')\n                .data([d.value.map(v=> {\n                    v.maxCount = d3.sum(d.value.map(m=> m.length))\n                    v.index = d.index;\n                    return v;\n                })])\n                .join('g')\n                .classed('distribution', true);\n            distrib.attr('transform', (d,i,n)=> {\n                if(d[0].index === 0){\n                    return 'translate(0, 0) rotate(90)'\n                }else{\n                    return 'translate(11, '+dimensions.height+') rotate(-90)'\n                }\n               });\n            let path = distrib.append('path').attr('d', d.index === 0 ? mirrorlineGen : lineGen);\n            path.attr(\"fill\", (v, i, n)=> {\n                return defaultBarColor})\n            .attr('opacity', 0.4)\n            .style('stroke', compareColors[d.index].dark);\n        });\n\n        let contRect = continBinGroups.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 10)\n        .style('fill', '#fff')\n        .style('stroke', 'gray');\n\n    let rangeRectWrap = continDist.selectAll('g.range-wrap').data(d=> {\n        return d.data;\n    }).join('g').classed('range-wrap', true);\n    \n    let rangeRect = rangeRectWrap.selectAll('rect.range').data((d,i)=> {\n        let newData = d.value.map(m=> {\n            m.range = d.range;\n            m.gindex = i;\n            return m;\n        })\n        return newData;\n    }).join('rect').classed('range', true);\n\n    let avRect = continDist.selectAll('rect.av-rect').data(d=> d.data)\n        .join('rect').classed('av-rect', true).attr('width', 10).attr('height', (d, i)=> {\n        if(d.value != undefined){\n            return 3;\n        }else{\n            return 0;\n        }\n    });\n    \n    avRect.attr('transform', (d, i) => {\n        if(d.value != undefined){\n            let newy = d.value[0].scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = d3.mean(d.value.map(m=> +m.values.realVal));\n            return 'translate(0,'+newy(mean)+')';\n        }else{\n            return 'translate(0,0)';\n        }\n    }).attr('fill', (d)=>compareColors[d.index].dark);\n\n     //////START BRANCH EXPERIMENT\n     let brush = d3.brushY().extent([[0, 0], [20, dimensions.height]])\n     brush.on('end', brushedComparison);\n\n     continDist.append(\"g\")\n     .classed('continuous-branch-brush', true)\n     .attr(\"class\", \"brush\")\n     .call(brush);\n\n     //////BRUSH FOR COMPARISON/////\n\n     function brushedComparison(){\n\n        let data = d3.select(this.parentNode).data()[0]\n\n        let maxCounts = data.bins.map(m => m.maxCount);\n       \n        var s = d3.event.selection;\n        var zero = d3.format(\".3n\");\n    \n        let index = d3.select('#toolbar').selectAll('.brush-span').size();\n        let classLabel = index === 0 ? 'one' : 'two';\n    \n        if(s != null){\n            let treeTest = d3.select('#sidebar').selectAll('.node').filter(f=> {\n                return f.data.leaf === true});\n    \n            \n            let y = d3.scaleLinear().domain([data.domain[0], data.domain[1]]).range([0, dimensions.height])\n            let attribute = data.key;\n            let brushedVal = [y.invert(s[1]), y.invert(s[0])];\n    \n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n            let nodes = data.data.map(m=> m.value.filter(f=> {\n                return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n            }));\n\n\n            let otherBins = continDist.filter(f=> f.index === data.index && f.key != data.key);\n\n            let descendBins = continDist.filter(f=> {\n                return (f.index > data.index) && (f.key === data.key)});\n                \n            \n\n            nodes.forEach((n, i)=> {\n               \n                if(n.length > 0){\n                    let test = d3.select(this.parentNode).select(`.g-${i}`)\n                    let groupDis = test.append('g').classed('distribution-too', true);\n                    \n                    let histo = continuousHistogram(n)\n                    histo.maxCount = maxCounts[i];\n\n                    let names = n.map(m=> m.node);\n                   \n                    groupDis\n                    .data([histo]);\n\n                    groupDis.append('path')\n                    .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                    .style('stroke', compareColors[i].dark)\n                    .style('fill', compareColors[i].light)\n                    .style('fill-opacity', 0.8);\n\n                    groupDis.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n                    let otherDis = otherBins\n                    .select(`.g-${i}`).each((o, j, oNode)=> {\n                        let oHisto = continuousHistogram(o.data.filter(f=> f.index === i)[0].value.filter(f=> names.indexOf(f.node) > -1));\n                        oHisto.maxCount = o.bins[i].maxCount;\n                        let oDist = d3.select(oNode[j]).append('g').classed('distribution-too', true);\n                        oDist.data([oHisto])\n                        .append('path')\n                        .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                        .style('stroke', compareColors[i].dark)\n                        .style('fill', compareColors[i].light)\n                        .style('fill-opacity', 0.8);\n                        oDist.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n                    });\n\n                    let otherDesDis = descendBins\n                    .select(`.g-${i}`).each((o, j, oNode)=> {\n\n                        let oHisto = continuousHistogram(o.data.filter(f=> f.index === i)[0].value\n                                    .filter(f=> (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1])));\n                        oHisto.maxCount = o.bins[i].maxCount;\n\n                        let oDist = d3.select(oNode[j]).append('g').classed('distribution-too', true);\n                        oDist.data([oHisto])\n                        .append('path')\n                        .attr('d', i === 0 ? mirrorlineGen : lineGen)\n                        .style('stroke', compareColors[i].dark)\n                        .style('fill', compareColors[i].light)\n                        .style('fill-opacity', 0.8);\n                        oDist.attr('transform', i === 0 ? 'translate(0, 0) rotate(90)' : `translate(11, ${dimensions.height}) rotate(-90)`);\n\n                    });\n                  \n                }\n            });\n\n             let nodesFlat = data.data.flatMap(m=> m.value.filter(f=> {\n                return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n            }));\n\n           \n            let notNodes = data.data.flatMap(m=> m.value.filter(f=> {\n                return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n            }));\n    \n            let selectedNodes = brushedNodes(nodesFlat, notNodes, data, brushedVal, classLabel);\n            let selectedBranch = selectedNodes[0];\n            let secondGrp = selectedNodes[1];\n            let antiSelected = selectedNodes[2];\n            let antiSecond = selectedNodes[3];\n    \n            if(index < 2){\n                let doesItExist = d3.select('#toolbar').selectAll('.brush-span').filter((f, i, n)=> {\n                    return d3.select(n[i]).attr('value') == `${data.bins.groupLabel}-${data.key}`;\n                });\n    \n                if(doesItExist.size() === 0){\n    \n                    d3.select(this).select('.selection')\n                    .style('fill', `${brushColors[index][0]}`)\n                    .attr('stroke', `${brushColors[index][0]}`)\n                    .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                    .attr('stroke', brushColors[index][1])\n                    .attr('stroke-width', 2);\n    \n                    let badge = d3.select('#toolbar')\n                        .append('span')\n                        .attr('class', classLabel)\n                        .attr('id', classLabel)\n                        .classed('brush-span', true)\n                        .classed(`${data.bins.groupLabel}`, true)\n                        .classed('badge badge-secondary', true)\n                        .style('background', brushColors[index][0])\n                        .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                        .datum({brush:this, nodes: nodes})\n                        .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n    \n                    let xOut = badge.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        let classy = index === 0 ? 'one' : 'two';\n                        \n                        d3.select(d.brush).call(brush.move, null);\n                        d3.select(n[i].parentNode).remove();\n                        d3.select(d.brush).select('.overlay').attr('stroke-width', 0);\n                        descendBins.selectAll('.distribution-too').remove();\n                        otherBins.selectAll('.distribution-too').remove();\n                        d3.select(d.brush.parentNode).selectAll('.distribution-too').remove();\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed-second', false);\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed', false);\n                    });\n    \n                }else{\n\n                    doesItExist.text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                    let xOut = doesItExist.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        d3.select(d).call(brush.move, null);\n                        d3.select(d).select('.overlay').attr('stroke-width', 0);\n                        d3.select(n[i].parentNode).remove();\n                    });\n                   \n                    d3.select(doesItExist.datum()).call(brush.move, null);\n                    d3.select(doesItExist.datum()).select('.overlay').attr('stroke-width', 0)\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll(`${data.bins.groupLabel}`)\n                        .selectAll('.second-branch')\n                        .classed('second-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.selected-branch')\n                        .classed('selected-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-second')\n                        .classed('anti-brushed-second', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-branch')\n                        .classed('anti-brushed-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n    \n                    let label = doesItExist.attr('id');\n    \n                    index = label === 'one' ? 0 : 1;\n    \n                    d3.select(this).select('.selection')\n                        .style('fill', `${brushColors[index][0]}`)\n                        .attr('stroke', `${brushColors[index][0]}`)\n                        .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                        .attr('stroke', brushColors[index][1])\n                        .attr('stroke-width', 2);\n\n                        let nodes = data.data.flatMap(m=> m.value.filter(f=> {\n                            return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n                        }))\n                       \n                        let notNodes = data.data.flatMap(m=> m.value.filter(f=> {\n                            return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n                        }));\n\n                        doesItExist.datum({brush: this, nodes: nodes})\n    \n                    brushedNodes(nodes, notNodes, data, brushedVal, label);\n                    \n                }\n    \n            }else{\n    \n                d3.select('#toolbar').selectAll('.brush-span').filter((f, i)=> i === 0).remove();\n    \n                let classLabel = colorBool === 0 ? 'one': 'two';\n    \n                d3.select('#toolbar')\n                    .append('span')\n                    .attr('class', )\n                    .classed('brush-span', true)\n                    .classed('badge badge-secondary', true)\n                    .style('background', brushColors[colorBool][0])\n                    .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                    .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n\n                colorBool === 0 ? colorBool = 1 : colorBool = 0;\n                secondGrp.classed(classLabel, true);\n                selectedBranch.classed(classLabel, true);\n            }\n    \n        }else{\n            d3.selectAll(`.${data.key}.brushed-branch`).classed('brushed-branch', false);\n            d3.selectAll(`.${data.key}.brushed-second`).classed('brushed-second', false);\n        }\n     }\n    \n\n    ///OBSERVED/////\n    let observedWrap = binnedWrap.append('g').classed('observed', true);\n    observedWrap.attr('transform', (d, i, n)=> {\n        return 'translate('+ (dimensions.predictedWidth + 150) +', 0)'});\n\n    ////OBSERVED CONTIUOUS/////\n    let contOb = observedWrap.filter(f=> f.type === 'continuous');\n    contOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, -15)`);\n\n    let compContGroups = contOb.selectAll('g.cont-groups').data(d=> d.leafData.bins).join('g').classed('cont-groups', true);\n\n    let contBars = compContGroups.selectAll('g.ob-bars').data(d=> {\n        let value = d.value.map(m=> {\n            m.index = d.index;\n            return m;\n        });\n        return value}).join('g').classed('ob-bars', true);\n\n    let cRects = contBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i)=> {\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(dimensions.height - dimensions.margin), 0])\n        return y(Object.keys(d).length - 2)\n    })\n    .attr('fill', d=> compareColors[d.index].light).attr('fill-opacity', .4);\n\n    contBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let y = d3.scaleLinear()\n            .domain([0, Object.keys(d).length])\n            .range([(dimensions.height - dimensions.margin), 0]);\n\n     let movey = dimensions.height - y(Object.keys(d).length - 2);\n     return 'translate('+(movex * i)+', '+movey+')'});\n\n contOb.each((d, i, nodes)=> {\n\n     let xvalues = d.leafData.data[0].value.map(m=> {\n         return +m.values.realVal});\n     let x = d3.scaleLinear()\n         .domain([d3.min(xvalues), d3.max(xvalues)])\n         .range([0, dimensions.observedWidth]);\n\n     let y = d3.scaleLinear()\n         .domain([0, d3.max(d.leafData.bins[0].value.map(b=> Object.keys(b).length)) - 2])\n         .range([(dimensions.height - dimensions.margin), 0]);\n     \n     d3.select(nodes[i])\n         .append('g')\n         .classed('x-axis', true)\n         .call(d3.axisBottom(x))\n         .attr('transform', 'translate(0, '+dimensions.height+')')\n\n     d3.select(nodes[i]).append('g')\n         .classed('y-axis', true)\n         .call(d3.axisLeft(y).ticks(4))\n         .attr('transform', 'translate(0, '+dimensions.margin+')');\n\n         d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n         d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n\n         d3.select(nodes[i])\n         .append('g')\n         .classed('x-axis-label', true)\n         .append('text').text('Frequency')\n         .attr('transform', `translate(-20, ${dimensions.height- 10}) rotate(-90)`)\n         .style('font-size', '10px');\n });\n \n        ////Observed Discrete////\n        let discOb =  observedWrap.filter(f=> f.type === 'discrete');\n\n        discOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, 5)`);\n\n        let compDisGroups = discOb.selectAll('g.dis-groups').data(d=> d.leafData.bins).join('g').classed('dis-groups', true);\n\n        let discBars = compDisGroups.selectAll('g.ob-bars').data(d=> {\n            \n            return d.keys.map((key, i)=>{\n                return {state: key, data: d.value[i], max: d3.sum(d.value[i].map(b=> b.length)), index: d.index}\n            });\n        }).join('g').classed('ob-bars', true);\n        let dRects = discBars.append('rect').attr('width', (d, i, n)=> {\n            let width = dimensions.observedWidth / n.length;\n            return width/2;\n        }).attr('height', (d, i, n)=> {\n           \n            let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10): 0;\n            let y = d3.scaleLinear().domain([0, d.max]).range([0, (height)])\n            return y(d.data.length);\n        }).attr('fill', (d, i) => {\n            return d.data[0] != undefined ? d.data[0].color : '#fff';\n        }).attr('opacity', 0.3);\n\n        discBars.attr('transform', (d, i, n)=> {\n            let movex = dimensions.observedWidth / n.length;\n            let offSet = movex / 2\n            let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10) : 0;\n            let y = d3.scaleLinear().domain([0, d.max]).range([0, (height-5)])\n            let movey = (height-2) - y(d.data.length);\n            let finalMove = d.index === 0 ? 'translate('+(movex * i)+', '+movey+')' : 'translate('+(offSet+(movex * i))+', '+movey+')';\n            return finalMove;\n        })\n\n        dRects.on('mouseover', (d, i, n)=> {\n            let state = d3.select('g.'+d[0].label).selectAll('g.state');\n            state.filter(f=> {\n                return f[0].state === d[0].winState}).attr('opacity', 0.8);\n            state.filter(f=> f[0].state != d[0].winState).attr('opacity', 0.1);\n            d3.select(n[i]).attr('opacity', 0.9);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).attr('opacity', 0.3);\n            let state = d3.select('g.'+d[0].label).selectAll('g.state').attr('opacity', 0.6);\n        });\n\n        discOb.each((d, i, nodes)=> {\n                \n                let xPoint = d3.scalePoint().domain(d.stateKeys).range([0, dimensions.observedWidth]).padding(.6)\n                let height = d.stateKeys ? (d.stateKeys.length * dimensions.squareDim - 10) : 0;\n                let y = d3.scaleLinear().domain([0, d.leafData.data.length]).range([(height), 0]);\n                d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(4))//.attr('transform', 'translate(0, '+height+')');\n                d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(xPoint)).attr('transform', 'translate(0, '+height+')');\n\n                d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n                d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n        });\n\n\n\n    }\n\n}\n\n/**\n * \n * @param {*} binnedWrap \n * @param {*} branchScale \n * @param {*} pointGroups \n */\n\nexport function renderDistibutions(binnedWrap, branchScale, pointGroups){\n\n    let predictedWrap = binnedWrap.append('g').classed('predicted', true);\n    predictedWrap.attr('transform', 'translate(25, 0)');\n    predictedWrap.filter(f=> f.type === 'discrete').append('g').classed('win-line', true);\n\n    //ROOT RENDERING\n    let root = predictedWrap.selectAll('g.root').data(d=> {\n        return [d.rootData]}).join('g').classed('root', true);\n    root.attr('transform', `translate(60,0)`);\n\n    let contRoot = root.filter(f=> f.type === \"continuous\");\n    contRoot.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 12)\n        .attr('fill', '#fff')\n        .style('stroke-width', '0.5px')\n        .style('stroke', 'black')\n\n    let rootRange = contRoot.append('rect')\n        .attr('width', 12)\n        .attr('height', d=> {\n            let newy = d.scales.yScale;\n            newy.range([(dimensions.height - 5), 0]);\n            return newy(d.values.lowerCI95) - newy(+d.values.upperCI95)\n        }).attr('transform', (d, i) => {\n            let newy = d.scales.yScale;\n            newy.range([(dimensions.height - 5), 0]);\n            return 'translate(0,'+newy(+d.values.upperCI95)+')'\n        }).style('opacity', 0.5).attr('fill', defaultBarColor);\n\n    let rootAv = contRoot.append('rect').attr('width', 12).attr('height', 3);\n    \n    rootAv.attr('transform', (d, i) => {\n            let newy = d.scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = +d.values.realVal;\n            return 'translate(0,'+newy(mean)+')';\n    }).attr('fill', '#004573');\n\n       // Discrete Root\n    let disRoot = root.filter(f=> f.type === \"discrete\");\n    let rootStateGroups = disRoot.selectAll('g.root-state-groups').data(d=> {\n        return d.bins}).join('g').classed('root-state-groups', true);\n\n    rootStateGroups.append('text')\n        .text((d, i)=> d.color.state)\n        .attr('y', 10)\n        .attr('x', -3)\n        .style('font-size', 10)\n        .style('text-anchor', 'end');\n\n    rootStateGroups.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n    rootStateGroups.append('rect')\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim)\n        .attr('fill', '#fff').attr('opacity', 1);\n\n    let rootRects = rootStateGroups.append('rect')\n        .classed('color-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim);\n\n    rootRects.attr('fill', (d, i)=> {\n            return `rgba(89, 91, 101, ${d.state[0].value})`;\n        }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n    let winStateRoot = disRoot.selectAll('g.root-state-groups')\n        .filter((f, j, n)=>{\n            let maxVal = d3.max(d3.selectAll(n).data().map(m=> m.state[0].value));\n            return f.color.state === d3.selectAll(n).data().filter(m=> m.state[0].value === maxVal)[0].color.state;\n        }).classed('win', true);\n\n    winStateRoot.select('rect.color-rect').attr('fill', (c, i)=> {\n            return c.color.color;\n        }).attr('opacity', (c)=>{\n            let sum = d3.sum(c.state.flatMap(s=> s.value));\n            return sum/c.state.length;\n        })\n\n\n    /////BRANCHES\n    let branchGroup = predictedWrap.selectAll('g.branch-bin').data(d=> {\n        return d.branches}).join('g').classed('branch-bin', true);\n\n    branchGroup.attr('transform', (d, i, n)=> {\n        let step = n.length < 11 ? (d.range[1] - d.range[0]) / 5 : 0\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.timeRange])\n            return 'translate('+(100 + (branchScale(i)) + x(step)) +', 0)'});\n\n    let discreteDist = branchGroup.filter(f=> f.type === 'discrete');\n\n    /////////EXPERIMENT////////\n    let stateBarsPredicted = discreteDist.selectAll('g.histo-bars')\n        .data(d=> {\n            let bins = d.bins.map(m=> {\n                m.index = d.index;\n                return m\n            });\n            return bins}).join('g')\n        .classed('histo-bars', true);\n  \n//stateBarsPredicted.attr('transform', (d, i)=> `translate(${dimensions.squareDim}, ${3.5+(i*(dimensions.squareDim+2))})`);\n    stateBarsPredicted.attr('transform', (d, i, n)=> {\n        return `translate(${dimensions.squareDim}, ${3.5+(i*(dimensions.squareDim+2))})`});\n\n    let bars = stateBarsPredicted.append('rect')\n              .attr('height', dimensions.squareDim)\n              .attr('width', (d, i, n)=> {\n                let dev = d3.deviation(d.state.map(m=> m.value));\n                let mean = d3.mean(d.state.map(m=> m.value));\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 40]);\n                return x(mean)\n              })\n              .attr('fill', d=> d.color.color)\n              .attr('opacity', 0.3)\n\n    // let devDotHigh = stateBarsPredicted.append('circle')\n    //           .attr('cy', dimensions.squareDim / 2)\n    //           .attr('cx', (d, i, n)=> {\n    //             let dev = d3.deviation(d.state.map(m=> m.value));\n    //             let mean = d3.mean(d.state.map(m=> m.value));\n    //             let x = d3.scaleLinear().domain([0, 1]).range([0, 40]);\n    //             return x(mean + dev)\n    //           })\n    //           .attr('r', 2)\n    //           .attr('fill', d=> d.color.color)\n    //           .attr('opacity', 1)\n\n    // let devDotLow = stateBarsPredicted.append('circle')\n    //           .attr('cy', dimensions.squareDim / 2)\n    //           .attr('cx', (d, i, n)=> {\n    //             let dev = d3.deviation(d.state.map(m=> m.value));\n                \n    //             let mean = d3.mean(d.state.map(m=> m.value));\n    //             let x = d3.scaleLinear().domain([0, 1]).range([0, 40]);\n    //             return x(mean - dev)\n    //           })\n    //           .attr('r', 2)\n    //           .attr('fill', d=> d.color.color)\n    //           .attr('opacity', 1)\n\n    /////////END XPERIMENT////////\n\n    let stateBinsPredicted = discreteDist.selectAll('g.state-bins')\n        .data(d=> d.bins).join('g')\n        .classed('state-bins', true);\n\n    stateBinsPredicted.attr('transform', (d, i)=> `translate(0, ${3.5+(i*(dimensions.squareDim+2))})`);\n\n    stateBinsPredicted.append('rect')\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim)\n        .attr('fill', '#fff').attr('opacity', 1);\n\n    let stateRects = stateBinsPredicted.append('rect')\n        .classed('state-rect', true)\n        .attr('height', dimensions.squareDim)\n        .attr('width', dimensions.squareDim);\n\n    stateRects.attr('fill', (d, i, n)=> {\n        let sum = d3.sum(d.state.map(m=> m.value))\n        let av = sum / d.state.length;\n        let scale = d3.scaleLinear().domain([0, 1]).range([0, 1]);\n        return `rgba(89, 91, 101, ${scale(av)})`;\n    }).attr('stroke-width', 0.5).attr('stroke', `rgba(200, 203, 219, .9)`);\n\n    stateRects.on('mouseover', (d, i, n)=> {\n        let sum = d3.sum(d.state.map(m=> m.value))\n        let av = sum / d.state.length;\n        let tool = d3.select('#tooltip');\n        tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n        \n        let f = d3.format(\".3f\");\n          \n        tool.html(`${d.state[0].state} : ${f(av)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        tool.style('height', 'auto');\n\n    }).on('mouseout', ()=>{\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    discreteDist.each((d, i, node)=>{\n        let maxBin = 0;\n        let maxState = null;\n        d.bins.map(m=> {\n            if(d3.sum(m.state.flatMap(s=> s.value)) > maxBin){\n                maxBin = d3.sum(m.state.flatMap(s=> s.value));\n                maxState = m.color.state;\n            }\n        });\n  \n        let winStates = d3.select(node[i]).selectAll('g.state-bins')\n            .filter((f, j, n)=>{\n                return f.color.state === maxState;\n            }).classed('win', true);\n\n        winStates.select('rect.state-rect').attr('fill', (c)=> {\n                return c.color.color;\n            }).attr('opacity', (c)=>{\n                let sum = d3.sum(c.state.flatMap(s=> s.value));\n                return sum/c.state.length;\n            })\n    });\n\n    let disWrap = predictedWrap.filter(f=> f.type === 'discrete')\n    let pathKeeper = []\n    disWrap.each((d, i, node)=> {\n        let winPosArray = [];\n        d3.select(node[i]).selectAll('.win').each((r, j, n)=>{\n            winPosArray.push([n[j].getBoundingClientRect().x,(n[j].getBoundingClientRect().y + 10)])\n            winPosArray.push([n[j].getBoundingClientRect().x + 15,(n[j].getBoundingClientRect().y + 10)])\n        });\n        pathKeeper.push([...winPosArray]);\n        let lineThing = d3.line();\n        winPosArray[winPosArray.length -1][1] = winPosArray[winPosArray.length -1][1] + 2;\n        winPosArray[winPosArray.length -2][1] = winPosArray[winPosArray.length -2][1] + 2;\n        d.win = winPosArray;\n    });\n\n    disWrap.each((e, i, n)=> {\n        let lineThing = d3.line();\n        d3.select(n[i]).select('.win-line').append('path').attr('d', (d)=> lineThing(d.win))\n        .attr('transform', 'translate(-75, -'+n[i].getBoundingClientRect().y+')')\n        .attr('fill', 'none')\n        .attr('stroke', `rgba(200, 203, 219, .9)`)\n        .attr('stoke-width', 1)\n    });\n\n    //CONTIN PREDICTED\n    let continDist = branchGroup.filter(f=> f.type === 'continuous');\n\n    continDist.on('mouseover', (d, i, node)=> {\n        let list = d.data.map(m=> m.node);\n        let selected = pointGroups.filter(p=> {\n            return list.indexOf(p.node) > -1}).classed('selected', true);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> list.indexOf(f.data.node) > -1).classed('selected-branch', true);\n        let y = d3.scaleLinear().domain(d.domain).range([0, dimensions.height])\n        let axis = d3.select(node[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n    }).on('mouseout', (d, i, node)=> {\n        d3.selectAll(\".branch-points.selected\").classed('selected', false);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        d3.select(node[i]).select('.y-axis').remove();\n    });\n\n    continDist.each((d, i, nodes)=> {\n        let distrib = d3.select(nodes[i])\n            .selectAll('g')\n            .data([d.bins])\n            .join('g')\n            .classed('distribution', true);\n\n        distrib.attr('transform', 'translate(11, '+dimensions.height+') rotate(-90)');\n        let path = distrib.append('path').attr('d', lineGen);\n        path.attr(\"fill\", defaultBarColor).attr('fill-opacity', .4)//.attr(\"fill\", \"rgba(133, 193, 233, .4)\")\n        .style('stroke', defaultBarColor);\n    });\n\n    let contRect = continDist.append('rect')\n        .attr('height', dimensions.height)\n        .attr('width', 10)\n        .style('fill', 'none')\n        .style('stroke', 'gray');\n\n    let rangeRect = continDist.selectAll('rect.range').data(d=> {\n        let newData = d.data.map(m=> {\n            m.range = d.range;\n            return m;\n        })\n        return newData}).join('rect').classed('range', true);\n\n    rangeRect.attr('width', 10);\n    rangeRect.attr('height', (d, i)=> {\n        if(d.scales.yScale != undefined){\n            let newy = d.scales.yScale;\n            newy.range([80, 0]);\n            return newy(d.values.lowerCI95) - newy(d.values.upperCI95)\n        }else{\n            return 0;\n        }\n    }).attr('transform', (d, i) => {\n        let newy = d.scales.yScale;\n        newy.range([80, 0]);\n        return 'translate(0,'+newy(d.values.upperCI95)+')'\n    });\n\n    //rangeRect.attr('fill', \"rgba(133, 193, 233, .05)\");\n    rangeRect.attr('fill', defaultBarColor).attr('opacity', 0.5)\n\n    let avRect = continDist.append('rect').attr('width', 10).attr('height', (d, i)=> {\n        if(d.data[0] != undefined){\n            return 3;\n        }else{\n            return 0;\n        }\n    });\n\n    avRect.attr('transform', (d, i) => {\n        if(d.data[0] != undefined){\n            let newy = d.data[0].scales.yScale;\n            newy.range([dimensions.height, 0]);\n            let mean = d3.mean(d.data.map(m=> +m.values.realVal));\n            return 'translate(0,'+newy(mean)+')';\n        }else{\n            return 'translate(0,0)';\n        }\n    }).attr('fill', '#004573');\n\n     //////START BRANCH EXPERIMENT\n     let brush = d3.brushY().extent([[0, 0], [20, dimensions.height]])\n     brush.on('end', brushed);\n\n     continDist.append(\"g\")\n     .classed('continuous-branch-brush', true)\n     .attr(\"class\", \"brush\")\n     .call(brush);\n \n     function brushed(){\n\n        let data = d3.select(this.parentNode).data()[0]\n        var s = d3.event.selection;\n        var zero = d3.format(\".3n\");\n\n       \n    \n        let index = d3.select('#toolbar').selectAll('.brush-span').size();\n        let classLabel = index === 0 ? 'one' : 'two';\n    \n        if(s != null){\n            let treeTest = d3.select('#sidebar').selectAll('.node').filter(f=> {\n                return f.data.leaf === true});\n    \n            if(treeTest.empty()){\n                renderTree(d3.select('#sidebar'), null, true);\n            }\n\n            let y = d3.scaleLinear().domain([data.domain[0], data.domain[1]]).range([0, dimensions.height])\n           \n            let attribute = data.key;\n            let brushedVal = [y.invert(s[1]), y.invert(s[0])];\n    \n            let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n            let nodes = data.data.filter(f=> {\n                return (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1]);\n            });\n           \n            let test = continuousHistogram(nodes);\n\n           \n            test.maxCount = d3.sum(data.bins.map(m=> m.length));\n\n            //////EXPERIMENTING WITH BRUSH DRAW DISTRIBUTIONS////\n            let brushedDist = d3.select(this.parentNode)\n            .selectAll('g.distribution-too')\n            .data([test])\n            .join('g')\n            .classed('distribution-too', true);\n\n            brushedDist.attr('transform', 'translate(0, 0) rotate(90)');\n            let path = brushedDist.append('path').attr('d', mirrorlineGen);\n            path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n            .style('stroke', brushColors[index][0]);\n\n            let nodeNames = nodes.map(m=> m.node);\n\n            let otherBins = continDist.filter(f=> f.index === data.index && f.key != data.key);\n            otherBins.each((b, i, n)=> {\n                \n                let test = continuousHistogram(b.data.filter(f=> nodeNames.indexOf(f.node) > -1) );\n               \n                test.maxCount = d3.sum(b.bins.map(m=> m.length));\n              \n                let otherDist = d3.select(n[i]).selectAll('g.distribution-too')\n                .data([test])\n                .join('g')\n                .classed('distribution-too', true);\n\n                otherDist.attr('transform', 'translate(0, 0) rotate(90)');\n                let path = otherDist.append('path').attr('d', mirrorlineGen);\n                path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n                .style('stroke', brushColors[index][0]);\n    \n            });\n\n            let descendBins = continDist.filter(f=> {\n                return (f.index > data.index) && (f.key === data.key)});\n\n            descendBins.each((b, i, n)=> {\n\n                let test = b.data.filter(f=> {\n                    return (f.values.realVal > brushedVal[0]) && (f.values.realVal < brushedVal[1]);\n                    });\n\n                 let testH = continuousHistogram(test);\n               \n                 testH.maxCount = d3.sum(b.bins.map(m=> m.length));\n              \n                let otherDist = d3.select(n[i]).selectAll('g.distribution-too')\n                .data([testH])\n                .join('g')\n                .classed('distribution-too', true);\n\n                otherDist.attr('transform', 'translate(0, 0) rotate(90)');\n                let path = otherDist.append('path').attr('d', mirrorlineGen);\n                path.attr(\"fill\", brushColors[index][0]).attr('fill-opacity', 0.5)\n                .style('stroke', brushColors[index][0]);\n\n            })\n          \n            ////END DISTRIBUTION///\n           \n            let notNodes = data.data.filter(f=> {\n                return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n            });\n\n            let selectedNodes = brushedNodes(nodes, notNodes, data, brushedVal, classLabel);\n            let selectedBranch = selectedNodes[0];\n            let secondGrp = selectedNodes[1];\n            let antiSelected = selectedNodes[2];\n            let antiSecond = selectedNodes[3];\n    \n            if(index < 2){\n    \n                let doesItExist = d3.select('#toolbar').selectAll('.brush-span').filter((f, i, n)=> {\n                    return d3.select(n[i]).attr('value') == `${data.bins.groupLabel}-${data.key}`;\n                });\n    \n                if(doesItExist.size() === 0){\n    \n                    d3.select(this).select('.selection')\n                    .style('fill', `${brushColors[index][0]}`)\n                    .attr('stroke', `${brushColors[index][0]}`)\n                    .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                    .attr('stroke', brushColors[index][1])\n                    .attr('stroke-width', 2);\n    \n                    let badge = d3.select('#toolbar')\n                        .append('span')\n                        .attr('class', classLabel)\n                        .attr('id', classLabel)\n                        .classed('brush-span', true)\n                        .classed(`${data.bins.groupLabel}`, true)\n                        .classed('badge badge-secondary', true)\n                        .style('background', brushColors[index][0])\n                        .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                        .datum({brush:this, nodes: nodes})\n                        .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n    \n                    let xOut = badge.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                       \n                        let classy = index === 0 ? 'one' : 'two';\n                        \n                        d3.select(d.brush).call(brush.move, null);\n                        d3.select(n[i].parentNode).remove();\n                        d3.select(d.brush).select('.overlay').attr('stroke-width', 0);\n                        descendBins.selectAll('.distribution-too').remove();\n                        otherBins.selectAll('.distribution-too').remove();\n                        d3.select(d.brush.parentNode).select('.distribution-too').remove();\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed-second', false);\n                        d3.select('#sidebar').selectAll(`.${classy}`).classed('anti-brushed', false);\n                    });\n    \n                }else{\n    \n                    doesItExist.text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                    let xOut = doesItExist.append('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    \n                    xOut.on('click', (d, i, n)=> {\n                        d3.select(d).call(brush.move, null);\n                        d3.select(d).select('.overlay').attr('stroke-width', 0);\n                        d3.select(n[i].parentNode).remove();\n                    });\n                   \n                    d3.select(doesItExist.datum().brush).call(brush.move, null);\n                    d3.select(doesItExist.datum().brush).select('.overlay').attr('stroke-width', 0)\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll(`${data.bins.groupLabel}`)\n                        .selectAll('.second-branch')\n                        .classed('second-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.selected-branch')\n                        .classed('selected-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-second')\n                        .classed('anti-brushed-second', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                        treeNode.selectAll(`.${data.key}`)\n                        .selectAll('.anti-brushed-branch')\n                        .classed('anti-brushed-branch', false)\n                        .classed('one', false)\n                        .classed('two', false)\n                        .classed(`${data.key}`, false);\n    \n                    let label = doesItExist.attr('id');\n    \n                    index = label === 'one' ? 0 : 1;\n    \n                    d3.select(this).select('.selection')\n                        .style('fill', `${brushColors[index][0]}`)\n                        .attr('stroke', `${brushColors[index][0]}`)\n                        .attr('stroke-width', 2);\n    \n                    d3.select(this).select('.overlay')\n                        .attr('stroke', brushColors[index][1])\n                        .attr('stroke-width', 2);\n\n                       \n                    let nodes = data.data.filter(f=> {\n                        return (f.values.realVal >= brushedVal[0]) && (f.values.realVal <= brushedVal[1]);\n                    });\n\n                    let notNodes = data.data.filter(f=> {\n                        return (f.values.realVal < brushedVal[0]) || (f.values.realVal > brushedVal[1]);\n                    });\n\n                    doesItExist.datum({brush:this, nodes: nodes})\n                    brushedNodes(nodes, notNodes, data, brushedVal, label);\n                    \n                }\n    \n            }else{\n    \n                d3.select('#toolbar').selectAll('.brush-span').filter((f, i)=> i === 0).remove();\n    \n                let classLabel = colorBool === 0 ? 'one': 'two';\n    \n                d3.select('#toolbar')\n                    .append('span')\n                    .attr('class', )\n                    .classed('brush-span', true)\n                    .classed('badge badge-secondary', true)\n                    .style('background', brushColors[colorBool][0])\n                    .attr('value', `${data.bins.groupLabel}-${data.key}`)\n                    .text(`${data.bins.groupLabel}, ${data.key}: ${zero(brushedVal[0])} - ${zero(brushedVal[1])}`);\n                colorBool === 0 ? colorBool = 1 : colorBool = 0;\n                secondGrp.classed(classLabel, true);\n                selectedBranch.classed(classLabel, true);\n            }\n    \n        }else{\n            d3.selectAll(`.${data.key}.brushed-branch`).classed('brushed-branch', false);\n            d3.selectAll(`.${data.key}.brushed-second`).classed('brushed-second', false);\n        }\n     }\n\n     ///OBSERVED/////\n     let observedWrap = binnedWrap.append('g').classed('observed', true);\n     observedWrap.attr('transform', (d, i, n)=> {\n         return 'translate('+ (dimensions.predictedWidth + 150) +', 0)'});\n\n    ////OBSERVED CONTIUOUS/////\n    let contOb = observedWrap.filter(f=> f.type === 'continuous');\n    contOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, -15)`);\n\n    let contBars = contOb.selectAll('g.ob-bars').data(d=> {\n        return d.leafData.bins}).join('g').classed('ob-bars', true);\n\n    let cRects = contBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i)=> {\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(dimensions.height - dimensions.margin), 0])\n        return y(Object.keys(d).length - 2)\n    })\n    .attr('fill', defaultBarColor).attr('fill-opacity', .5);\n\n    contBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let y = d3.scaleLinear()\n            .domain([0, Object.keys(d).length])\n            .range([(dimensions.height - dimensions.margin), 0]);\n\n        let movey = dimensions.height - y(Object.keys(d).length - 2);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    contOb.each((d, i, nodes)=> {\n\n        let xvalues = d.leafData.data.map(m=> {\n            return +m.values.realVal});\n        let x = d3.scaleLinear()\n            .domain([d3.min(xvalues), d3.max(xvalues)])\n            .range([0, dimensions.observedWidth]);\n\n        let y = d3.scaleLinear()\n            .domain([0, d3.max(d.leafData.bins.map(b=> Object.keys(b).length)) - 2])\n            .range([(dimensions.height - dimensions.margin), 0]);\n        \n        d3.select(nodes[i])\n            .append('g')\n            .classed('x-axis', true)\n            .call(d3.axisBottom(x))\n            .attr('transform', 'translate(0, '+dimensions.height+')')\n\n        d3.select(nodes[i]).append('g')\n            .classed('y-axis', true)\n            .call(d3.axisLeft(y).ticks(4))\n            .attr('transform', 'translate(0, '+dimensions.margin+')');\n\n            d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n            d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n\n            d3.select(nodes[i])\n            .append('g')\n            .classed('x-axis-label', true)\n            .append('text').text('Frequency')\n            .attr('transform', `translate(-20, ${dimensions.height- 10}) rotate(-90)`)\n            .style('font-size', '10px');\n    });\n    \n    ////Observed Discrete////\n    let discOb =  observedWrap.filter(f=> f.type === 'discrete');\n\n    discOb.attr('transform', `translate(${dimensions.predictedWidth + 160}, 5)`)\n    let discBars = discOb.selectAll('g.ob-bars').data(d=> {\n        return d.stateKeys.map((key, i)=>{\n            return {state: key, data: d.leafData.bins[i], max: d3.sum(d.leafData.bins.map(b=> b.length))}\n        });\n    }).join('g').classed('ob-bars', true);\n    let dRects = discBars.append('rect').attr('width', (d, i, n)=> {\n        let width = dimensions.observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i, n)=> {\n        let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10): 0;\n        let y = d3.scaleLinear().domain([0, d.max]).range([0, (height)])\n        return y(d.data.length);\n    }).attr('fill', (d, i) => {\n        return d.data[0] != undefined ? d.data[0].color : '#fff';\n    }).attr('opacity', 0.3);\n\n    discBars.attr('transform', (d, i, n)=> {\n        let movex = dimensions.observedWidth / n.length;\n        let height = d.data[0] ? (d.data[0].scales.stateColors.length * dimensions.squareDim - 10) : 0;\n        let y = d3.scaleLinear().domain([0, d.max]).range([0, (height-5)])\n        let movey = (height-5) - y(d.data.length);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    dRects.on('mouseover', (d, i, n)=> {\n        let state = d3.select('g.'+d[0].label).selectAll('g.state');\n        state.filter(f=> {\n            return f[0].state === d[0].winState}).attr('opacity', 0.8);\n        state.filter(f=> f[0].state != d[0].winState).attr('opacity', 0.1);\n        d3.select(n[i]).attr('opacity', 0.9);\n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).attr('opacity', 0.3);\n        let state = d3.select('g.'+d[0].label).selectAll('g.state').attr('opacity', 0.6);\n    });\n\n    discOb.each((d, i, nodes)=> {\n           \n            let xPoint = d3.scalePoint().domain(d.stateKeys).range([0, dimensions.observedWidth]).padding(.6)\n            let height = d.stateKeys ? (d.stateKeys.length * dimensions.squareDim - 10) : 0;\n            let y = d3.scaleLinear().domain([0, d.leafData.data.length]).range([(height), 0]);\n            d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(4))//.attr('transform', 'translate(0, '+height+')');\n            d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(xPoint)).attr('transform', 'translate(0, '+height+')');\n\n            d3.select(nodes[i]).select('.x-axis').selectAll('text').style('font-size', '8px');\n            d3.select(nodes[i]).select('.y-axis').selectAll('text').style('font-size', '8px');\n    });\n\n}\n\nfunction brushedNodes(nodes, notNodes, data, brushedVal, classLabel){\n   \n    let nodeNames = nodes.map(m=> m.node);\n    let notNodeNames = notNodes.map(m=> m.node);\n\n    let timeNodes = d3.extent(nodes.map(m=> m.combLength));\n    let treeNode = d3.select('#sidebar').selectAll('.node');\n\n    let selectedBranch = treeNode.filter(f=> {\n        return nodeNames.indexOf(f.data.node) > -1;\n    }).classed('brushed-branch', true);\n\n    let notNodeSelectedBranch = treeNode.filter(f=> notNodeNames.indexOf(f.data.node) > -1).classed('anti-brushed', true);\n\n    let test = pullPath([], selectedBranch.data(), [], [], 0);\n    let notTest = pullPath([], notNodeSelectedBranch.data(), [], [], 0);\n\n    let testtest = test.flatMap(t=> t).filter(f=>{\n        return f.data.attributes[data.key].values.realVal >= brushedVal[0] && f.data.attributes[data.key].values.realVal <= brushedVal[1];\n    }).map(m=> m.data.node);\n\n    let notTestTest = notTest.flatMap(t=> t).filter(f=>{\n        return f.data.attributes[data.key].values.realVal < brushedVal[0] || f.data.attributes[data.key].values.realVal > brushedVal[1];\n    }).map(m=> m.data.node);\n    \n    let secondGrp = treeNode.filter(f=> (nodeNames.indexOf(f.data.node) === -1)&&(testtest.indexOf(f.data.node) > -1))\n        .classed('brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n    let secondLinks = d3.select('#sidebar').selectAll('.link')\n        .filter(f=> (nodeNames.indexOf(f.data.node) === -1)&&(testtest.indexOf(f.data.node) > -1))\n        .classed('brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n    \n    selectedBranch.classed(`${data.key}`, true).classed(classLabel, true).classed('brushed-branch', true);\n   \n    let notNodeSecondGrp = treeNode\n        .filter(f=> (notNodeNames.indexOf(f.data.node) === -1 )&& (notTestTest.indexOf(f.data.node) > -1))\n        .classed('anti-brushed-second', true)\n        .classed(`${data.key}`, true)\n        .classed(classLabel, true);\n\n    let secondAntiLinks = d3.select('#sidebar').selectAll('.link')\n            .filter((f, j)=> (notNodeNames.indexOf(f.data.node) === -1)&&(notTestTest.indexOf(f.data.node) > -1));\n    secondAntiLinks.classed('anti-brushed-second', true).classed(`${data.key}`, true).classed(classLabel, true);\n    notNodeSelectedBranch.classed('anti-brushed', true).classed(classLabel, true).classed(classLabel, true);\n\n    return [selectedBranch, secondGrp, notNodeSelectedBranch, notNodeSecondGrp];\n}\n\nfunction continuousHistogram(data){\n    \n    let x = data[0].yScale;\n    let histogram = d3.histogram()\n            .value(function(d) { return d.values.realVal; })  \n            .domain(x.domain())  \n            .thresholds(x.ticks(20)); \n\n    return histogram(data);\n}\n\nlet mirrorlineGen = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i, n)=> {\n      \n        let y = d3.scaleLinear().domain([n.length - 1, 0]).range([0, dimensions.height]).clamp(true);\n        \n        return y(i); \n    })\n    .y0(d=> {\n        return 0;\n    })\n    .y1((d, i, n)=> {\n        let max = n.maxCount ? n.maxCount : d.maxCount;\n        let dat = d.length;\n        let count = n.count? n.count : 8;\n        let x = d3.scaleLinear().domain([0, max]).range([0, ((dimensions.predictedWidth/count)*.5)]).clamp(true);\n        \n        return x(dat); \n});\n\nvar lineGen = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i, n)=> {\n        let y = d3.scaleLinear().domain([0, n.length - 1]).range([0, dimensions.height]).clamp(true);\n        return y(i); \n    })\n    .y0(d=> {\n        return 0;\n    })\n    .y1((d, i, n)=> {\n        let max = d.maxCount? d.maxCount : d3.sum(n.map(m=> m.length))\n        let dat = d.length;\n        let count = n.count? n.count : 8;\n        let x = d3.scaleLinear().domain([0, max]).range([0, ((dimensions.predictedWidth/count)*.5)]).clamp(true);\n        return x(dat); \n    });\n\n\n","import { pairPaths, maxTimeKeeper } from \"./dataFormat\";\nimport { dropDown } from \"./buttonComponents\";\nimport * as d3 from \"d3\";\nimport * as slide from 'd3-simple-slider';\nimport { renderTree } from \"./sidebarComponent\";\nimport { speciesTest, dataMaster } from \".\";\nimport { findBrushedNodes } from \"./toolbarComponent\";\n\nexport function rankingControl(data){\n    let rankDiv = d3.select('#pair-rank').classed('hidden', false);\n    rankDiv.selectAll('*').remove();\n\n    let defaultW = [1, 1, 1];\n  \n    let weightPicker = rankDiv\n      .append('svg')\n      .attr('width', 800)\n      .attr('height', 100)\n      .append('g')\n      .attr('transform', 'translate(10,10)');\n\n     weightPicker\n    .append(\"svg:image\")\n    .attr('width', 200)\n    .attr('height', 140)\n    .attr('y', -50)\n    .attr(\"xlink:href\", \"./public/mini-diagram.gif\");\n\n    weightPicker.append('text').text('Distance').attr('font-size', 10).attr('x', 85).attr('y', 60);\n    weightPicker.append('text').text('Delta').attr('font-size', 10).attr('x', 66).attr('y', 20);\n    weightPicker.append('text').text('Closeness').attr('font-size', 10).attr('x', 195).attr('y', 22);\n\n    let labels = ['Distance', 'Delta', 'Closeness'];\n\n    weightPicker.selectAll('text.labels').data(labels).join('text').classed('labels', true)\n    .text(d=> d)\n    .attr('y', 10)\n    .attr('x', (d, i)=> (300+(260 * i)));\n\n  \n    defaultW.forEach((color, i) => {\n      var slider = slide\n        .sliderBottom()\n        .min(-1)\n        .max(1)\n        .step(.1)\n        .width(210)\n        .default(defaultW[i])\n        .displayValue(false)\n        .fill('#7FB3D5')\n        .on('end', num => {\n         defaultW[i] = num;\n       \n         updateRanking(pairPaths(data), d3.select('.attr-drop.dropdown').select('button').attr('value'), defaultW);\n        });\n  \n      weightPicker\n        .append('g')\n        .attr('transform', `translate(${300+(260 * i)}, 20)`)\n        .call(slider);\n\n      weightPicker.selectAll('.tick')\n      .filter(f=> f < 0).select('text')\n      .attr('fill', 'red')\n      .attr('opacity', 0.6);\n    });\n}\nexport function generatePairs(data){\n\n        let pairs = pairPaths(data);\n     \n        let weights = [1, 1, 1];\n\n        let attKeys = d3.entries(pairs[0].p1[0].attributes)\n                    .filter(f=> f.value.type === 'continuous')\n                    .map(m=> {\n                        return {'field': m.key, 'value': m.key }\n                    });\n        \n        let drop = d3.select('.attr-drop.dropdown')\n          .selectAll('a').empty() ? dropDown(d3.select('#toolbar'), attKeys, `Trait: ${attKeys[0].field}`, 'attr-drop') : d3.select('.attr-drop.dropdown').selectAll('a');\n        \n        d3.select('.attr-drop.dropdown').select('button').attr('value', attKeys[0].field);\n\n        drop.on('click', (d, i, n)=> {\n            updateRanking(pairPaths(data), d.field, weights);\n            renderTree(d3.select('#sidebar'), null, true, d.field);\n            d3.select('.attr-drop.dropdown').select('button').attr('value', d.field);\n            d3.select('.attr-drop.dropdown').select('button').text(`Trait: ${d.field}`);\n            d3.select('#attr-drop').classed('show', false);\n        });\n\n        updateRanking([...pairs], attKeys[0].field, weights);\n}\nexport function updateRanking(pairs, field, weights){\n\n  console.log('pairs',pairs, field)\n  \n    let deltaMax = d3.max([...pairs].map(m=> m.deltas.filter(f=> f.key === field)[0]).map(m=> m.value));\n    let closeMax = d3.max([...pairs].map(m=> m.closeness.filter(f=> f.key === field)[0]).map(m=> m.value));\n    let distMax = d3.max([...pairs].map(d=> d.distance))\n    let deltaScale = d3.scaleLinear().domain([0, deltaMax]).range([0, 1]);\n    let closeScale = d3.scaleLinear().domain([closeMax, 0]).range([0, 1]);\n    let distScale = d3.scaleLinear().domain([0, distMax]).range([0, 1]);\n\n    let pickedPairs = [...pairs].map(p=> {\n        p.delta = p.deltas.filter(d=> d.key === field)[0];\n        p.closeness = p.closeness.filter(d=> d.key === field)[0];\n        p.deltaRank = deltaScale(p.delta.value);\n        p.closenessRank = closeScale(p.closeness.value);\n        p.distanceRank = distScale(p.distance);\n        p.totalRank = (weights[0] * p.distanceRank) + (weights[1] * p.deltaRank) + (weights[2] * p.closenessRank);\n        return p;\n    })\n\n    let sortedPairs = pickedPairs.sort((a, b)=> b.totalRank - a.totalRank).slice(0, 40);\n    sortedPairs = sortedPairs.filter((f, i)=> i%2 === 0)\n    drawSorted(sortedPairs, field);\n}\n\nfunction drawSorted(pairs, field){\n\n  let pairColor = ['#FF5733', '#129BF5'];\n\n  let nodes = findBrushedNodes();\n  //console.log('nodes from brush',nodes.map(m=> m.species))\n   \n    let width = 600;\n    let height = 100;\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, width]);\n\n    d3.select('#main').selectAll('*').remove()\n    let svg = d3.select('#main').append('svg');\n    svg.attr('height', pairs.length * 150)\n    let wrap = svg.append('g');\n    wrap.attr('transform', 'translate(20, 100)')\n    let pairWraps = wrap.selectAll('g.pair-wrap').data(pairs).join('g').classed('pair-wrap', true);\n    pairWraps.attr('transform', (d, i)=> `translate(50,${i*150})`);\n    pairWraps.append('rect')\n        .attr('width', (d, i)=> {\n            return width - xScale(d.common.combLength);\n        })\n        .attr('height', height)\n        .attr('x', d=> xScale(d.common.combLength))\n        .attr('stroke-width', 1).attr('stroke', 'black')\n        .attr('fill', '#fff');\n\n    pairWraps.append('text').text((d, i)=> {\n        return `${d.p1[d.p1.length - 1].node} + ${d.p2[d.p2.length - 1].node}`\n    }).attr('y', -10);\n\n    let scoreWrap = pairWraps.append('g').classed('score-wrap', true);\n    let scoreGroups = scoreWrap.selectAll('g.score').data((d, i)=> {\n        return [\n         {label: 'Distance', value: d.distance, score: d.distanceRank}, \n         {label: 'Delta', value: d.delta.value, score: d.deltaRank},\n         {label: 'Closeness', value: d.closeness.value, score: d.closenessRank}\n        ];\n    }).join('g').classed('score', true);\n\n    let scoreLabel = scoreWrap.append('g').attr('transform', `translate(650, 10)`);\n    scoreLabel.append('rect').attr('width', 200).attr('height', 40).attr('fill', 'gray').attr('y', 45).attr('opacity', .1)\n    scoreLabel.append('text').text('Score').attr('y', 20).style('text-anchor', 'end').style('font-size', 11);\n    scoreLabel.append('text').text('Value').attr('y', 40).style('text-anchor', 'end').style('font-size', 11);\n\n    scoreLabel.append('text').text('Total Score').attr('y', 60).attr('x', 95).style('text-anchor', 'end').style('font-size', 11);\n    scoreLabel.append('text').text('Rank').attr('y', 80).attr('x', 95).style('text-anchor', 'end').style('font-size', 11);\n\n    scoreGroups.attr('transform', (d, i, n)=> {\n       return  i === 0 ? `translate(${(670)},0)` : \n       `translate(${(660+(d3.sum(d3.selectAll(n).filter((f, j)=> i > j).data().map(m=> m.label.length * 6)))+ (i*30))},0)`;\n    });\n    var zero = d3.format(\".3n\");\n    scoreGroups.append('text').text((d, i)=>  d.label).style('font-size', 10).attr('y', 10);;\n    scoreGroups.append('text').text((d, i)=> zero(d.score)).style('font-size', 10).attr('y', 30);\n    scoreGroups.append('text').text((d, i)=> zero(d.value)).style('font-size', 10).attr('y', 50);\n\n    scoreLabel.append('text').text((d, i, n)=> zero(d.closenessRank + d.distanceRank + d.deltaRank)).style('font-size', 10).attr('y', 60).attr('x', 115);\n    scoreLabel.append('text').text((d, i)=> i+1).style('font-size', 10).attr('y', 80).attr('x', 115);\n\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, width]);\n       let distance = x(d.combLength);\n        return distance; })\n    .y(d=> {\n        let y = d.attributes[field].scales.yScale;\n        y.range([height, 0]);\n        return y(d.attributes[field].values.realVal);\n    });\n\n    //BEGIN EXPERIOMENTING////]\n\n    let pairGroupN = pairWraps.selectAll('g.pair-neighbor').data((d, i, n)=> {\n      let species1 = d.p1.map(n=> n.node);\n      let species2 = d.p2.map(n=> n.node);\n      let labels = [...d.p1.filter(n=> n.leaf === true).map(m=> m.node)].concat(d.p2.filter(n=> n.leaf === true).map(m=> m.node));\n\n\n      let neighbors = labels.flatMap(m=> {\n          let start = speciesTest[0].indexOf(m);\n          let ne = speciesTest[0].filter((f, j)=> (j < (+start + 2)) && (j > (+start - 2)));\n          return ne;\n      });\n      \n      let speciesNames = [species1[species1.length-1], species2[species2.length-1]];\n\n      ////EXPERIMENTING WITH NODES////\n      let neighPaths = dataMaster[0].filter(f=> \n        (neighbors.indexOf(f[f.length - 1].node)) > -1 && (speciesNames.indexOf(f[f.length - 1].node) === -1));\n  \n      let labeledN = [...neighPaths].map(path=> {\n        let name = path[path.length - 1].node;\n        return path.map(p=> {\n          p.name = name;\n          return p\n        })\n      });\n  \n      let spec1N = labeledN.map(m => m.filter(f=> species1.indexOf(f.node) > -1));\n      let spec2N = labeledN.map(m => m.filter(f=> species2.indexOf(f.node) > -1));\n  \n      let closest1 = spec1N.filter((f, i, n)=> {\n        let max = d3.max(n.map(d=> d.length));\n        return f.length === max;\n      })[0];\n  \n      let closest2 = spec2N.filter((f, i, n)=> {\n        let max = d3.max(n.map(d=> d.length));\n        return f.length === max;\n      })[0];\n  \n      let wholeClosest1 = labeledN.filter(f=> f[f.length-1].node === closest1[closest1.length - 1].name)[0];\n      let wholeClosest2 = labeledN.filter(f=> f[f.length-1].node === closest2[closest2.length - 1].name)[0];\n     \n      return [wholeClosest1, wholeClosest2];\n\n    }).join('g').classed('pair-neighbor', true).attr('opacity', 0);\n\n      let innerPathsN = pairGroupN.append('path')\n      .attr(\"d\", lineGen)\n      .attr(\"class\", \"inner-line-n\")\n      .attr('fill', 'none')\n      .attr('stroke-width', 1)\n      .style('stroke', 'rgba(160, 141, 184, .9)');\n     \n      let branchesN = pairGroupN.selectAll('g.branch-n').data(d=> d).join('g').classed('branch-n', true);\n      branchesN.attr('transform', (d, i)=> `translate(${xScale(d.combLength)}, 0)`);\n      branchesN.filter(f=> f.leaf != true).append('rect').attr('width', 10).attr('height', (d)=> {\n          let y = d.attributes[field].scales.yScale;\n          return y(d.attributes[field].values.lowerCI95) - y(d.attributes[field].values.upperCI95)\n      }).attr('fill', 'rgba(160, 141, 184, .2)').attr('y', (d, i)=> {\n          let y = d.attributes[field].scales.yScale;\n          return y(d.attributes[field].values.upperCI95);\n      });\n  \n      branchesN.append('rect').attr('width', 10).attr('height', 4).attr('y', (d, i)=> {\n          return d.attributes[field].scales.yScale(d.attributes[field].values.realVal) - 2;\n      }).attr('opacity', 0.5);\n\n      branchesN.filter((b, i, n)=> {\n        return i === (n.length - 1);\n      }).append('text').text(d=> d.node)\n        .attr('fill', 'rgba(160, 141, 184, 1)')\n        .attr('y', (d, i)=> {\n        let y = d.attributes[field].scales.yScale;\n        return (y(d.attributes[field].values.realVal) - 4);\n        }).attr('x', 3).style('font-size', 10);\n\n\n\n\n////////////////////////////END EXPERIMENT///////\n\n    let pairGroup = pairWraps.selectAll('g.pair').data(d=> [d.p1, d.p2]).join('g').classed('pair', true);\n\n    let innerPaths = pairGroup.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", \"inner-line\")\n    .style('stroke', (d, i)=> pairColor[i])\n   // .style('stroke', 'rgb(165, 185, 198)');\n\n   let brushedPaths = innerPaths.filter(f=> {\n    let nodeTest = f.filter(n=> nodes.map(m=> m.node).indexOf(n.node) > -1)\n    return nodeTest.length > 0}).style('stroke', '#64B5F6').style('stroke-width', '5px');\n\n   //console.log('brushed',brushedPaths, nodes.map(m=> m.node))\n    let branches = pairGroup.selectAll('g.branch').data(d=> d).join('g').classed('branch', true);\n    branches.attr('transform', (d, i)=> `translate(${xScale(d.combLength)}, 0)`);\n    branches.filter(f=> f.leaf != true).append('rect')\n    .classed('range', true)\n    .attr('width', 10)\n    .attr('height', (d)=> {\n        let y = d.attributes[field].scales.yScale;\n        return y(d.attributes[field].values.lowerCI95) - y(d.attributes[field].values.upperCI95)\n    }).attr('fill', 'rgba(165, 185, 198, .5)')\n    .attr('y', (d, i)=> {\n        let y = d.attributes[field].scales.yScale;\n        return y(d.attributes[field].values.upperCI95);\n    });\n\n    let chosenNodes = branches.filter(f=> {\n      return nodes.map(m=> m.node).indexOf(f.node) > -1\n    }).selectAll('rect.range').attr('fill', '#64B5F6')\n\n    branches.append('rect').attr('width', 10).attr('height', 4).attr('y', (d, i)=> {\n        return d.attributes[field].scales.yScale(d.attributes[field].values.realVal) - 2;\n    });\n\n    pairWraps.append('rect').attr('width', (d, i)=> {\n        return xScale(d.common.combLength)})\n        .attr('height', height)\n        .attr('fill', '#fff').style('opacity', 0.7);\n        let yAxisG = pairWraps.append('g').classed('y-axis', true);\n        let xAxisG = pairWraps.append('g').classed('x-axis', true);\n        xAxisG.call(d3.axisBottom(xScale).ticks(10));\n        xAxisG.attr('transform', `translate(0, ${height})`)\n\n    pairWraps.on('mouseover', (d, i, n)=> {\n       \n        let species1 = d.p1.map(n=> n.node);\n        let species2 = d.p2.map(n=> n.node);\n        let labels = [...d.p1.filter(n=> n.leaf === true).map(m=> m.node)].concat(d.p2.filter(n=> n.leaf === true).map(m=> m.node));\n        let neighbors = labels.flatMap(m=> {\n            let start = speciesTest[0].indexOf(m);\n            let ne = speciesTest[0].filter((f, j)=> (j < (+start + 2)) && (j > (+start - 2)));\n            return ne;\n        });\n        \n        let neighNodes = []//dataMaster[0].filter(f=> neighbors.indexOf(f[f.length -1].node) > -1).flatMap(m=> m.map(f=> f.node))\n       \n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let treeLinks  = d3.select('#sidebar').selectAll('.link');\n        let pairNode1 = treeNode.filter(f=> {\n            return species1.indexOf(f.data.node) > -1;\n        }).classed('hover one', true);\n\n        let pairNode2 = treeNode.filter(f=> {\n          return species2.indexOf(f.data.node) > -1;\n      }).classed('hover two', true);\n\n        treeLinks.filter(f=> species1.indexOf(f.data.node) > -1).classed('hover one', true);\n        treeLinks.filter(f=> species2.indexOf(f.data.node) > -1).classed('hover two', true);\n       // treeNode.filter(f=> neighNodes.indexOf(f.data.node) > -1).classed('hover-neighbor', true);\n        //Hiding Others\n        treeNode.filter(f=> (neighNodes.indexOf(f.data.node) === -1) && (species1.concat(species2).indexOf(f.data.node) === -1)).classed('hover-not', true);\n        //Coloring Neighbors\n       // treeLinks.filter(f=> neighNodes.indexOf(f.data.node) > -1).classed('hover-neighbor', true);\n        //Hiding Others\n        treeLinks.filter(f=> (neighNodes.indexOf(f.data.node) === -1) && (species1.concat(species2).indexOf(f.data.node) === -1)).classed('hover-not', true);\n        \n        let speciesNames = [species1[species1.length-1], species2[species2.length-1]]\n       // d3.select(n[i]).selectAll('.pair-neighbor').attr('opacity', 1);\n        return d3.select(this).classed('hover', true);\n    })\n    .on('mouseleave', (d, i, n)=>{\n\n      d3.select(n[i]).selectAll('.pair-neighbor').attr('opacity', 0);\n\n        let treeNode  = d3.select('#sidebar').selectAll('.node')\n        .classed('hover', false)\n        .classed('hover-neighbor', false)\n        .classed('hover-not', false)\n        .classed('two', false)\n        .classed('one', false);\n        let treeLinks  = d3.select('#sidebar').selectAll('.link')\n        .classed('hover', false)\n        .classed('hover-neighbor', false)\n        .classed('hover-not', false)\n        .classed('two', false)\n        .classed('one', false);\n        return d3.select(n[i]).classed('hover', false);\n    });\n\n    let axisGroup = pairWraps.append('g').classed('y-axis', true);\n  \n    axisGroup.each((d, i, n)=> {\n        let scale = d.p1[0].attributes[field].scales.yScale;\n        d3.select(n[i]).call(d3.axisLeft(scale).ticks(5));\n    });\n\n    let mouseG = pairWraps.append(\"g\")\n    .attr(\"class\", \"mouse-over-effects\");\n\n  mouseG.append(\"path\") // this is the black vertical line to follow mouse\n    .attr(\"class\", \"mouse-line\")\n    .style(\"stroke\", \"black\")\n    .style(\"stroke-width\", \"1px\")\n    .style(\"opacity\", \"0\");\n\n   var mousePerLine = mouseG.selectAll('.mouse-per-line')\n   .data((d, i)=> {\n\n    return [d.p1, d.p2]})\n   .join(\"g\")\n   .attr(\"class\", \"mouse-per-line\");\n\n mousePerLine.append(\"circle\")\n   .attr(\"r\", 7)\n   .style(\"stroke\", function(d) {\n     return 'red';\n   })\n   .style(\"fill\", \"none\")\n   .style(\"stroke-width\", \"1px\")\n   .style(\"opacity\", \"0\");\n\n  mousePerLine.append(\"text\").attr('class', 'value')\n   .attr(\"transform\", \"translate(10,3)\");\n\n  mousePerLine.append(\"text\").attr('class', 'species')\n   .attr(\"transform\", \"translate(10,3)\");\n\nmouseG.append('svg:rect') // append a rect to catch mouse movements on canvas\n      .attr('width', width) // can't catch mouse events on a g element\n      .attr('height', height)\n      .attr('fill', 'none')\n      .attr('pointer-events', 'all')\n      .on('mouseout', function() { // on mouse out hide line, circles and text\n        d3.selectAll(\".mouse-line\")\n          .style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line circle\")\n          .style(\"opacity\", \"0\");\n        d3.selectAll(\".mouse-per-line text\")\n          .style(\"opacity\", \"0\");\n      })\n      .on('mouseover', (d, i, n)=> { // on mouse in show line, circles and text\n        d3.select(n[i].parentNode).selectAll('.mouse-line')\n          .style(\"opacity\", \"1\");\n          d3.select(n[i].parentNode).selectAll(\".mouse-per-line circle\")\n          .style(\"opacity\", \"1\");\n          d3.select(n[i].parentNode).selectAll(\".mouse-per-line text\")\n          .style(\"opacity\", \"1\");\n\n          \n      })\n      .on('mousemove', (dat, i, n)=> { // mouse moving over canvas\n        var mouse = d3.mouse(n[i]);\n       \n        d3.select(n[i].parentNode).select('.mouse-line')\n          .attr(\"d\", function() {\n            var d = \"M\" + mouse[0] + \",\" + height;\n            d += \" \" + mouse[0] + \",\" + 0;\n            return d;\n          });\n       \n          d3.select(n[i].parentNode).selectAll('.mouse-per-line')\n          .attr(\"transform\", function(d, j, node) {\n         \n            var xDate = xScale.invert(mouse[0]),\n                bisect = d3.bisector(function(d) { return d.edgeLength; }).right,\n                idx = bisect(d.values, xDate);\n            \n            let line = n[i].parentNode.parentNode.getElementsByClassName('inner-line');\n          \n            var beginning = 0,\n                end = line[j].getTotalLength(),\n                target = null\n\n            while (true){\n               target = Math.floor((beginning + end) / 2);\n               var pos = line[j].getPointAtLength(target);\n              if ((target === end || target === beginning) && pos.x !== mouse[0]) {\n                  break;\n              }\n              if (pos.x > mouse[0])      end = target;\n              else if (pos.x < mouse[0]) beginning = target;\n              else break; //position found\n            }\n            let y = dat.p1[0].attributes[field].scales.yScale;\n          \n            d3.select(node[j]).select('text.value')\n              .text(y.invert(pos.y).toFixed(2))\n              .style('font-size', 11)\n              .attr('y', ()=> {\n                  return j === 0 ? 10 : -10;\n                });\n\n            d3.select(node[j]).select('text.species')\n                .text(d[d.length-1].node)\n                .style('font-size', 11)\n                .attr('y', ()=> {\n                    return j === 0 ? 19 : -19;\n                  });\n              \n            return \"translate(\" + mouse[0] + \",\" + pos.y +\")\";\n          });\n      });\n\n\n   \n}","import * as d3 from \"d3\";\nimport { renderDistibutions, groupDistributions, renderDistStructure, binGroups } from './distributionView';\nimport {drawPathsAndAttributes} from './renderPathView';\nimport { getLatestData } from \"./filterComponent\";\nimport { generatePairs, rankingControl } from \"./pairView\";\nimport { drawTreeForGroups, createCladeView, chosenCladesGroup } from \"./cladeMaker\";\nimport { calculatedScalesKeeper } from \".\";\n\nexport let groupedView = false;\n\nexport function updateMainView(d, groups){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n    let moveMetric = 'edgeLength';\n\n    let scales = calculatedScalesKeeper[0];\n\n    main.selectAll('*').remove();\n\n    let view = d3.select('#view-pheno').text()\n   \n    if(d != 'Pair View' && view === 'View Phenogram'){\n        d3.select('.dropdown.attr-drop').remove();\n    }\n  \n    if(d === 'Path View' || d === null){\n        d3.select('#pair-rank').classed('hidden', true);\n        drawPathsAndAttributes(data, main);\n\n        document.getElementById(\"scrunch\").disabled = false;\n        document.getElementById(\"discrete-view\").disabled = false;\n\n        d3.select('#scrunch').classed('hidden', false);\n        d3.select('#discrete-view').classed('hidden', false);\n\n    }else if(d === 'Summary View'){\n\n        d3.select('#pair-rank').classed('hidden', true);\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n        if(groups){\n            renderDistStructure(main, groups)\n        }else{\n           // groupDistributions(data, main, null);\n           renderDistStructure(main, data);\n        }\n    }else if(d === 'Pair View'){\n        rankingControl(data);\n        generatePairs(data);\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n    // }else if(d === 'Clade View'){\n    //     d3.select('#pair-rank').classed('hidden', true);\n    //     createCladeView(main, scales);\n\n    //     document.getElementById(\"scrunch\").disabled = true;\n    //     document.getElementById(\"discrete-view\").disabled = true;\n\n    //     d3.select('#scrunch').classed('hidden', true);\n    //     d3.select('#discrete-view').classed('hidden', true);\n\n    }else{\n        console.error('field not found');\n    }\n}\nexport function initialViewLoad(scales, dataName){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n\n    main.selectAll('*').remove();\n\n    if(data.length > 50){\n\n        renderDistStructure(main, chosenCladesGroup[chosenCladesGroup.length - 1].groups);\n        \n        d3.select('#view-toggle').text('View Paths');\n\n        document.getElementById(\"scrunch\").disabled = true;\n        document.getElementById(\"discrete-view\").disabled = true;\n\n        d3.select('#scrunch').classed('hidden', true);\n        d3.select('#discrete-view').classed('hidden', true);\n\n    }else{\n        \n        drawPathsAndAttributes(data, main);\n        d3.select('#view-toggle').text('View Summary');\n\n        document.getElementById(\"scrunch\").disabled = false;\n        document.getElementById(\"discrete-view\").disabled = false;\n\n        d3.select('#scrunch').classed('hidden', false);\n        d3.select('#discrete-view').classed('hidden', false);\n      \n    }\n\n}\n\n","import '../styles/index.scss';\nimport * as d3 from \"d3\";\n\nimport {dataMaster, nestedData, collapsed} from './index';\nimport {getScales} from './filterComponent';\nimport {getNested} from './pathCalc';\nimport { dropDown } from './buttonComponents';\nimport { updateRanking } from './pairView';\nimport { pairPaths, maxTimeKeeper } from './dataFormat';\nimport { cladesGroupKeeper, chosenCladesGroup, growSidebarRenderTree } from './cladeMaker';\n\n\nexport function buildTreeStructure(paths, edges){\n   \n    let root = paths[0][0];\n    let nestedData = getNested(root, edges);\n    return nestedData;\n}\n\nexport function traitColorDropDown(scales, sidebar, renderCallback){\n\n    let optionArray  = reduce2DropArray(scales);\n\n    let dropOptions = dropDown(sidebar, optionArray, `Color By Value`,'show-drop-div-sidebar');\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            renderCallback(d, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Colored by ${d.field}`)\n        }else if(d.type === 'continuous'){\n            renderCallback(d, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Colored by ${d.field}`);\n        }else{\n             renderCallback(null, true, false)\n            d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Color By Value`);\n        }\n    sidebar.select('#show-drop-div-sidebar').classed('show', false);\n    });\n\n}\n\nexport function reduce2DropArray(startArray){\n    return  startArray.reduce(function(array, scale){\n        array.push(scale);\n        return array; \n    }, [{'field':'None'}]); \n}\n\nexport function renderTreeButtons(normedPaths){\n\n    let scales = getScales();\n    let sidebar = d3.select('#sidebar');\n\n    ///SIDBAR STUFF\n    let buttonWrap = sidebar.append('div').classed('button-wrap', true);\n    traitColorDropDown(scales, buttonWrap, renderTree);\n    let phenoOptions = reduce2DropArray(scales.filter(f=> f.type != 'discrete'));\n \n      ///BUTTON FOR PHENOGRAM VIEW. MAYBE MOVE THIS TO SIDEBAR\n    let phenogramButton = d3.select('#sidebar').select('.button-wrap').append('button').text('View Phenogram');\n    phenogramButton.classed('btn btn-outline-secondary', true).attr('id', 'view-pheno'); \n    phenogramButton.on('click', ()=> {\n          if(phenogramButton.text() === 'View Phenogram'){\n            if(d3.select('.attr-drop.dropdown').select('button').empty()){\n                let drop = dropDown(d3.select('#toolbar'), phenoOptions, `Trait: ${phenoOptions[1].field}`, 'attr-drop');\n                d3.select('.attr-drop.dropdown').select('button').attr('value', phenoOptions[1].field);\n                d3.select('.dropdown.show-drop-div-sidebar').select('button').text(`Color By Value`);\n                drop.on('click', (d, i, n)=> {\n                    if(d3.select('.dropdown.change-view').select('button').node().value === \"View Pairs\"){\n                        updateRanking(pairPaths(normedPaths), d.field);\n                    }\n                    renderTree(true, d.field);\n                    d3.select('.attr-drop.dropdown').select('button').text(`Trait: ${d.field}`);\n                    d3.select('.attr-drop.dropdown').select('button').attr('value')\n                    d3.select('.attr-drop.dropdown').select('button').attr('value', d.field);\n                    d3.select('#attr-drop').classed('show', false);\n                });\n                renderTree(null, true, d3.select('.attr-drop.dropdown').select('button').attr('value'))\n              }else{\n                renderTree(null, true, d3.select('.attr-drop.dropdown').select('button').attr('value'))\n              }\n              phenogramButton.text('View Phylogeny');\n          }else{\n            ////ADD THE HIDE BUTTON HERE \n            let view = d3.select('.dropdown.change-view').select('button').text();\n           \n            if(view != \"Pair View\"){\n                d3.select('.dropdown.attr-drop').remove();\n            }\n            renderTree(null, true, false);\n            phenogramButton.text('View Phenogram');\n\n          }\n    })\n\n    let cladeButton = buttonWrap.append('button').attr('id', 'clade-maker');\n    cladeButton.attr('class', 'btn btn-outline-secondary').text('Clade View');\n    cladeButton.on('click', ()=> growSidebarRenderTree(null));\n}\n\nfunction uncollapseSub(d){\n    d.children = d._children;\n    d._children = null;\n    if(d.children){\n        d.children.map(c=> uncollapseSub(c));\n    }    \n}\n\nfunction collapseSub(d){\n    if(d.children) {\n        d._children = d.children\n        d._children.forEach(collapseSub)\n        d.children = null\n    }  \n}\n\nfunction collapseTree(treeData){\n\n    let leaves = getLeaves(treeData, []);\n\n    return stepDown(treeData);\n\n    function stepDown(node){\n        let leaves = getLeaves(node, []);\n        \n        let ids = new Set(leaves.map(m=> m.data.attributes.Clade.values.Clade));\n        if(ids.size > 1){\n            node.children.map(n=> stepDown(n))\n        }else{\n            node.branchPoint = true;\n            node.clade = Array.from(ids)[0]\n            collapseSub(node);\n            return node;\n        }\n        return node;\n    }\n    \n    function getLeaves(node, array){\n        if(node.children != undefined ){\n            node.children.map(n=> getLeaves(n, array))\n        }else{\n            array.push(node);\n        };\n        return array;\n    }\n}\n\nexport function assignPosition(node, position) {\n    if (node.children === undefined || node.children === null){\n        \n        position = position + 1.5;\n        node.position = position;\n        return position;\n    }else{\n        let positionArray = []\n        node.children.forEach((child) => {\n            position = assignPosition(child, position);\n            positionArray.push(position);\n        });\n        node.options = positionArray;\n        node.position = d3.max(positionArray);\n        return position;\n    }\n}\n\nexport function addingEdgeLength(edge, data){\n    data.combEdge = data.edgeLength + edge;\n    if(data.children){\n        data.children.forEach(chil=> {\n            addingEdgeLength(data.combEdge, chil);\n        });\n    }\n}\n\nexport function renderTree(att, uncollapse, pheno){\n\n    let sidebar = d3.select('#sidebar');\n\n    const dimensions =  {\n        margin : {top: 10, right: 90, bottom: 50, left: 20},\n        width : 260,\n        height : 520,\n        lengthHeight: 800,\n    }\n\n    let lengthBool = true;\n\n    // declares a tree layout and assigns the size\n    var treemap = d3.tree()\n    .size([dimensions.height, dimensions.width]);\n\n    addingEdgeLength(0, nestedData[0]);\n    \n    //  assigns the data to a hierarchy using parent-child relationships\n    var treenodes = d3.hierarchy(nestedData[0]);\n\n    // maps the node data to the tree layout\n    treenodes = treemap(treenodes);\n\n    let groupedBool = d3.select('#show-drop-div-group').attr('value');\n\n    let sidebarTest = sidebar.select('svg');\n    let treeSvg = sidebarTest.empty() ? sidebar.append(\"svg\") : sidebarTest;\n    treeSvg.classed('tree-svg', true);\n    treeSvg.attr(\"width\", dimensions.width + dimensions.margin.left + dimensions.margin.right)\n    .attr(\"height\", dimensions.height + dimensions.margin.top + dimensions.margin.bottom);\n\n    let gTest = treeSvg.select('g.tree-g');\n    let g = gTest.empty() ? treeSvg.append(\"g\").classed('tree-g', true) : gTest;\n    g.attr(\"transform\",\n      \"translate(\" + dimensions.margin.left + \",\" + dimensions.margin.top + \")\");\n\n    if(groupedBool === \"ungrouped\" && uncollapse === false){\n        if((cladesGroupKeeper.length > 0) && (chosenCladesGroup[chosenCladesGroup.length - 1].field != 'Clade Attribute)')){\n            let newNodes = collapseTree(treenodes);\n            updateTree(newNodes, dimensions, treeSvg, g, att, lengthBool, uncollapse);\n        }else{\n            updateTree(treenodes, dimensions, treeSvg, g, att, lengthBool, pheno, uncollapse);\n        }\n        \n    }else{\n        ////Break this out into other nodes////\n        updateTree(treenodes, dimensions, treeSvg, g, att, lengthBool, pheno, uncollapse);\n    }\n    /////END TREE STUFF\n    ///////////\n}\n\nexport function findDepth(node, array){\n    function stepDown(n){\n        if(n.children != null){\n            n.children.forEach(child=> {\n                stepDown(child);\n            })\n        }else{\n            array.push(n);\n        }\n    }\n    stepDown(node);\n    return array;\n}\n\nexport function updateTree(treenodes, dimensions, treeSvg, g, attrDraw, length, pheno, uncollapse){\n\n    d3.select('.pheno-y-axis').remove();\n    d3.select('.pheno-x-axis').remove();\n    \n    assignPosition(treenodes, 0);\n\n    let branchCount = findDepth(treenodes, []);\n    let xScale = d3.scaleLinear().domain([0, maxTimeKeeper[0]]).range([0, dimensions.width]).clamp(true);\n    let yScale = d3.scaleLinear().range([dimensions.height, 0]).domain([0, 1])\n\n    if(length){   \n        g.attr('transform', 'translate(20, 265)');\n        treeSvg.attr('height', 800);\n        yScale.range([500, 0]).domain([0, branchCount.length])\n        xScale.range([0, dimensions.width + 10]);\n    } \n    if(pheno){\n        treeSvg.attr('height', 800);\n        xScale.domain(treenodes.data.attributes[pheno].scales.yScale.domain())\n        yScale.domain([0, maxTimeKeeper[0]]).range([0, 500])\n    }\n\n    // adds the links between the nodes\n    let link = g.selectAll(\".link\")\n    .data( treenodes.descendants().slice(1))\n    .join(\"path\")\n    .attr(\"class\", \"link\");\n\n    link.transition()\n    .duration(500)\n    .attr(\"d\", function(d) {\n        if((length && pheno === undefined) || (length && pheno === false)){\n           return \"M\" + xScale(d.data.combEdge) + \",\" + yScale(d.position)\n           + \"C\" + (xScale(d.data.combEdge) + xScale(d.parent.data.combEdge)) / 2 + \",\" + yScale(d.position)\n           + \" \" + (xScale(d.parent.data.combEdge)) + \",\" + yScale(d.position)\n           + \" \" + xScale(d.parent.data.combEdge) + \",\" + yScale(d.parent.position);\n        }else{\n            return \"M\" + xScale(d.data.attributes[pheno].values.realVal) + \",\" + yScale(d.data.combEdge)\n            + \" \" + xScale(d.parent.data.attributes[pheno].values.realVal) + \",\" + yScale(d.parent.data.combEdge);\n        }       \n    });\n\n    if(pheno){\n        \n        link.style('opacity', 0.3);\n        g.attr('transform', 'translate(30, 50)');\n\n        let x = xScale.domain(treenodes.data.attributes[pheno].scales.yScale.domain()).range([0, (dimensions.width+20)]);\n        let xAxis = d3.axisBottom(x);\n        g.append('g').classed('pheno-x-axis', true).call(xAxis).attr('transform', 'translate(0, 510)').select('path').attr('stroke-width', 0);\n\n        let y = d3.scaleLinear().domain([0,maxTimeKeeper[0]]).range([0, dimensions.height -20]);\n        let yAxis = d3.axisLeft(y);\n        g.append('g').classed('pheno-y-axis', true).call(yAxis).attr('transform', 'translate(0, 2)').select('path').attr('stroke-width', 0);;\n    }\n\n    // adds each node as a group\n    var node = g.selectAll(\".node\")\n    .data(treenodes.descendants(), d => d.data.node)\n    .join(\"g\")\n    .attr(\"class\", function(d) { \n    return \"node\" + \n    (d.children ? \" node--internal\" : \" node--leaf\"); });\n\n    // adds the circle to the node\n    node.selectAll('circle').data(d=> [d]).join(\"circle\")\n      .attr(\"r\", 3);\n\n    node.transition()\n    .duration(500)\n    .attr(\"transform\", function(d) { \n        if(length && pheno === undefined || pheno === false){\n            return \"translate(\" + xScale(d.data.combEdge) + \",\" + yScale(d.position) + \")\"; \n        }else{\n\n           return \"translate(\" + (xScale(d.data.attributes[pheno].values.realVal) - 5) + \",\" + yScale(d.data.combEdge) + \")\"; \n        }\n    });\n\n    if(attrDraw != null){\n        let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = node.filter(n=> n.data.leaf != true);\n\n        if(attrDraw.type === 'discrete'){\n            attrDraw.stateColors.forEach(att=> {\n                let circ = leaves.filter(f=> {\n                    return att.state.includes(f.data.attributes[attrDraw.field].states.state)//f.data.attributes[attrDraw.field].winState === att.state;\n                }).select('circle');\n                circ.attr('fill', att.color);\n                notleaves.selectAll('circle').attr('fill', 'gray');\n            });\n        }else{\n            let scale = attrDraw.yScale;\n            scale.range(['#fff', '#E74C3C']);\n            leaves.select('circle').attr('fill', (d, i)=> {\n                return scale(d.data.attributes[attrDraw.field].values.realVal);\n            });\n        }\n    }else{\n        node.selectAll('circle').attr('fill', 'gray');\n    }\n\n    node.on('mouseover', (d, i, n)=> {\n        let paths = d3.select('#main-path-view').selectAll('.paths');\n        let points = d3.select('#main-summary-view').selectAll('.branch-points');\n        points.filter(f=> f.node === d.data.node).classed('selected', true);\n\n        let selectedPaths = paths.filter(path=> {\n            let nodes = path.map(m=> m.node);\n            return nodes.indexOf(d.data.node) > -1;\n        }).classed('hover', true);\n        selectedPaths.selectAll('g').filter(g=> g.node === d.data.node).classed('selected', true);\n        d3.select(n[i]).classed('selected-branch', true);\n\n        if(d.data.label){\n            let tool = d3.select('#tooltip');\n            tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n          \n            tool.html(`${d.data.label.charAt(0).toUpperCase() + d.data.label.slice(1)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n        }\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.selectAll('.paths.hover').classed('hover', false);\n        d3.selectAll('g.selected').classed('selected', false);\n        d3.select(n[i]).classed('selected-branch', false);\n\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n    let leaves = node.filter(f=> f.data.children.length == 0);\n\n    node.selectAll('text').remove();\n    node.selectAll('.triangle').remove();\n\n    let branchNodes = node.filter(n=> n.branchPoint === true);\n\n    branchNodes.each((b, i, n)=> {\n        if(b.children === null){\n            let triangle = d3.select(n[i]).append('path').classed('triangle', true).attr('d', d3.symbol().type(d3.symbolTriangle).size('400'))\n            triangle.attr('transform', `rotate(-90) translate(0, 65) scale(.9 4)`);\n            triangle.attr('fill', 'gray').style('opacity', 0.3);\n            let text = d3.select(n[i]).selectAll('text').data(d=> [d]).join('text').text(b.clade);\n            text.attr('transform', 'translate(55, 5)');\n        }\n    })\n    branchNodes.select('circle').attr('fill', 'red').attr('r', 4.5);\n    branchNodes.on('click', (d, i, n)=> {\n        if(d.children == null){\n            uncollapseSub(d);\n        }else{\n            collapseSub(d);\n        }\n        let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n        updateTree(treenodes, dimensions, treeSvg, g, attrDraw, lengthBool, uncollapse);\n      \n    });\n\n    node.raise();\n    node.selectAll('circle').raise();\n\n\n    if(uncollapse){\n       \n        // let groups = chosenCladesGroup[chosenCladesGroup.length - 1];\n        \n        // let groupGroup = treeSvg.selectAll('.clade-rects')\n        // .data(groups.groups)\n        // .join('g')\n        // .attr('class', d=> d.label)\n        // .classed('clade-rects', true)\n    \n        // let rect = groupGroup.append('rect');\n        // rect.attr('width', 20);\n        // rect.attr('height', (d, i)=> {\n        //     return d.paths.length * 6;\n        // });\n        // groupGroup.each((d, i, node)=> {\n       \n        //     let first = d.paths.map(m=> m[m.length-1].node);\n        //     let test = treeSvg.selectAll('.node--leaf').filter((f)=> {\n        //         return first.indexOf(f.data.node) > -1});\n        //     let leafSort = test.data().sort((a, b)=> {\n        //         return a.x - b.x;\n        //     });\n        //     console.log(leafSort[0].data.node)\n\n        //     let chosenNode = test.filter(f=> {\n        //         return f.data.node === leafSort[leafSort.length - 1].data.node;\n        //     });\n\n        //     console.log(chosenNode.data())\n     \n        //     d3.select(node[i]).attr('transform', `translate(300, ${yScale(leafSort[0].position)})`)\n        // })\n\n     \n      \n        \n    }\n\n    return node;\n}","import * as d3 from \"d3\";\n/* Multinet data importer */\n// Define local variables that will store the api url and the responses from the database\nlet multinet = {\n    tables: {},\n    nodes: [],\n    links: [],\n    graph_structure: {},\n    api_root: \"https://multinet.app/api\"\n};\n\nexport async function load_data(workspace, graph) {\n    // Fetch the names of all the node and edge tables \n    await load_tables(workspace, graph);\n\n    // Loop through each node tables and fetch the nodes to global variables\n    for (let node_table of multinet.tables.nodeTables) {\n        await load_nodes(workspace, node_table);\n    };\n\n    // Load the edge table (ONLY ONE BECAUSE OF ARANGO API LIMITATIONS) to a global variable\n    let edge_table = multinet.tables.edgeTable;\n    await load_links(workspace, edge_table);\n\n    // Set the graph structure\n    multinet.graph_structure = { \"nodes\": rename_node_vars(multinet.nodes), \"links\": rename_link_vars(multinet.links) }\n\n    return JSON.parse(JSON.stringify(multinet.graph_structure))\n\n};\n\nasync function load_tables(workspace, graph) {\n    var tables_call = multinet.api_root + \"/workspaces/\" + workspace + \"/graphs/\" + graph\n    multinet.tables = await d3.json(tables_call);\n};\n\n\nasync function load_nodes(workspace, node_table) {\n    let nodes_call = multinet.api_root + \"/workspaces/\" + workspace + \"/tables/\" + node_table + \"?limit=1000\"\n    let table = await d3.json(nodes_call);\n    multinet.nodes = [].concat(multinet.nodes, table)\n};\n\n\nasync function load_links(workspace, edge_table) {\n    let links_call = multinet.api_root + \"/workspaces/\" + workspace + \"/tables/\" + edge_table + \"?limit=1000\"\n    let table = await d3.json(links_call);\n    multinet.links = [].concat(multinet.links, table)\n};\n\nfunction rename_link_vars(links) {\n    for (let row of links) {\n        row.id = row._id;\n        row.source = row._from;\n        row.target = row._to;\n\n        delete row._id;\n        delete row._from;\n        delete row._to;\n    };\n\n    return links;\n}\n\nfunction rename_node_vars(nodes) {\n    for (let row of nodes) {\n        row.id = row._id;\n\n        delete row._id;\n    };\n\n    return nodes;\n}\n","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {loadData} from './dataLoad';\nimport {calculateNewScales, rootAttribute, combineLength} from './dataFormat';\nimport {allPaths, pullPath, getPathRevised, getPath} from './pathCalc';\nimport {renderTree, buildTreeStructure, renderTreeButtons} from './sidebarComponent';\nimport {toolbarControl} from './toolbarComponent';\nimport { initialViewLoad } from './viewControl';\nimport { groupDataByClade, groupDataByAttribute, addCladeGroup, cladesGroupKeeper, chosenCladesGroup, cladeKeeper, addClade} from './cladeMaker';\nimport { binGroups } from './distributionView';\nimport { load_data } from './multinetLoad';\n\nexport const dataMaster = [];\nexport const savedSelected = [];\nexport const collapsed = false;\nexport const nestedData = [];\nexport const speciesTest = [];\nexport const calculatedScalesKeeper = [];\n\nexport const colorKeeper = [\n    ['#0dc1d1', '#c8f7fd'],\n    ['#3AD701', '#2a9b01'],\n    ['#fec303', '#d3a001'],\n    ['#fe4ecb', '#d30197'],\n    ['#f36b2c'],\n    ['#1abc9c'],\n    ['#493267'],\n    ['#a40b0b'],\n    ['#0095b6'],\n    ['#97A628'],\n    ['#9B28A6'],\n    ['#3928A6'],\n    ['#0dc1d1', '#c8f7fd'],\n    ['#3AD701', '#2a9b01'],\n    ['#fec303', '#d3a001'],\n    ['#fe4ecb', '#d30197'],\n    ['#f36b2c'],\n    ['#1abc9c'],\n    ['#493267'],\n    ['#a40b0b'],\n    ['#0095b6'],\n    ['#97A628'],\n    ['#9B28A6'],\n    ['#3928A6'],\n]\n\nexport const attributeList = [];\n\nlet discreteTraitList = ['Clade', 'Group', 'island/mainland']\n\nlet wrap = d3.select('#wrapper');\nlet main = wrap.select('#main');\nwrap.select('#selected').classed('hidden', true);\nlet sidebar = wrap.select('#sidebar');\nlet toolbarDiv = wrap.select('#toolbar');\nwrap.select('#filter-tab').classed('hidden', true);\n\nlet tooltip = wrap.append(\"div\")\n.attr(\"id\", \"tooltip\")\n.style(\"opacity\", 0);\n\n////DATA LOADING////\nlet test = load_data('evobio', 'anolis');\nconsole.log('test',test)\n\nappLaunch();\n\nasync function appLaunch(){\n\n//     dataLoadAndFormat('geospiza-edges.json', 'geospiza-edge-lengths.json', 'geospiza-leaf-data.csv', 'geospiza-res.json', 'Geospiza').then((centData)=> {\n      \n//         toolbarControl(toolbarDiv, main, centData[1]);\n//         wrap.select('#filter-tab').classed('hidden', true);\n//         renderTreeButtons(centData[0], false);\n//         renderTree(null, true, false);\n//         /// LOWER ATTRIBUTE VISUALIZATION ///\n//         initialViewLoad(centData[1], 'Geospiza');\n//     });\n\n    // dataLoadAndFormat('centrarchid-edges.json', 'centrarchid-edge-lengths.json', 'centrarchid-leaf-data.csv', 'centrarchid-res.json', 'Centrarchid').then((centData)=> {\n      \n    //         toolbarControl(toolbarDiv, main, centData[1]);\n    //         wrap.select('#filter-tab').classed('hidden', true);\n    //         renderTreeButtons(centData[0]);\n    //         renderTree(null, true, false);\n    //         /// LOWER ATTRIBUTE VISUALIZATION ///\n    //         initialViewLoad(centData[1], 'Centrarchid');\n    // });\n\n    dataLoadAndFormat('anolis-edges.json', 'anolis-edge-lengths.json', 'anolis-leaf-data.csv', 'anolis-res.json', 'Anolis').then((centData)=> {\n      \n        toolbarControl(toolbarDiv, main, centData[1]);\n        d3.select('#clade-show').selectAll('li').select('input').node().checked = true\n  \n        renderTree(null, true, false);\n        renderTreeButtons(centData[0]);\n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        initialViewLoad(centData[1]);\n});\n\n// dataLoadAndFormatMultinet('anolis_edges.csv', 'anolis_internal.csv', 'anolis_leaf.csv', 'Anolis').then(centData=> {\n    \n//     toolbarControl(toolbarDiv, main, centData[1]);\n   \n//     renderTree(null, true, false);\n//     renderTreeButtons(centData[0], false);\n//     /// LOWER ATTRIBUTE VISUALIZATION ///\n//     initialViewLoad(centData[1]);\n// });\n\n}\n\nasync function dataLoadAndFormatMultinet(edgeFile, internalFile, leafFile, dataName){\n\n        //helper function to create array of unique elements\n        Array.prototype.unique = function() {\n            return this.filter(function (value, index, self) { \n                return self.indexOf(value) === index;\n            });\n        }\n\n        let attributeList = []\n\n        let edges = await loadData(d3.csv, `./data/${edgeFile}`, 'edge');\n        let internal = await loadData(d3.csv, `./data/${internalFile}`, '');\n        let leaves = await loadData(d3.csv, `./data/${leafFile}`, '');\n    \n        ///Creating attribute list to add estimated values in //\n    \n        leaves.columns.filter(f=> (f != 'species') && (f != 'label') && (f != '_key') && (f != 'length')).forEach((d, i)=> {\n    \n            if(discreteTraitList.indexOf(d) > -1){\n                attributeList.push({field: d, type: 'discrete'});\n            }else{\n                attributeList.push({field: d, type:'continuous'});\n            }\n    \n        });\n    \n        let calculatedAtt = internal.map((row, i)=> {\n            let newRow = {};\n            attributeList.forEach((att)=>{\n                newRow[att.field] = {};\n                newRow[att.field].field = att.field;\n                newRow[att.field].type = att.type;\n                let values = {}\n                d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                    if(att.type === 'continuous'){\n                       \n                        if(m.key.includes('upperCI')){\n                            values.upperCI95 = +m.value;\n                        }else if(m.key.includes('lowerCI')){\n                            values.lowerCI95 = +m.value;\n                        }else{\n                            values.realVal = +m.value;\n                        }\n                    }else{\n                         values[m.key] = m.value;   \n                    }\n                });\n                newRow[att.field].values = values;\n            });\n            newRow.node = row.label;\n            newRow.length = row.length;\n            newRow.leaf = false;\n            return newRow;\n        });\n\n        let calcLeafAtt = leaves.map((row, i)=> {\n            let newRow = {};\n            attributeList.forEach((att)=>{\n                newRow[att.field] = {};\n                newRow[att.field].field = att.field;\n                newRow[att.field].type = att.type;\n                let values = {}\n                d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                    if(att.type === 'continuous'){\n                        values.realVal = +m.value;\n                    }else{\n                        values[m.key] = m.value;   \n                    }\n                });\n                newRow[att.field].values = values;\n            });\n            newRow.node = row.label;\n            newRow.label = row.label;\n            newRow.length = row.length;\n            newRow.leaf = true;\n            return newRow;\n        })\n\n        let calculatedScales = calculateNewScales(calculatedAtt, attributeList.map(m=> m.field), colorKeeper);\n    \n        let matchedEdges = edges.map((edge, i)=> {\n\n            let indexTo = +edge._to.match(/(\\d+)/)[0];\n            let indexFrom = +edge._from.match(/(\\d+)/)[0];\n\n            let attrib = edge._to.includes(\"internal\") ? calculatedAtt[indexTo] : calcLeafAtt[indexTo];\n            let fromNode = edge._from.includes(\"internal\") ? calculatedAtt[indexFrom] : calcLeafAtt[indexFrom];\n\n            if(attrib){\n                Object.keys(attrib).filter(f=> (f != 'node') && (f != 'label') && (f != 'length') && (f != 'leaf')).map((att, i)=>{\n                    let scales = calculatedScales.filter(f=> f.field=== att)[0];\n                    attrib[att].scales = scales;\n                    return att;\n                })\n            }\n            let newEdge = {\n                V1: fromNode.node,\n                V2: attrib.node,\n                node: attrib.node,\n                leaf: attrib.leaf,\n                edgeLength: +attrib.length,\n                attributes: attrib ? attrib : null\n            }\n            return newEdge;\n        });\n    \n        let paths = allPaths(matchedEdges, matchedEdges.filter(f=> f.leaf === true), \"V1\", \"V2\")\n            .map((path, i)=> {\n                let root = path[0];\n                let attrib = calculatedAtt.filter(f=> f.node === root.node)[0];\n                if(attrib){\n                    Object.keys(attrib).filter(f=> (f != 'node') && (f != 'label') && (f != 'length') && (f != 'leaf')).map((att, i)=>{\n                        let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                        attrib[att].scales = scales;\n                        return att;\n                    })\n                }\n                let rooted = {\n                    V1: null,\n                    V2: attrib.node,\n                    node: attrib.node,\n                    leaf: attrib.leaf,\n                    root: true,\n                    edgeLength: 0,\n                    attributes: attrib ? attrib : null\n                }\n                path[0] = rooted;\n                return path;\n            });\n\n      \n        let normedPaths = combineLength(paths);\n\n        let group = binGroups(normedPaths, dataName, calculatedScales, 8);\n        let chosenClade = addCladeGroup(dataName, ['Whole Set'], [{'label': dataName, 'paths': normedPaths, 'groupBins': group}]);\n        chosenCladesGroup.push(chosenClade);    \n\n        calculatedScalesKeeper.push(calculatedScales);\n        dataMaster.push(normedPaths);\n        nestedData.push(buildTreeStructure(normedPaths, matchedEdges));\n        speciesTest.push(normedPaths.flatMap(m=> m.filter(f=> f.leaf === true)).map(l=> l.node));\n    \n        return [normedPaths, calculatedScales];\n}\n\nasync function dataLoadAndFormat(edgeFile, edgeLengthFile, leafCharFile, resFile, dataName){\n\n    //helper function to create array of unique elements\n    Array.prototype.unique = function() {\n        return this.filter(function (value, index, self) { \n            return self.indexOf(value) === index;\n        });\n    }\n\n    let edges = await loadData(d3.json, `./public/data/${edgeFile}`, 'edge');\n    let leafChar = await loadData(d3.csv, `./public/data/${leafCharFile}`, '');\n    let edgeLen = await loadData(d3.json, `./public/data/${edgeLengthFile}`, 'edge');\n    let char = await loadData(d3.json, `./public/data/${resFile}`, '');\n\n    ///Creating attribute list to add estimated values in //\n\n    leafChar.columns.filter(f=> f != 'species').forEach((d, i)=> {\n\n        if(discreteTraitList.indexOf(d) > -1){\n            attributeList.push({field: d, type: 'discrete'});\n        }else{\n            attributeList.push({field: d, type:'continuous'});\n        }\n\n    });\n\n    edges.rows = edges.rows.filter(f=> f.From != \"\").map((edge, i)=> {\n        edge.edgeLength = edgeLen.rows[i].x;\n        return edge;\n    });  \n\n    //Mapping data together/////\n    let edgeSource = edges.rows.map(d=> d.From);\n   \n    let leaves = edges.rows.filter(f=> edgeSource.indexOf(f.To) == -1 );\n\n    let calculatedAtt = char.rows.map((row, i)=> {\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                   \n                    if(m.key.includes('upperCI')){\n                        values.upperCI95 = m.value;\n                    }else if(m.key.includes('lowerCI')){\n                        values.lowerCI95 = m.value;\n                    }else{\n                        values.realVal = m.value;\n                    }\n                }else{\n                     values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.nodeLabels;\n        return newRow;\n    });\n\n  \n    let calculatedScales = calculateNewScales(calculatedAtt, attributeList.map(m=> m.field), colorKeeper);\n\n    let matchedEdges = edges.rows.map((edge, i)=> {\n        let attrib = calculatedAtt.filter(f=> f.node === edge.To)[0]\n        if(attrib){\n            Object.keys(attrib).filter(f=> f != 'node').map((att, i)=>{\n                \n                let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                attrib[att].scales = scales;\n                return att;\n                \n            })\n        }\n        let newEdge = {\n            V1: edge.From,\n            V2: edge.To,\n            node: edge.To,\n            edgeLength: edge.edgeLength,\n            attributes: attrib ? attrib : null\n        }\n        return newEdge;\n    });\n\n\n    let calcLeafAtt = leafChar.map((row, i)=> {\n        let newRow = {};\n        attributeList.forEach((att)=>{\n            newRow[att.field] = {};\n            newRow[att.field].field = att.field;\n            newRow[att.field].type = att.type;\n            let values = {}\n            d3.entries(row).filter(f=> f.key.includes(att.field)).map(m=> {\n                if(att.type === 'continuous'){\n                    values.realVal = m.value;\n                }else{\n                    values[m.key] = m.value;   \n                }\n            });\n            newRow[att.field].values = values;\n        });\n        newRow.node = row.species;\n        newRow.label = row.species;\n        \n        return newRow;\n    })\n\n\n    let matchedLeaves = leaves.map((leaf, i)=>{\n        let attrib = calcLeafAtt.filter(f=> f.node === leaf.To)[0]\n        if(attrib){\n            Object.keys(attrib).map((att, i)=>{\n                if(att!='node' && att != 'label'){\n                    let scales = calculatedScales.filter(f=> f.field=== att)[0]\n                    attrib[att].scales = scales;\n                    return att;\n                }\n            });\n        }\n        let newEdge = {\n            V1: leaf.From,\n            V2: leaf.To,\n            node: leaf.To,\n            edgeLength: leaf.edgeLength,\n            attributes: attrib ? attrib : null,\n            group: null,\n            leaf: true\n        }\n        return newEdge;\n    });\n\n    let all = matchedEdges.filter(f=> f.attributes != null);\n\n    let paths = allPaths(all, matchedLeaves, \"V1\", \"V2\");\n    \n    let addedRoot = rootAttribute(paths, calculatedAtt, calculatedScales);\n\n    let normedPaths = combineLength(addedRoot);\n\n    let group = binGroups(normedPaths, dataName, calculatedScales, 8);\n    let chosenClade = addCladeGroup(`All ${dataName}`, ['Whole Set'], [{'label': `All ${dataName}`, 'paths': normedPaths, 'groupBins': group}]);\n    chosenCladesGroup.push(chosenClade)    \n    \n    addClade(`All ${dataName}`, normedPaths);\n\n    calculatedScalesKeeper.push(calculatedScales);\n    dataMaster.push(normedPaths);\n    nestedData.push(buildTreeStructure(normedPaths, all.concat(matchedLeaves)));\n    speciesTest.push(normedPaths.flatMap(m=> m.filter(f=> f.leaf === true)).map(l=> l.node));\n\n    return [normedPaths, calculatedScales];\n}\n\n\n\n\n\n\n\n\n\n\n\n"],"sourceRoot":""}