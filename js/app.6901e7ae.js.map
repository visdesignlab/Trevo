{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/dataLoad.js","webpack:///./src/scripts/dataFormat.js","webpack:///./src/scripts/pathCalc.js","webpack:///./src/scripts/distributionView.js","webpack:///./src/scripts/viewControl.js","webpack:///./src/scripts/filterComponent.js","webpack:///./src/scripts/selectedPaths.js","webpack:///./src/scripts/buttonComponents.js","webpack:///./src/scripts/renderPathView.js","webpack:///./src/scripts/sidebarComponent.js","webpack:///./src/scripts/toolbarComponent.js","webpack:///./src/scripts/index.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","loadData","_x","_x2","_x3","_loadData","this","arguments","_callee","readFunction","fileString","type","regeneratorRuntime","wrap","_context","prev","next","sent","String","abrupt","stop","calculateScales","calculatedAtt","colorKeeper","keys","map","max","d3","rows","upperCI95","min","lowerCI95","realVal","field","yScale","range","domain","clamp","satScale","colorScale","catColor","scaleCat","fields","filter","f","stateColors","sc","state","color","scales","scaleName","matchLeaves","labels","leaves","leafChar","calculatedScales","mappedLeafLabels","x","leaf","label","leafCharIndex","node","V2","attr","chosenOne","indexOf","forEach","k","scaleOb","states","clade","attributes","matchEdges","edges","edgeLen","edge","attrKeys","index","edgeLength","res","estimate","undefined","row","normPaths","paths","att","root","nodeLabels","scale","rootAttr","console","error","maxBranch","xScale","leafIndex","prevStep","assign","step","edgeMove","move","formatAttributeData","pathData","filterArray","path","speciesLabel","species","winState","attrLabel","st","allPaths","edgeArray","leafArray","source","target","le","getPath","pathKeeper","ed","reverse","drawBranchPointDistribution","svg","branchBar","append","classed","text","nodeLengthArray","nodeDuplicateCheck","eMove","bPointScale","pointGroups","selectAll","join","renderDistibutions","mainDiv","moveMetric","attrHide","filterMaster","attribute","newNormed","distributionView_toConsumableArray","keysToHide","medBranchLength","normBins","Array","fill","base","top","binI","internalNodes","leafNodes","flatMap","sortedBins","mapNorm","bin","fData","leafAttr","leafData","histogram","thresholds","ticks","bins","maxO","v","minO","xO","histogramO","branches","colors","chosen","average","stDev","stUp","stDown","test","stat","branchScale","binnedWrap","style","predictedWrap","branchGroup","continDist","on","list","y","select","remove","lineGen","curve","y0","y1","dat","each","nodes","distrib","rangeRect","newy","discreteDist","combEdge","stateGroups","predictedWidth","lineGenD","observedWrap","contOb","contBars","height","xvalues","b","discOb","discBars","dRects","xPoint","padding","updateMainView","main","getLatestData","document","getElementById","disabled","drawPathsAndAttributes","initialViewLoad","pathGroups","from","Set","group","groupDistributions","removeFilter","filterId","dataFilters","filterType","filterIndex","testData","filterComponent_toConsumableArray","dataMaster","fun","filterFunction","attributeType","newTestData","selectedOption","predictedFilter","observedFilter","addFilterTag","fromState","toState","newFilterMaster","addFilter","attType","filFunction","oldData","newData","extra","filterOb","before-data","ex","toggleFilters","filterButton","filterDiv","normedPaths","presentFilters","noShow","wrapper","labelGroups","toggle","shownToggs","togg","circle","toggleCircle","newKeys","hideKeys","newFilMaster","renderAttToggles","concat","selectWrapper","attButton","stateChange","attProps","options","optionArray","optKeys","button1","button2","submit","classList","discreteFilter","filId","treeLinks","treeNode","nodeList","missingLinks","missingNodes","continRanges","ranges","brushBars","wrapperRect","xBrush","extent","selection","handle","invert","brushGroup","selections","_groups","__brush","sort","lastFilter","continuousFilter","stateFilter","searchDiv","form","input","queryArray","split","toLowerCase","filterToolbar","button","span","xSpan","queryFilter","formater","datum","nodeId","nodeFilter","selectedNode","predicted","observed","numb","filterPred","filterObs","win","selectorDiv","selectId","dropDownWrapper","selectedPaths","comparisonKeeper","pathSelected","selectedPath","otherPaths","selectedDiv","selectedPaths_toConsumableArray","commonNodes","selectedSpecies","treeNodes","attrFilter","selectedToolTest","selectedTool","empty","sortByDistanceDiv","sortByDistanceButton","sortButton","attrSortWrap","radioDiv","radio","svgTest","branchFrequency","reduce","acc","curr","selectWrap","circleScale","values","selectedGroups","pathBars","addRemoveBubble","speciesTitle","string","charAt","toUpperCase","timelines","nodeGroups","distance","hovers","nearest","nodearray","attributeWrapper","attData","attributeGroups","renderAttributes","drawContAtt","drawDiscreteAtt","sorted","a","high","leafOther","highLeaves","low","lowLeaves","same","commonNodeStart","children","nodeIndex","thresh","subset","chil","parentBase","scaledParentMove","parentScale","level","getCommonNodes","childNodeWrap","childNodes","pathArray","line","commonHover","renderSelectedTopology","attWrap","ch","attDataComb","offset","last","mappedDis","dis","spec","maxProb","maxP","notMax","other","findMaxState","attGroups","wrapRect","speciesGrp","attributeHeight","lineGenC","innerStatePaths","disGroup","sp","branchGrpDis","bCirc","otherCirc","tool","transition","duration","html","pageX","pageY","conGroup","branchGrpCon","MeanRect","confiBars","longestBranch","startBranch","renderSelectedView","commonNode","chosenPath","rankedPaths","pathIndex","sortedData","sortOtherPaths","pathRemove","dropDown","div","dropText","dropId","dropdiv","dropContent","nodeTooltipFlag","collapsed","pathWrapTest","pathWrap","pathAdd","notIt","renderPaths","attKeys","attrMove","predictedAttrGrps","attribWrap","sizeAndMove","selectedState","leafStateFilter","innerTimeline","innerPaths","change","continuousAtt","continuousPaths","attributeNodesCont","innerBars","drawGroups","stateBins","splitOnArray","newBins","newBinData","pa","firstGroupSvg","firstGroup","secondGroup","g","newM","first","second","groupLabels","renderComparison","buttonGroupTest","buttonGroup","usedColors","groupColor","newColor","find","compareButtonTest","compareButton","comparisonCombined","newAtt","com","atts","filteredComp","selectedTest","attWraps","mean","e","exit","attWrapsEnter","enter","merge","innerWrap","missing","_this","axisGroupTest","axisGroup","maxDiff","newScale","startBins","difArray","_loop","diffs","diff","Math","abs","obsDistWrap","newLeaves","binData","xAxis","distGroups","groupLength","stateLabel","innerGroup","innerWrapRect","wrappers","shiftWraps","xAxisShift","shiftCircles","leafWraps","totalVal","totalMean","newVal","groupMean","dotVals","distcircles","w","totalArray","drawLeaves","log","bars","discreteAtt","innerTimelineDis","statePath","disct","attributeNodesDisc","stateDots","endStateDot","stateBars","probability","chosenIn","valueAdd","buildTreeStructure","getNested","V1","updateBrush","treeBrush","sidebar","toolbarDiv","treeFilter","brushId","attributType","sidebarComponent_toConsumableArray","_ref","mark","renderTreeButtons","treeButton","renderTree","treeViewButton","selectedNodes","no","id","collapseSub","_children","uncollapse","dimensions","margin","right","bottom","left","width","treemap","size","addingEdgeLength","nestedData","treenodes","groupedBool","lengthBool","sidebarTest","treeSvg","gTest","updateTree","treeData","getLeaves","stepDown","ids","branchPoint","array","collapseTree","attrDraw","assignPosition","position","positionArray","child","branchCount","findDepth","descendants","parent","notleaves","circ","branchNodes","triangle","uncollapseSub","raise","toolbarControl","toolbar","pathView","viewButton","togglePathView","scrunchButton","toggleScrunch","discreteViewButton","discretePredictedGroups","dropOptions","savedSelected","then","edgeSource","leafChar2","matchedLeaves","matchedEdges","unique","self","entries","en","t0","t1","t2","t3","t4","awesomeness","island","SVL","ecomorph","PCIII_padwidth_vs_tail"],"mappings":"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","file":"js/app.6901e7ae.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/Evo-Bio-Design-Study/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([140,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import * as d3 from 'd3';\n\nexport async function loadData(readFunction, fileString, type){\n    let data = await readFunction(fileString);\n    data.type = String(type);\n    return data;\n}\n\n\n","import * as d3 from \"d3\";\n\n\nexport function calculateScales(calculatedAtt, colorKeeper){\n    return Object.keys(calculatedAtt).map((d, i)=> {\n       \n        if(calculatedAtt[d].type == 'continuous'){\n            let max = d3.max(calculatedAtt[d].rows.map(m=> m.upperCI95));\n            let min = d3.min(calculatedAtt[d].rows.map(m=> m.lowerCI95));\n            let mean = d3.mean(calculatedAtt[d].rows.map(m=> m.realVal));\n            \n            return {\n                'field': d, \n                'type':'continuous',\n                'max': max, \n                'min':  min,\n                'yScale': d3.scaleLinear().range([0, 43]).domain([min, max]).clamp(true),\n                'satScale': d3.scaleLinear().range([0, .9]).domain([min, max]),\n                'colorScale': d3.scaleLinear().range([colorKeeper[i][0], '#f23929']).domain([min, max]),\n                'catColor': colorKeeper[i][0],\n            };\n        }else{\n            let scaleCat = calculatedAtt[d].fields.filter(f=> f!= 'nodeLabels');\n            return { \n                'field': d,\n                'type':'discrete',\n                'stateColors': scaleCat.map((sc, i)=> {\n                    return {'state': sc, 'color': colorKeeper[i][0]};\n                }),\n                'catColor': colorKeeper[i][0],\n                'scales': scaleCat.map(sc=> {\n                let scaleName = sc;\n               \n                let max = 1;\n                let min = 0;\n                return {\n                    'field': d, \n                    'scaleName': scaleName,\n                    'max': max, \n                    'min':  min,\n                    'yScale': d3.scaleLinear().range([45, 0]).domain([min, max]),\n                };\n                \n            }) };\n        }\n    });\n}\n\nexport function matchLeaves(labels, leaves, leafChar, calculatedScales){\n\n        ////MATCHING LABELSS TO THE STUFF/////\n    let  mappedLeafLabels = labels.rows.map(m=> {\n        let label = m.x;\n        return label;\n    });\n\n    return leaves.map((leaf, i)=> {\n      \n        leaf.label = mappedLeafLabels[i];\n\n        //let leafCharIndex = leafChar.rows.map(m=> m[\"\"]);\n      \n        let leafCharIndex = leafChar.rows[0][\"\"] ? leafChar.rows.map(m=> m[\"\"]) : leafChar.rows.map(m=> m[\"species\"]);\n  \n        leaf.node = leaf.V2;\n        let keys = calculatedScales.map(m=> m.field);\n        let attr = {};\n         \n        let chosenOne = leafChar.rows[leafCharIndex.indexOf(leaf.label)];\n \n        keys.forEach((k)=> {\n             let scaleOb = calculatedScales.filter(f=> f.field == k)[0];\n            \n             if(scaleOb.type === 'discrete'){\n                 let thisScale = scaleOb.scales.filter(f=> f.scaleName == chosenOne[k])[0].yScale;\n                 let states = scaleOb.scales.map(m=> m.scaleName).map(state=> {\n                     let value = (state === chosenOne[k])? 1 : 0;\n                    // return {'state': state,  scaleVal: thisScale(value), realVal: value};\n                     return {'state': state, realVal: value};\n                 });\n                 //let states = {'state': leafChar.rows[i][k],  scaleVal: thisScale(1), realVal: 1}\n                 attr[k] = {'states': states, 'label': k, 'type': scaleOb.type, leaf: true};\n             }else if(scaleOb.type === 'continuous'){\n                 let scale = scaleOb.yScale;\n                 //attr[k] = {'scaleVal': scale(chosenOne[k]), 'scaledHigh': 0, 'scaledLow': 0, 'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n                 attr[k] = {'realVal': chosenOne[k], 'type': scaleOb.type, leaf: true};\n \n             }else{\n                 attr[k] = 'error in leaf matching';\n             }\n         });\n\n         leaf.clade = chosenOne.clade;\n         leaf.attributes = attr;\n         leaf.leaf = true;\n     \n         return leaf;\n     });\n}\n\nexport function matchEdges(edges, edgeLen, calculatedAtt, calculatedScales){\n    return edges.rows.map((edge, i)=> {\n        let attrKeys = Object.keys(calculatedAtt);\n        let index = calculatedAtt[attrKeys[0]].rows.map(m=> m['nodeLabels']).indexOf(edge.V2);\n        edge.edgeLength = edgeLen.rows[i].x;\n        edge.node = edge.V2;\n        if(index > -1){ \n            attrKeys.forEach(attr=> {\n                if(calculatedAtt[attr].type == 'continuous'){\n                    let scale = calculatedScales.filter(f=> f.field == attr)[0].yScale;\n                    let res = calculatedAtt[attr].rows[index];\n                   // res.scaleVal = scale(res.estimate);\n                   // res.scaledLow = scale(res.lowerCI95);\n                    //res.scaledHigh = scale(res.upperCI95);\n                    res.realVal = res.estimate;\n                    res.type = 'continuous';\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = res;\n                }else{\n                    let scales = calculatedScales.filter(f=> f.field == attr)[0].scales;\n                    let row = calculatedAtt[attr].rows[index];\n                    let states = scales.map(s=> {\n                       // return {'state': s.scaleName,  scaleVal: s.yScale(row[s.scaleName]), realVal: row[s.scaleName]};\n                        return {'state': s.scaleName, realVal: row[s.scaleName]};\n                    });\n                    edge.attributes = (edge.attributes != undefined)? edge.attributes : {};\n                    edge.attributes[attr] = {'states':states, 'type': 'discrete'};\n                }\n            });\n        }\n        return edge;\n    });\n\n}\n\nexport function normPaths(paths, calculatedAtt, calculatedScales){\n    paths.forEach((p, i)=> {\n        p[0].attributes = {};\n        Object.keys(calculatedAtt).map(att=> { \n            if(calculatedAtt[att].type == 'continuous'){\n                let root = calculatedAtt[att].rows.filter(f=> (f.nodeLabels == p[0].node) || (f.nodeLabels == ('node ' + p[0].node)))[0];\n                p[0].attributes[att] = {};\n                \n                let scale = calculatedScales.filter(f=> f.field == att)[0].yScale;\n            \n                p[0].attributes[att].realVal = root.estimate;\n                p[0].attributes[att].upperCI95 = root.upperCI95;\n                p[0].attributes[att].lowerCI95 = root.lowerCI95;\n                p[0].attributes[att].scale = scale;\n                p[0].attributes[att].type = 'continuous';\n            }else if(calculatedAtt[att].type == 'discrete'){\n                let root = calculatedAtt[att].rows.filter(f=> f.nodeLabels == p[0].node)[0];\n                let scales = calculatedScales.filter(f=> f.field == att)[0].scales;\n                let rootAttr = scales.map(s=> {\n                    //return {'state': s.scaleName,  scaleVal: s.yScale(root[s.scaleName]), realVal: root[s.scaleName]};\n                    return {'state': s.scaleName, realVal: root[s.scaleName]};\n                });\n                p[0].attributes[att] = {'states':rootAttr, 'type': 'discrete'};\n               \n            }else{\n                console.error('type not found');\n            }\n        });\n    });\n    \n    let maxBranch = d3.max(paths.map(r=> r.length));\n\n    //SCALES for X, Y /////\n    let xScale = d3.scaleLinear().range([0, 1000]).clamp(true);\n \n    let normedPaths = paths.map((p, i)=> {\n        p.xScale = xScale.domain([0, maxBranch - 1]);\n     \n        let leafIndex = p.length - 1;\n        let lengths = p.map(l=> l.edgeLength);\n        let prevStep = 0;\n        return p.map((m, j)=> {\n            let node = Object.assign({}, m);\n            //INTEGRATE THE DISTNACES HERE WHEN THEY WORK\n            let step = node.edgeLength + prevStep;\n            node.edgeMove = (j < leafIndex) ? step : 1;\n            prevStep = prevStep + node.edgeLength;\n         \n            node.move = (j < leafIndex) ? p.xScale(j) : p.xScale(maxBranch - 1);\n        \n            return node;\n        });\n    });\n\n    return normedPaths;\n}\n\nexport function filterKeeper(){\n\n    this.filterArray = new Array();\n    this.attributeFilter = false;\n\n    this.addFilter = function(filter){\n        this.filterArray.push(filter);\n        return this.filterArray;\n    };\n    this.removeFilter = function(index){\n        this.filterArray = this.filterArray.filter((f, i)=> i != index);\n        return this.filterArray;\n    };\n}\n\nexport function formatAttributeData(pathData, scales, filterArray){\n\n    let keys = (filterArray == null)? Object.keys(pathData[0][0].attributes): filterArray;\n   \n    let newData = pathData.map(path=> {\n        return keys.map((key)=> {\n            return path.map((m)=> {\n                let speciesLabel = path[path.length - 1].label;\n                if(m.attributes[key].type === 'continuous'){\n                    m.attributes[key].species = speciesLabel;\n                    m.attributes[key].color = scales.filter(f=> f.field === key)[0].catColor;\n                    m.attributes[key].move = m.move;\n                    m.attributes[key].node = m.node;\n                    m.attributes[key].edgeMove = m.edgeMove;\n                    m.attributes[key].label = key;\n                    m.attributes[key].yScale = scales.filter(s=> s.field === key)[0].yScale;\n                    m.attributes[key].satScale = scales.filter(s=> s.field === key)[0].satScale;\n                    m.attributes[key].colorScale = scales.filter(s=> s.field === key)[0].colorScale;\n                    return m.attributes[key];\n                }else if(m.attributes[key].type === 'discrete'){\n                    if(m.leaf){\n                        let state = m.attributes[key];\n                        state.species = speciesLabel;\n                        state.winState = m.attributes[key].states.filter(f=> f.realVal === 1)[0].state;\n                        state.color = scales.filter(f=> f.field === key)[0].stateColors.filter(f=> f.state === state.winState)[0].color;\n                        state.move = m.move;\n                        state.node = m.node;\n                        state.edgeMove = m.edgeMove;\n                        state.attrLabel = key;\n                        return state;\n                    }else{\n                        let states = m.attributes[key].states ? m.attributes[key].states : m.attributes[key];//.filter(f => f.state != undefined);\n                        return states.map((st, j)=> {\n                            st.color = scales.filter(f=> f.field === key)[0].stateColors.filter(f=> f.state === st.state)[0].color;\n                            st.move = m.move;\n                            st.node = m.node;\n                            st.edgeMove = m.edgeMove;\n                            st.attrLabel = key;\n                            st.species = speciesLabel;\n                            return st;\n                        });\n                    }\n             \n                }else{\n                    console.error('attribute type not found');\n                }\n            });\n        });\n    });\n    return newData;\n}","/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {array of leaf nodes in graph} leafArray \n * @param {string for property} source\n * @param {string for property} target  \n */\nexport function allPaths(edgeArray, leafArray, source, target){\n    return leafArray.map(le=> getPath(edgeArray, le, [le], source, target));\n}\n\nexport function getNested(node, edgeArray){\n    node.children = edgeArray.filter(f=> String(f.V1) === String(node.node));\n    node.name = String(node.node);\n    if(node.children.length > 0){\n        node.children.forEach(c=> getNested(c, edgeArray));\n    }else{\n        return node;\n    }\n    return node;\n}\n\nexport function calculateMovingAverage(data, i) {\n\n    if (movingAverage === 0) {\n        return data[i][yValue];\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        sum += x;\n    }\n\n    return sum / count;\n};\n\nexport function calculateMovingStandardDeviation(data, i, avg) {\n\n    if (movingAverage === 0) {\n        return 0;\n    }\n\n    var count = Math.min(movingAverage, i + 1),\n        first = i + 1 - count;\n\n    var sum = 0;\n    for (var index = first; index <= i; ++index) {\n        var x = data[index][yValue];\n        var dx = x - avg;\n        sum += (dx * dx);\n    }\n\n    var variance = sum / count;\n    return Math.sqrt(variance);\n};\n\n/**\n * \n * @param {array of all graph edges} edgeArray \n * @param {one row of the leaf array} leaf \n * @param {array that holds the constructed path} pathKeeper \n * @param {string for source header} source (V1)\n * @param {string for target header} target (V2)\n */\nexport function getPath(edgeArray, leaf, pathKeeper, source, target){\n    let path = edgeArray.filter(ed=> {\n        return ed[target] === leaf[source];\n    });\n    if(path.length > 0){\n        pathKeeper.push(path[0]);\n        return getPath(edgeArray, path[0], pathKeeper, source, target);\n    }else{\n        pathKeeper.push({'root': true, 'node': leaf[source], 'edgeLength': 0.0});\n        return pathKeeper.reverse();\n    }\n}\n/**\n * \n * @param {*} pathArray \n * @param {*} nodes \n * @param {*} arrayOfArray \n * @param {*} nameArray \n * @param {*} depth \n */\nexport function pullPath(pathArray, nodes, arrayOfArray, nameArray, depth){\n    nodes.forEach((node, i)=> {\n        node.depth = depth;\n        node.id = depth + '.' + i;\n        if(notEmpty(node.children)){\n            pathArray.push(node);\n            pullPath([...pathArray], node.children, arrayOfArray, nameArray, depth+1);\n        }else{\n            nameArray.push(node.node_data['node name']);\n            node.flag = true;\n            arrayOfArray.push([...pathArray, node]);\n        }\n    });\n    return arrayOfArray;\n}\n\nfunction notEmpty(childArray){\n    if(childArray == undefined){\n        return false;\n    }else if(childArray.length == 0){\n        return false;\n    }else{\n        return true;\n    }\n}\n","import '../styles/index.scss';\nimport {formatAttributeData} from './dataFormat';\nimport * as d3 from \"d3\";\nimport {filterMaster} from './filterComponent';\nimport {dataMaster} from './index';\n\nexport function drawBranchPointDistribution(data, svg){\n\n    let branchBar = svg.append('g').classed('branch-bar', true).attr('transform', 'translate(10, 10)');\n    branchBar.append('rect').classed('point-dis-rect', true).attr('height', 25).attr('x', -10).attr('y', -10).attr('fill', '#fff');\n\n    branchBar.append('line').attr('y1', 2).attr('y2', 2).attr('x1', '100').attr('x2', 890).attr('stroke', 'gray').attr('stroke-width', .25)\n    branchBar.append('text').text('Root').attr('transform', 'translate(70, 7)');\n    let leafLabel = branchBar.append('g').classed('leaf-label', true).attr('transform', 'translate(950, 7)');\n    leafLabel.append('text').text('Leaves');\n\n    let nodeLengthArray = [];\n    let nodeDuplicateCheck = []\n\n    data.map(path=> {\n        path.filter(n=> n.leaf != true).map(node=> {\n            if(nodeDuplicateCheck.indexOf(node.node) == -1){\n                nodeDuplicateCheck.push(node.node);\n                nodeLengthArray.push({'node': node.node, 'eMove': node.edgeMove });\n            }\n        })\n    });\n\n    let bPointScale = d3.scaleLinear().domain([0, 1]).range([0, 795]);\n    let pointGroups = branchBar.selectAll('g.branch-points').data(nodeLengthArray).join('g').attr('class', (d, i)=> d.node).classed('branch-points', true);\n    pointGroups.attr('transform', (d, i) => 'translate('+(105 + bPointScale(d.eMove))+', 0)');\n    pointGroups.append('circle').attr('r', 5).attr('fill', \"rgba(123, 141, 153, 0.5)\");\n\n    return branchBar;\n}\n\nexport function groupDistributions(pathData, mainDiv, scales, moveMetric){\n\n   \n\n    let clades = Array.from(new Set(pathData.map(path=> path.filter(f=> f.leaf === true)[0].clade === \"\" ? \"Anolis\" : \"Norops\")));\n \n    let pathGroups = clades.map(clade => {\n        let group = pathData.filter(path => {\n         path[path.length - 1].clade === \"Norops\" ? path[path.length - 1].clade = \"Norops\" : path[path.length - 1].clade = \"Anolis\" ; \n         return path[path.length - 1].clade === clade});\n        return {'label': clade, 'paths': group }\n    });\n \n  \n\n    let groupDivs = mainDiv.selectAll('.group-div').data(pathGroups).join('div').classed('group-div', true);\n\n    groupDivs.each((d, i, n)=> {\n        let group = d3.select(n[i]);\n        group.style('text-align', 'center');\n        group.append('text').text(d.label);\n        group.append('text').text(\" Shown:\" + d.paths.length);\n        renderDistibutions(d.paths, d3.select(n[i]), scales, moveMetric);\n    });\n\n    \n}\n\nexport function renderDistibutions(pathData, mainDiv, scales, moveMetric){\n    \n  \n\n    let observedWidth = 200;\n    let predictedWidth = 800;\n    let height = 90;\n    let margin = 20;\n\n    let attrHide = filterMaster.filter(f=> f.type === 'hide-attribute').map(m=> m.attribute);\n    let keys = Object.keys(pathData[0][0].attributes).filter(f=> attrHide.indexOf(f) === -1);\n    let newNormed = [...pathData];\n    let keysToHide = attrHide.length > 0 ? scales.filter(f=> attrHide.indexOf(f.field) === -1).map(m=> m.field) : null;\n\n    formatAttributeData(newNormed, scales, keysToHide);\n\n    let maxBranch = d3.max(newNormed.map(p=> p.length)) - 1;\n    let medBranchLength = d3.median(newNormed.map(p=> p.length));\n\n    let normBins = new Array(medBranchLength).fill().map((m, i)=> {\n        let step = 1 / medBranchLength;\n        let base = (i * step);\n        let top = ((i + 1)* step);\n        return {'base': base, 'top': top, 'binI': i }\n    });\n   \n    let internalNodes = newNormed.map(path => path.filter(node=> node.leaf != true));\n    let leafNodes = newNormed.flatMap(path => path.filter(node=> node.leaf === true));\n\n    normBins.map((n, i)=> {\n        let edges = internalNodes.flatMap(path => path.filter(node=> {\n            if(i === 0){\n                return node.edgeLength === 0;\n            }else{\n                return node.edgeMove > n.base && node.edgeMove <= n.top;\n            }\n        } ));\n        n.data = edges;\n        return n;\n    });\n\n    let sortedBins = keys.map(key=> {\n        let scale = scales.filter(f=> f.field === key)[0];\n        let mapNorm = normBins.map(bin => {\n\n            if(bin.data.length > 0){\n                bin.fData = bin.data.map(d=> {\n                    return d.attributes[key];\n                })\n            }else{\n                bin.fData = [];\n            }\n            return {'data': bin.fData, 'range': [bin.base, bin.top], 'index': bin.binI, 'key': key };\n        });\n\n        let leafAttr = leafNodes.map(m=> m.attributes[key]);\n        let leafData = {'data': leafAttr}\n   \n        if(scale.type === 'continuous'){\n         \n           // let max = d3.max(mapNorm.flatMap(m=> m.data).map(v=> v.realVal));\n           // let min = d3.min(mapNorm.flatMap(m=> m.data).map(v=> v.realVal));\n           \n            let x = d3.scaleLinear().domain([scale.min, scale.max]).range([0, height]);\n    \n            let histogram = d3.histogram()\n            .value(function(d) { return d.realVal; })  \n            .domain(x.domain())  \n            .thresholds(x.ticks(20)); \n  \n            mapNorm.forEach(n=> {\n                n.type = scale.type;\n                n.bins = histogram(n.data);\n                n.domain = [scale.max, scale.min];\n                return n;\n            });\n\n            //Histogram for observed////\n            let maxO = d3.max(leafAttr.flatMap(v=> v.realVal));\n            let minO = d3.min(leafAttr.flatMap(v=> v.realVal));\n            let xO = d3.scaleLinear().domain([minO, maxO]).range([0, height])\n\n            let histogramO = d3.histogram()\n            .value(function(d) { return d.realVal; })  \n            .domain(xO.domain())  \n            .thresholds(xO.ticks(20)); \n\n            leafData.bins = histogramO(leafAttr);\n\n            let newK = {'key': key, 'branches': [...mapNorm], 'type': scale.type, 'leafData': leafData}\n            return newK;\n\n        }else{\n\n            let states = leafAttr[0].states;\n            mapNorm.bins = null\n            leafData.bins = states.map(s=> leafAttr.filter(f=> f.winState === s.state));\n            let x = d3.scaleLinear().domain([0, 1]).range([0, height]);\n            \n            mapNorm.map(n=> {\n                n.type = scale.type;\n                let colors = scale.stateColors;\n                n.bins = states.map(state=> {\n                    let color = colors.filter(f=> f.state === state.state);\n                  \n                    let chosen = n.data.flatMap(m=> m.states.filter(f=> f.state === state.state)).map(v=> v.realVal);\n                    let average = d3.mean(chosen);\n                    let stDev = d3.deviation(chosen);\n                    return {'state': state.state, 'average': average, 'stDev': stDev, 'stUp': average + stDev, 'stDown': average - stDev, 'color': color[0].color, 'range': n.range }\n                });\n                \n                return n;\n            });\n\n            let test = states.map(stat=> {\n                let key = stat.state;\n                return mapNorm.flatMap(m=> {\n                    return m.bins.filter(f=> f.state === key);\n                });\n            });\n\n            let newK = {'key': key, 'branches': [...mapNorm], 'type': scale.type, 'leafData': leafData, 'states': test}\n            return newK;\n        }\n    });\n\n    ///////RENDERING//////////\n    \n    let branchScale = d3.scaleLinear().domain([0, medBranchLength]).range([0, 780]);\n\n    //let dataCount = mainDiv.append('div').classed('species-count', true);\n    //dataCount.append('text').text(\"Shown: \"+ pathData.length + \" /\"+ dataMaster[0].length);\n\n    let svg = mainDiv.append('svg');\n    svg.attr('id', 'main-summary-view');\n    svg.attr('height', (keys.length * (height + 25)));\n\n    let branchBar = drawBranchPointDistribution(newNormed, svg);\n    let pointGroups = branchBar.selectAll('g.branch-points');\n  \n    let wrap = svg.append('g').classed('summary-wrapper', true);\n    wrap.attr('transform', 'translate(10, 50)');\n\n    let binnedWrap = wrap.selectAll('.attr-wrap').data(sortedBins).join('g').attr('class', d=> d.key + ' attr-wrap');\n    binnedWrap.attr('transform', (d, i)=>  'translate(0,'+(i * (height + 5))+')');\n    \n    let label = binnedWrap.append('text').text(d=> d.key).attr('y', 40).attr('x', 80).style('text-anchor', 'end');\n\n    let predictedWrap = binnedWrap.append('g').classed('predicted', true);\n\n    let pathGroup = predictedWrap.append('g').classed('path-wrapper', true);\n\n    let branchGroup = predictedWrap.selectAll('g.branch-bin').data(d=> d.branches).join('g').classed('branch-bin', true);\n    branchGroup.attr('transform', (d, i)=> 'translate('+(100 + branchScale(i))+', 0)');\n\n    let continDist = branchGroup.filter(f=> f.type === 'continuous');\n\n    continDist.on('mouseover', (d, i, node)=> {\n        let list = d.data.map(m=> m.nodeLabels);\n        let selected = pointGroups.filter(p=> list.indexOf(p.node) > -1).classed('selected', true);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> list.indexOf(f.data.node) > 0).classed('selected-branch', true);\n        let y = d3.scaleLinear().domain(d.domain).range([0, height])\n        let axis = d3.select(node[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n    }).on('mouseout', (d, i, node)=> {\n        d3.selectAll(\".branch-points.selected\").classed('selected', false);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        d3.select(node[i]).select('.y-axis').remove();\n    });\n\n    var lineGen = d3.area()\n    .curve(d3.curveCardinal)\n    .x((d, i, n)=> {\n        let y = d3.scaleLinear().domain([0, n.length - 1]).range([0, height]).clamp(true);\n        return y(i); \n    })\n    .y0(d=> {\n        return 0;\n    })\n    .y1(d=> {\n        let dat = Object.keys(d).length - 1\n        let x = d3.scaleLinear().domain([0, 50]).range([0, 80]).clamp(true);\n        return x(dat); \n    });\n\n    continDist.each((d, i, nodes)=> {\n        let distrib = d3.select(nodes[i]).selectAll('g').data([d.bins]).join('g').classed('distribution', true);\n        distrib.attr('transform', 'translate(11, '+height+') rotate(-90)');\n        let path = distrib.append('path').attr('d', lineGen);\n        path.attr(\"fill\", \"rgba(133, 193, 233, .4)\")\n        .style('stroke', \"rgba(133, 193, 233, .9)\");\n    });\n\n    let contRect = continDist.append('rect').attr('height', height).attr('width', 10).style('fill', 'none').style('stroke', 'gray');\n\n    let rangeRect = continDist.selectAll('rect.range').data(d=> {\n        let newData = d.data.map(m=> {\n            m.range = d.range;\n            return m;\n        })\n        return newData}).join('rect').classed('range', true);\n\n    rangeRect.attr('width', 10);\n    rangeRect.attr('height', (d, i)=> {\n        if(d.yScale != undefined){\n            let newy = d.yScale;\n            newy.range([80, 0]);\n            return newy(d.lowerCI95) - newy(d.upperCI95)\n        }else{\n            return 0;\n        }\n    }).attr('transform', (d, i) => {\n        let newy = d.yScale;\n        newy.range([80, 0]);\n        return 'translate(0,'+newy(d.upperCI95)+')'\n    });\n\n    rangeRect.attr('fill', \"rgba(133, 193, 233, .05)\");\n\n    let avRect = continDist.append('rect').attr('width', 10).attr('height', (d, i)=> {\n        if(d.data[0] != undefined){\n            return 3;\n        }else{\n            return 0;\n        }\n    });\n\n    avRect.attr('transform', (d, i) => {\n        if(d.data[0] != undefined){\n            let newy = d.data[0].yScale;\n            newy.range([height, 0]);\n            let mean = d3.mean(d.data.map(m=> m.realVal));\n            return 'translate(0,'+newy(mean)+')';\n        }else{\n            return 'translate(0,0)';\n        }\n    }).attr('fill', '#004573');\n\n    let discreteDist = branchGroup.filter(f=> f.type === 'discrete');\n    let discreteLine = discreteDist.append('line').attr('x0', 2).attr('x1', 2).attr('y0', 0).attr('y1', height).attr('stroke', 'gray').attr('stroke-width', 0.5);\n    let hoverRect = discreteDist.append('rect').attr('height', height).attr('width', 10).attr('opacity', 0);\n    discreteDist.on('mouseover', (d, i, n)=> {\n        let y = d3.scaleLinear().domain([1, 0]).range([0, height]);\n        d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n        let selected = pointGroups.filter(f=> f.eMove >= d.range[0] && f.eMove < d.range[1]).classed('selected', true);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n      \n        treeNode.filter(node=> node.data.combEdge >= d.range[0] && node.data.combEdge < d.range[1]).classed('selected-branch', true);\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).select('.y-axis').remove();\n        d3.selectAll(\".branch-points.selected\").classed('selected', false);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n    })\n\n    let discreteBinWrap = predictedWrap.filter(f=> f.type === 'discrete');\n\n    let stateGroups = discreteBinWrap.selectAll('.path-wrapper').selectAll('g.state').data(d=> d.states).join('g').classed('state', true);\n\n    stateGroups.append('path').attr('d', (p, i)=> {\n        var lineGenD = d3.area()\n        .curve(d3.curveCardinal)\n        .x((d, i)=> {\n            let y = d3.scaleLinear().domain([0, 9]).range([0, predictedWidth + 100]);\n            return y(i); \n        })\n        .y0(d=> {\n            let x = d3.scaleLinear().domain([0, 1]).range([80, 0]).clamp(true);\n            return x(d.stDown);\n        })\n        .y1(d=> {\n            let x = d3.scaleLinear().domain([0, 1]).range([80, 0]).clamp(true);\n            return x(d.stUp); \n        });\n        return lineGenD(p);\n\n    }).attr('transform', 'translate(100, 10)').attr('fill', (d, i)=> {\n        return d[0] ? d[0].color : '#fff';\n    }).attr('opacity', 0.3);\n\n    stateGroups.append('path').attr('d', (p, i)=> {\n        var lineGen = d3.line()\n        .curve(d3.curveCardinal)\n        .x((d, i)=> {\n            let y = d3.scaleLinear().domain([0, 9]).range([0, predictedWidth + 100]);\n            return y(i); \n        })\n        .y(d=> {\n            let x = d3.scaleLinear().domain([0, 1]).range([80, 0]).clamp(true);\n            return x(d.average); \n        });\n        return lineGen(p);\n\n    }).attr('transform', 'translate(100, 10)').attr('fill', 'none').attr('stroke', (d, i)=> {\n        return d[0] ? d[0].color : '#fff';\n    });\n\n    ////OBSERVED CONTIUOUS/////\n\n    let observedWrap = binnedWrap.append('g').classed('observed', true);\n    observedWrap.attr('transform', 'translate('+ (predictedWidth + 150) +', 0)')\n\n    let contOb = observedWrap.filter(f=> f.type === 'continuous');\n\n    let contBars = contOb.selectAll('g.ob-bars').data(d=> {\n        return d.leafData.bins}).join('g').classed('ob-bars', true);\n\n    let cRects = contBars.append('rect').attr('width', (d, i, n)=> {\n        let width = observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i)=> {\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(height - margin), 0])\n        return y(Object.keys(d).length - 2)\n    }).attr('fill', 'rgba(133, 193, 233, .5)');\n\n    contBars.attr('transform', (d, i, n)=> {\n        let movex = observedWidth / n.length;\n        let y = d3.scaleLinear().domain([0, Object.keys(d).length]).range([(height - margin), 0])\n        let movey = height - y(Object.keys(d).length - 2);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    contOb.each((d, i, nodes)=> {\n        let xvalues = d.leafData.data.map(m=> m.realVal);\n        let x = d3.scaleLinear().domain([d3.min(xvalues), d3.max(xvalues)]).range([0, observedWidth])\n        let y = d3.scaleLinear().domain([0, d3.max(d.leafData.bins.map(b=> Object.keys(b).length)) - 2]).range([(height - margin), 0]);\n        d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(x)).attr('transform', 'translate(0, '+height+')');\n        d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(4)).attr('transform', 'translate(0, '+margin+')');\n    });\n    \n////Observed Discrete////\n    let discOb =  observedWrap.filter(f=> f.type === 'discrete');\n    let discBars = discOb.selectAll('g.ob-bars').data(d=> {\n        return d.leafData.bins}).join('g').classed('ob-bars', true);\n    let dRects = discBars.append('rect').attr('width', (d, i, n)=> {\n        let width = observedWidth / n.length;\n        return width;\n    }).attr('height', (d, i, n)=> {\n        let y = d3.scaleLinear().domain([0, 100]).range([(height -margin), 0])\n        return y(d.length)\n    }).attr('fill', (d, i) => {\n        return d[0] != undefined ? d[0].color : '#fff';\n    }).attr('opacity', 0.3);\n\n    discBars.attr('transform', (d, i, n)=> {\n        let movex = observedWidth / n.length;\n        let y = d3.scaleLinear().domain([0, 100]).range([(height - margin), 0])\n        let movey = (height) - y(d.length);\n        return 'translate('+(movex * i)+', '+movey+')'});\n\n    dRects.on('mouseover', (d, i, n)=> {\n        let state = d3.select('g.'+d[0].label).selectAll('g.state');\n        state.filter(f=> f[0].state === d[0].winState).attr('opacity', 0.8);\n        state.filter(f=> f[0].state != d[0].winState).attr('opacity', 0.1);\n        d3.select(n[i]).attr('opacity', 0.9);\n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).attr('opacity', 0.3);\n        let state = d3.select('g.'+d[0].label).selectAll('g.state').attr('opacity', 0.6);\n     \n    })\n\n    discOb.each((d, i, nodes)=> {\n            let labels = d.leafData.bins.map(b=> {\n                return b[0] != undefined ? b[0].winState : '';\n                })\n            let xPoint = d3.scalePoint().domain(labels).range([0, observedWidth]).padding(.6)\n            let y = d3.scaleLinear().domain([0, 100]).range([(height - margin), 0]);\n            d3.select(nodes[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5)).attr('transform', 'translate(0, '+margin+')');\n            d3.select(nodes[i]).append('g').classed('x-axis', true).call(d3.axisBottom(xPoint)).attr('transform', 'translate(0, '+height+')');\n    });\n\n\n}\n","import * as d3 from \"d3\";\nimport { renderDistibutions, groupDistributions } from './distributionView';\nimport {drawPathsAndAttributes} from './renderPathView';\nimport { getLatestData } from \"./filterComponent\";\n\nexport let groupedView = false;\n\nexport function updateMainView(scales, moveMetric){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n\n    main.selectAll('*').remove();\n\n    if(d3.select('#view-toggle').text() === 'View Paths'){\n        renderDistibutions(data, main, scales, moveMetric);\n        document.getElementById(\"scrunch\").disabled = true;\n    }else{\n        drawPathsAndAttributes(data, main, scales, moveMetric);\n        document.getElementById(\"scrunch\").disabled = false;\n    }\n\n}\n\nexport function initialViewLoad(scales, moveMetric){\n\n    let main = d3.select('#main');\n    let data = getLatestData();\n\n    main.selectAll('*').remove();\n\n    if(data.length > 50){\n        //renderDistibutions(data, main, scales, moveMetric);\n        groupDistributions(data, main, scales, moveMetric);\n        d3.select('#view-toggle').text('View Paths');\n        document.getElementById(\"scrunch\").disabled = true;\n    }else{\n        drawPathsAndAttributes(data, main, scales, moveMetric);\n        d3.select('#view-toggle').text('View Summary');\n        document.getElementById(\"scrunch\").disabled = false;\n    }\n\n}","import '../styles/index.scss';\n\nimport * as d3 from \"d3\";\nimport {dataMaster} from './index';\nimport { updateMainView } from './viewControl';\n\nexport let filterMaster = [];\n\nexport function removeFilter(filterId, scales){\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n    let filterIndex = dataFilters.map(f=> f.filterId).indexOf(filterId);\n\n    if(filterIndex != dataFilters.length - 1){\n   \n        let baseData = filterIndex === 0? dataMaster[0] : dataFilters[filterIndex - 1].data;\n    \n        let testData = [...baseData];\n\n        let filterToolbar = d3.select(\"#toolbar\");\n\n        let badges = filterToolbar.selectAll('.filter-tag').remove();\n  \n        for(let i = filterIndex + 1; i < dataFilters.length; i ++){\n       \n            let fun = dataFilters[i].filterFunction;\n            if(dataFilters[i].attributeType === 'continuous'){\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].predictedFilter, dataFilters[i].observedFilter);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'c-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }else{//discrete\n                let newTestData = fun(testData, dataFilters[i].selectedOption, dataFilters[i].fromState, dataFilters[i].toState);\n                dataFilters[i].data = [...newTestData];\n                dataFilters[i].filterId = 'd-'+ i;\n                //// Re adding in buttons ////\n                addFilterTag(dataFilters[i], scales);\n                testData = newTestData;\n            }\n        }\n    }\n    let newFilterMaster = filterMaster.filter(f=> f.filterId != filterId);\n\n    filterMaster = newFilterMaster;\n}\n\nexport function addFilter(filterType, attType, filterId, filFunction, oldData, newData, extra){\n    let filterOb = {'filterType': filterType, 'attributeType': attType, 'filterId': filterId, 'filterFunction':filFunction, 'before-data': oldData, 'data': newData}\n    if(extra != null){\n        extra.forEach(ex=> {\n            filterOb[ex[0]] = ex[1];\n        });\n    }\n    filterMaster.push(filterOb);\n    return filterOb;\n}\n\nexport function getLatestData(){\n    let data = filterMaster.length > 0 ? filterMaster[filterMaster.length - 1].data : dataMaster[0];\n    return data;\n}\n\n///NEED TO BREAK THESE OUT INTO SEPARATE FILTERS\nexport function toggleFilters(filterButton, main, moveMetric, scales){\n\n    let filterDiv = d3.select('#filter-tab');\n    let data = getLatestData();\n\n    if(filterDiv.classed('hidden')){\n        filterButton.text('Hide Filters');\n        filterDiv.classed('hidden', false);\n        main.style('padding-top', '200px');\n\n        renderAttToggles(filterDiv, data, main, scales, 'edgeLength');\n        stateFilter(filterDiv, filterButton, data, main, moveMetric, scales);\n        queryFilter(filterDiv, filterButton, data, main, moveMetric, scales);\n\n    }else{\n        filterButton.text('Show Filters');\n        filterDiv.selectAll('*').remove();\n        filterDiv.classed('hidden', true);\n        main.style('padding-top', '0px');\n    }\n}\n\nfunction addFilterTag(data, scales){\n\n    let filterToolbar = d3.select('#toolbar');\n\n    if(data.attributeType === 'continuous'){\n\n        let formater = d3.format(\".2s\");\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        d3.select(button).datum(data);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        let label = button.append('h6').text(data.selectedOption + \"  Predicted: \"+ formater(data.predictedFilter[0]) + \"-\" + formater(data.predictedFilter[1]) + \" Observed: \" + formater(data.observedFilter[0]) + \"-\" + formater(data.observedFilter[1]));\n        let xSpan = label.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            let filterLine = filterMaster.filter(f=> f.filterType === 'data-filter').filter(f=> data.attribute != f.attribute);\n            ////YOU NEED TO CHANGE THIS TO REMOVE FILTER FUNCTION\n            removeFilter(data.filterId, scales);\n            updateMainView(scales, 'edgeLength')\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'discrete'){\n     \n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(data.state[0]);\n        button.append('i').classed('fas fa-arrow-right', true);\n        button.append('h6').text(data.state[1] + '  ');\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView(scales, 'edgeLength')\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }else if(data.attributeType === 'branch'){\n        let button = filterToolbar.append('button').classed('btn btn-info filter-tag', true);\n        let span = button.append('span').classed('badge badge-light', true);\n        span.text(data.data.length);\n        button.append('h6').text(' At Branch: ' + data.nodeId);\n       \n        let xSpan = button.append('i').classed('close fas fa-times', true);\n        xSpan.on('click', ()=> {\n            removeFilter(data.filterId, scales);\n            updateMainView(scales, 'edgeLength')\n            d3.selectAll('.link-not-there').classed('link-not-there', false);\n            d3.selectAll('.node-not-there').classed('node-not-there', false);\n            button.remove();\n        });\n\n    }\n    \n}\nfunction stateFilter(filterDiv, filterButton, normedPaths, main, moveMetric, scales){\n    let keys = ['Select a Trait'].concat(Object.keys(normedPaths[0][0].attributes));\n        let selectWrapper = filterDiv.append('div').classed('filter-wrap', true);\n        selectWrapper.style('width', '200px');\n        selectWrapper.append('h6').text('State Transition:');\n        let attButton = stateChange(selectWrapper, keys, 'attr-select', '');\n\n        let attProps = selectWrapper.append('div').classed('attribute-properties', true);\n\n        attButton.on(\"change\", function(d) {\n            var selectedOption = d3.select(this).property(\"value\");\n            let options = scales.filter(f=> f.field === selectedOption)[0];\n            attProps.selectAll('*').remove();\n\n            if(options.type === \"discrete\"){\n                let optionArray = ['Any'];\n                let optKeys = options.scales.map(s=> s.scaleName);\n                optionArray = optionArray.concat(optKeys);\n                let button1 = stateChange(attProps, optionArray, 'predicted-state', 'From');\n                let button2 = stateChange(attProps, optionArray, 'observed-state', 'To');\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n                    let fromState = button1.node().classList[0];\n                    let toState = button2.node().classList[0];\n\n                      ////GOING TO ADD FILTERING HERE//// NEED TO BREAK INTO ITS OWN THING/////\n                      \n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n              \n                    //let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n                    let data = getLatestData();\n              \n                    let test = discreteFilter(data, selectedOption, fromState, toState);\n\n                    let filId = 'd-'+filterMaster.filter(f=> f.attributeType === 'discrete').length;\n                    let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n                    updateMainView(scales, moveMetric);\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    /////ADD THE FILTER TO THE TOOLBAR////\n                    addFilterTag(filterOb, scales);\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }else{\n                \n                let yScale = d3.scaleLinear().domain([options.min, options.max]).range([60, 0]);\n               \n                let continRanges = attProps.append('svg');\n                continRanges.attr('width', 200).attr('height', 100);\n                let data = [{'label':'Ancestors', 'type': 'predicted'}, {'label':'Leaves', 'type': 'observed'}];\n                let ranges = continRanges.selectAll('.range').data(data).join('g').classed('range', true);\n\n                ranges.attr('transform', (d, i)=> 'translate('+((i*125)+',20)'));\n\n                let brushBars = ranges.append('g');\n                brushBars.attr('transform', 'translate(10, 10)');\n\n                let labels = ranges.append('text').text((d)=> d.label+ ': ');\n                labels.attr('x', 0).attr('y', 0);\n                let wrapperRect = brushBars.append('rect').attr('width', 20).attr('height', 50);\n                wrapperRect.attr('x', 10);\n\n                brushBars.append(\"g\")\n                .attr(\"class\", \"axis axis--y\")\n                .attr(\"transform\", \"translate(10,0)\")\n                .call(d3.axisLeft(yScale).ticks(3));\n                \n                let brushMoved = function(){\n                    var s = d3.event.selection;\n                    if (s == null) {\n                      handle.attr(\"display\", \"none\");\n                    \n                    } else {\n                      var sx = s.map(yScale.invert);\n                    }\n                };\n                let xBrush = d3.brushY().extent([[10,0], [30, 60]]).on(\"end\", brushMoved);\n                let brushGroup = brushBars.append('g').call(xBrush);\n                brushGroup.call(xBrush.move, [0, 60]);\n\n                let submit = attProps.append('button').classed('btn btn-outline-success', true);\n                submit.text('Filter');\n\n                submit.on('click', ()=> {\n\n                    let selections = brushGroup._groups[0].map(m=> m.__brush.selection.map(s=> s[1]));\n                    let predictedFilter = selections[0].map(yScale.invert).sort();\n                    let observedFilter = selections[1].map(yScale.invert).sort();\n                    let lastFilter = filterMaster.filter(f=> f['filterType'] === 'data-filter');\n\n                    let data = lastFilter.length > 0 ? lastFilter[lastFilter.length - 1].data : dataMaster[0];\n\n                    let test = continuousFilter(data, selectedOption, predictedFilter, observedFilter);\n\n                    let filId = 'c-'+filterMaster.filter(f=> f.attributeType === 'continuous').length;\n                    let filterOb = addFilter('data-filter', 'continuous', filId, continuousFilter, [...data], [...test], [['selectedOption', selectedOption], ['predictedFilter', predictedFilter], ['observedFilter', observedFilter]]);\n\n                    updateMainView(scales, moveMetric);\n\n                    /////ADD THE FILTER TO THE TOOLBAR/////\n                    addFilterTag(filterOb, scales);\n\n                    ///DIMMING THE FILTERED OUT NODES//////\n\n                    ////Class Tree Links////\n                    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n                    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n                    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n                    d3.selectAll('.link-not-there').classed('link-not-there', false);\n                    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n                    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingLinks.classed('link-not-there', true);\n\n                    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n                    missingNodes.classed('node-not-there', true);\n\n                    ///END NODE DIMMING///////\n\n                    ////HIDE THE FILTER BAR/////\n                    filterButton.text('Show Filters');\n                    filterDiv.selectAll('*').remove();\n                    filterDiv.classed('hidden', true);\n                    main.style('padding-top', '0px');\n                });\n            }\n         });\n}\nexport function nodeFilter(selectedNode, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path.map(node => node.node).indexOf(selectedNode) > -1;\n    });\n\n    let filId = 'b-'+filterMaster.filter(f=> f.attributeType === 'branch').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'branch', filId, nodeFilter, [...data], [...test], [['nodeId', selectedNode]])\n    addFilterTag(filterOb, scales);\n    updateMainView(scales, 'edgeLength');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\nexport function leafStateFilter(selectedState, scales){\n   \n    let data = getLatestData();\n    let dataFilters = filterMaster.filter(f=> f.filterType === 'data-filter');\n \n    let test = data.filter(path => {\n        return path[path.length - 1].attributes[selectedState.label].winState === selectedState.winState;\n    });\n\n    let filId = 'l-'+filterMaster.filter(f=> f.attributeType === 'leaf').length;\n    //let filterOb = addFilter('data-filter', 'discrete', filId, discreteFilter, [...data], [...test], [['state', [fromState, toState]], ['selectedOption', selectedOption]]);\n\n    let filterOb = addFilter('data-filter', 'leaf', filId, nodeFilter, [...data], [...test], [['leafState', [selectedState.label, selectedState.winState]]])\n    addFilterTag(filterOb, scales);\n    updateMainView(scales, 'edgeLength');\n\n   ////Class Tree Links////\n   let treeLinks  = d3.select('#sidebar').selectAll('.link');\n   let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n   let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n   d3.selectAll('.link-not-there').classed('link-not-there', false);\n   d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n   let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingLinks.classed('link-not-there', true);\n\n   let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n   missingNodes.classed('node-not-there', true);    \n  \n}\n\n\nfunction continuousFilter(data, selectedOption, predicted, observed){\n\n    return data.filter(path=> {\n        let filterArray = path.map(node=> {\n            let numb = node.attributes[selectedOption].realVal;\n            if(node.leaf == true){\n                return numb > observed[0] && numb < observed[1];\n            }else{\n                return numb > predicted[0] && numb < predicted[1];\n            }\n        });\n        return filterArray.indexOf(false) === -1;\n    });\n}\nfunction discreteFilter(data, selectedOption, fromState, toState){\n    if(selectedOption != undefined){\n        return data.filter(path=> {\n            let filterPred = path.filter(f=> f.leaf != true).map(node=> {\n                let states = node.attributes[selectedOption].states;\n                if(fromState === 'Any'){\n                    return true;\n                }else{\n                    return states.filter(st=> st.state === fromState).length > 0 && states.filter(st=> st.state === fromState)[0].realVal > 0.75;\n                }\n            });\n            let filterObs = path.filter(f=> f.leaf === true).map(node=> {\n            let win = node.attributes[selectedOption].winState;\n            if(toState === 'Any'){\n                return true;\n            }else{\n                return win === toState;\n            }\n            });\n            return filterPred.indexOf(true) > -1 && filterObs.indexOf(true) > -1;\n        });\n    }\n}\nfunction queryFilter(filterDiv, filterButton, normedPaths, main, moveMetric, scales){\n\n    let searchDiv = filterDiv.append('div').classed('search-bar-div', true);\n        searchDiv.append('h6').text('Query Filter:');\n        let form = searchDiv.append('form').classed('form-inline', true);\n        let input = form.append('input').classed('form-control mr-sm-2', true);\n        input.attr('type', 'search').attr('placeholder', 'Search by Species').attr('aria-label', 'Search');\n        let searchButton = form.append('button').classed('btn btn-outline-success my-2 my-sm-0', true).attr('type', 'button').append('i').classed(\"fas fa-search\", true);\n        searchButton.on('click', ()=> {\n\n            let queryArray = input.node().value.split(' ').map(m=> m.toLowerCase());\n\n            let test = normedPaths.filter(path=> {\n                let species = path.filter(node=> node.leaf === true)[0].label;\n                return queryArray.indexOf(species) > -1;\n            });\n\n             ////DRAW THE PATHS\n         \n            updateMainView(scales, moveMetric);\n\n            let filterToolbar = d3.select(\"#toolbar\");\n            let button = filterToolbar.append('button').classed('btn btn-info', true);\n            let span = button.append('span').classed('badge badge-light', true);\n            span.text(test.length);\n            button.append('h6').text('Query Filter');\n            let xSpan = button.append('i').classed('close fas fa-times', true);\n            xSpan.on('click', ()=> {\n                updateMainView(scales, moveMetric);\n                button.remove();\n            });\n            d3.select('#main-path-view').style('height', ()=>{\n                return ((test.length * 60) + (Object.keys(test[0][0].attributes).length * 100) + 'px');\n            });\n\n            ////HIDE THE FILTER BAR/////\n            filterButton.text('Show Filters');\n            filterDiv.selectAll('*').remove();\n            filterDiv.classed('hidden', true);\n            main.style('padding-top', '0px');\n        });\n\n}\nfunction renderAttToggles(filterDiv, normedPaths, main, scales, moveMetric){\n\n    ////NEED TO GET RID OF TOGGLE SVG\n    let keys = Object.keys(normedPaths[0][0].attributes);\n    let presentFilters = filterMaster.filter(f=> f.type === 'hide-attribute');\n    let noShow = presentFilters.length > 0 ? presentFilters.map(m=> m.attribute) : [];\n\n    let wrapper = filterDiv.append('div').classed('filter-wrap', true);\n    wrapper.style('width', '150px');\n   \n    let svg = wrapper.append('svg').classed('attr-toggle-svg', true);\n\n   let title = svg.append('text').text('Attributes: ');\n    title.attr('x', 20).attr('y', 10);\n    \n    let labelWrap = svg.append('g').attr('transform', 'translate(20, 25)');\n    let labelGroups = labelWrap.selectAll('g').data(keys).join('g'); \n    \n    labelGroups.attr('transform', (d, i)=> 'translate(0,'+(i* 25)+')');\n\n    let toggle = labelGroups.append('circle').attr('cx', 0).attr('cy', 0);\n    toggle.classed('toggle', true);\n    let shownToggs = toggle.filter(t=> noShow.indexOf(t) === -1);\n   \n    shownToggs.classed('shown', true);\n    shownToggs.style('fill', (d, i)=>{\n        return scales.filter(f=> f.field === d)[0].catColor;\n    });\n\n    toggle.on('click', function(d, i){\n        let togg = d3.select(this);\n        toggleCircle(togg, scales);\n   \n        filterMaster.push({'type':'hide-attribute', 'attribute':d, 'before-data': [...normedPaths]});\n\n        let newKeys = d3.selectAll('.shown');\n        let hideKeys = scales.filter(sc=> newKeys.data().indexOf(sc.field) === -1);\n        let newFilMaster = filterMaster.filter(f=> f.type != 'hide-attribute');\n        hideKeys.forEach(key=> {\n            newFilMaster.push({'type':'hide-attribute', 'attribute':key.field, 'before-data': [...normedPaths], 'data': [...normedPaths]});\n        });\n        filterMaster = newFilMaster;\n        updateMainView(scales, moveMetric)\n    });\n    let labelText = labelGroups.append('text').text(d=> d).style('font-size', 10);\n    labelText.attr('transform', 'translate(10, 4)');  \n    \n}\nfunction stateChange(selectorDiv, keys, selectId, label){\n\n    let dropDownWrapper = selectorDiv.append('div').classed('selector', true);\n    let header = dropDownWrapper.append('h6').text(label);\n    \t// create the drop down menu of cities\n\tlet selectOp = dropDownWrapper\n    .append(\"select\")\n    .attr(\"id\", selectId).attr('class', 'Any');\n    \n    let options = selectOp.selectAll(\"option\")\n    .data(keys).join(\"option\");\n\n    options.text(d=> d).attr(\"value\", d=> d);\n\n    d3.select(\"#\"+selectId).on(\"change\", function(d) {\n       var selectedOption = d3.select(this).property(\"value\");\n       d3.select(this).attr('class', selectedOption);\n    });\n\n    return d3.select('#'+ selectId);\n}\nfunction toggleCircle(circle, scales){\n    if(circle.classed('shown')){\n        circle.classed('shown', false);\n        circle.style('fill', '#fff');\n    }else{\n        circle.classed('shown', true);\n        circle.style('fill', (d, i)=> scales.filter(f=> f.field === d)[0].catColor);\n    }\n}","import * as d3 from \"d3\";\nimport { branchPaths, renderPaths, renderAttributes, drawContAtt, drawDiscreteAtt, drawPathsAndAttributes } from './renderPathView';\nimport { formatAttributeData } from './dataFormat';\nimport { filterMaster } from './filterComponent';\nimport { dataMaster, collapsed, colorKeeper } from './index';\nimport { renderDistibutions } from \"./distributionView\";\n\nexport let selectedPaths = [];\nexport let comparisonKeeper = [];\n\nexport function pathSelected(selectedPath, otherPaths, scales, moveMetric) {\n\n    let selectedDiv = d3.select('div#selected');\n    let main = d3.select('div#main');\n    if (selectedPath === null) {\n\n        selectedPaths = [];\n\n        d3.select('div#selected').selectAll('*').remove();\n        selectedDiv.style('height', 0);\n        d3.select('div#main').style('padding-top', '0px');\n        let main = d3.select('div#main');\n        drawPathsAndAttributes([...otherPaths], main, scales, moveMetric, false);\n\n    } else {\n      \n        selectedPaths = selectedPaths.concat(selectedPath);\n        let commonNodes = renderSelectedView([...selectedPaths], [...otherPaths], selectedDiv, scales, moveMetric);\n        let sortedPaths = sortOtherPaths([...selectedPaths], [...otherPaths], [...commonNodes]);\n        \n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let pathGroups = drawPathsAndAttributes(sortedPaths.map(s => s.data), main, scales, moveMetric, false);\n\n        main.style('padding-top', '250px');\n    }\n}\nfunction getCommonNodes(paths){\n    let maxBranch = d3.max(paths.map(p => p.length));\n    let longestBranch = paths.filter(path => path.length === maxBranch)[0];\n    let startBranch = longestBranch.filter(f=> f.leaf != true);\n    let commonNodeStart = startBranch;\n    //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n    paths.map(path => {\n        commonNodeStart = [...path].filter(f => {\n            return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n    });\n\n    let children = paths.map(path => {\n        path = (path[0].leaf === true) ? path.reverse() : path;\n        let nodeIndex = path.map(p => p.node);\n        let thresh = nodeIndex.indexOf(commonNodeStart[commonNodeStart.length - 1].node);\n        let subset = path.filter((f, i) => i > thresh);\n        return subset;\n    });\n\n    commonNodeStart[commonNodeStart.length - 1].children = children.map((path, i) => {\n        let max = d3.max(path.map(p => p.edgeMove)) - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n        return path.map((chil, j, n) => {\n            chil.parentBase = commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.move = chil.edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            chil.base = (j === 0) ? 0 : n[j - 1].edgeMove - commonNodeStart[commonNodeStart.length - 1].edgeMove;\n            let parentScale = d3.scaleLinear().domain([0, 1]).range([0, 1000])\n            let scaledParentMove = parentScale(commonNodeStart[commonNodeStart.length - 1].edgeMove);\n            chil.xScale = d3.scaleLinear().domain([0, max]).range([0, (1000 - scaledParentMove)]);\n            chil.level = i;\n            return chil;\n        });\n    });\n\n    return commonNodeStart;\n}\nexport function sortOtherPaths(pathData, otherPaths, commonNode) {\n\n    if(pathData.length > 1){\n\n        if(commonNode != null){\n\n            let chosenPath = commonNode.reverse().map(m => m.node);\n            let rankedPaths = otherPaths.map(path => {\n                let step = 0;\n                let test = path.reverse().map((node, i) => {\n                    if (chosenPath.indexOf(node.node));\n                    return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n                }).filter(f => f.indexOf > -1);\n                let distance = (test[0].indexOf + test[0].pathIndex);\n                return { 'data': path.reverse(), 'distance': distance };\n            });\n            let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        \n            return sortedData;\n        }\n        console.error('multiple paths without common node');\n    }else{\n\n        let chosenPath = pathData[0].reverse().map(m => m.node);\n    \n        let rankedPaths = otherPaths.map(path => {\n            let step = 0;\n            let test = path.reverse().map((node, i) => {\n                if (chosenPath.indexOf(node.node));\n                return { 'indexOf': chosenPath.indexOf(node.node), 'pathIndex': i, 'node': node, 'chosen': chosenPath[chosenPath.indexOf(node.node)] };\n            }).filter(f => f.indexOf > -1);\n            let distance = (test[0].indexOf + test[0].pathIndex);\n            return { 'data': path.reverse(), 'distance': distance };\n        });\n        let sortedData = rankedPaths.sort(function(a, b) { return a.distance - b.distance; });\n        return sortedData;\n    }\n\n}\nfunction renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency, moveMetric){\n\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', 'translate(0, 20)')\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data([commonNodeStart]).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n        pathBars.attr('height', (35 + (25 * commonNodeStart[commonNodeStart.length - 1].children.length)));\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales, moveMetric)\n\n        /////////\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(145, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', (d, i) => {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n                return x(d[d.length - 1].edgeMove)\n            })\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        nodeGroups.classed('common-node', true);\n\n        let childNodeWrap = nodeGroups.filter(c => c.children != undefined).selectAll('g.child').data(d => d.children).join('g').classed('child', true);\n\n        let childNodes = childNodeWrap.selectAll('g.node').data(d => d).join('g').classed('node', true)\n        childNodes.attr('transform', (d, i, n) => {\n            return 'translate(' + d.xScale(d.move) + ', ' + (d.level * 20) + ')';\n        });\n\n        childNodeWrap.append('path').attr('d', (d, i, n) => {\n            let pathArray = [{ 'x': 0, 'y': 0 }, { 'x': 0, 'y': i }];\n            d.map(m => {\n                pathArray.push({ 'x': m.xScale(m.move), 'y': m.level })\n            });\n            let line = d3.line()\n                .curve(d3.curveMonotoneY)\n                .x(function(d) {\n                    return d.x;\n                })\n                .y(d => (d.y * 20))\n            return line(pathArray);\n        }).attr('stoke-width', '2px').attr('fill', 'none').attr('stroke', 'gray');\n\n        childNodeWrap.on('mouseover', (d, i)=> {\n            let specArray = d.map(m=> m.species);\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let commonHover = [...commonNodeStart].map(c=> c.node).concat(d.map(n=> n.node));\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks  = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            treeLinks.filter(f => commonHover.indexOf(f.data.node) > -1).classed('hover', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', (d, i)=> {\n            d3.selectAll('.hover').classed('hover', false);\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        let childCirc = childNodes.append('circle').attr('r', 7).attr('fill', 'red').attr('y', 5);\n\n        childCirc.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        childNodes.filter(f => f.leaf === true).append('text').text(d => d.label).attr('x', 9).attr('y', 4);\n        //selectWrap.attr('transform', 'translate('+(50+(20 *commonNodeStart[commonNodeStart.length - 1].children.length))+')')\n       \n\n}\nexport function addRemoveBubble(group, scales, moveMetric){\n\n    let pathRemove = group.append('g').classed('x-icon', true);\n    pathRemove.attr('transform', 'translate(15, 10)');\n    pathRemove.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathRemove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n    pathRemove.style('cursor', 'pointer');\n    pathRemove.on('click', (d, i, n) => {\n        d3.selectAll('.high').classed('high', false);\n        d3.selectAll('.low').classed('low', false);\n        treeNodes.select('.selected').classed('selected', false);\n        pathSelected(null, dataMaster[0], scales, moveMetric);\n    });\n\n}\nexport function renderComparison(group, otherPaths, selectedDiv, scales){\n \n    let buttonGroupTest = selectedDiv.select('.button-wrap');\n    let buttonGroup = buttonGroupTest.empty() ? selectedDiv.append('div').classed('button-wrap', true) : buttonGroupTest;\n    \n    buttonGroup.style('display','inline-block').style('width', '900px').style('height', '50px');\n    let main = d3.select('div#main');\n    main.style('padding-top', '300px');\n\n    if(group != null){\n        let usedColors = comparisonKeeper.map(m=> m.groupColor);\n        let newColor = colorKeeper.find(c => usedColors.indexOf(c[0]) === -1);\n        group.groupColor = newColor[0];\n        comparisonKeeper.push(group);\n    }\n\n    if(comparisonKeeper.length > 1){\n        let compareButtonTest = d3.select('#toolbar').select('#compare-button');\n        let compareButton = compareButtonTest.empty() ? d3.select('#toolbar').append('button').text('Normal Mode').attr('id', 'compare-button').classed('btn btn-info', true) : compareButtonTest;\n        compareButton.on('click', ()=> {\n            compareButton.text() === \"Normal Mode\" ? compareButton.text('Compare Mode') : compareButton.text('Normal Mode');\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        });\n    }\n\n    let comparisonCombined = scales.map((sc, i)=> {\n        let newAtt = {'field': sc.field, 'type': sc.type, 'data': []}\n        comparisonKeeper.map((com, i)=> {\n            let atts = formatAttributeData(com.data, scales, [sc.field]);\n            newAtt.data.push({'group': {'first': com.first, 'second': com.second, 'color': com.groupColor}, 'data': atts.flatMap(a=> a)});\n        })\n        return newAtt;\n    });\n\n    let button = buttonGroup.selectAll('button').data(comparisonKeeper).join('button').classed('btn btn-info', true).style('background', d=> d.groupColor);\n    button.selectAll('span').data(t=> [t]).join('span').text(t=> {\n        return t.first[1]+ \"/\" + t.second[1] + \" \"}).append('span').text(t=> t.data.length).classed(\"badge badge-light\", true)\n    \n    let xOut = button.selectAll('i').data(d=> [d]).join('i').classed('close fas fa-times', true).style('padding-left', '10px');\n    xOut.on('click', (d, i)=> {\n        let filteredComp = comparisonKeeper.filter(f=> f.groupColor != d.groupColor);\n        comparisonKeeper = filteredComp;\n        if(comparisonKeeper.length > 0){\n            renderComparison(null, otherPaths, selectedDiv, scales);\n        }else{\n            selectedDiv.selectAll('*').remove();\n            selectedDiv.style('height', '0px');\n            main.style('padding-top', '0px');\n        }\n    });\n\n    let selectedTest = selectedDiv.select('.comparison-svg');\n    let selectedTool = selectedTest.empty() ? selectedDiv.append('svg').classed('comparison-svg', true) : selectedTest;\n    selectedDiv.style('height', '300px').style('width', '100%');\n    selectedTool.style('height', '300px');\n\n    let attWraps = selectedTool.selectAll('.att-wrapper').data(comparisonCombined.filter(f=> f.type === 'continuous').map((com)=>{\n        com.data.map(c=> {\n            let binLength = 6;\n            let max = scales.filter(f=> f.field === com.field)[0].max;\n            let min = scales.filter(f=> f.field === com.field)[0].min;\n            let normBins = new Array(binLength).fill().map((m, i)=> {\n                let step = 1 / binLength;\n                let base = (i * step);\n                let top = ((i+ 1)* step);\n                return {'base': base, 'top': top, 'binI': i, 'max': max, 'min':min }\n            });\n\n            let internalNodes = c.data.map(path => path.filter(node=> node.leaf != true));\n            let leafNodes = c.data.flatMap(path => path.filter(node=> node.leaf === true));\n            c.bins = normBins.map((n)=> {\n                let edges = internalNodes.flatMap(path => path.filter(node=> {\n                    return node.edgeMove >= n.base && node.edgeMove <= n.top;\n                } ));\n                n.data = edges;\n                n.mean = d3.mean(edges.map(e=> e.realVal))\n                return n;\n            });\n            c.leaves = leafNodes;\n            return c;\n        })\n        \n        return com;\n    }));\n    attWraps.exit().remove();\n    let attWrapsEnter = attWraps.enter().append('g').classed('att-wrapper', true);\n\n    let attLabels = attWrapsEnter.append('text').text(d=> d.field).style('text-anchor', 'end')\n                    .style('font-size', '11px').attr('transform', 'translate(120, 35)');\n\n    attWraps = attWrapsEnter.merge(attWraps);\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+(10+(i * 70))+')');\n\n    let innerWrap = attWraps.selectAll('g.inner-group').data(d=> [d]).join('g').classed('inner-group', true);\n    innerWrap.attr('transform', 'translate(150, 0)');\n    let wrapRect = innerWrap.selectAll('rect.outline-rect').data(d=> [d]).join('rect').classed('outline-rect', true)\n                    .attr('width', 800).attr('height', 60).attr('fill', '#fff').attr('stroke', 'gray');\n    \nif(d3.select('#compare-button').empty() || d3.select('#compare-button').text() === \"Normal Mode\"){\n        let lineGen = d3.line()\n        .x((d, i)=> {\n            let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n            return x(i);\n        })\n        .y(d=> {\n            let y = d.yScale;\n            y.range([60, 1]);\n            return y(d.mean);\n        });\n\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> d.data).join('g').classed('path-groups', true);\n    pathGroups.selectAll('*').remove();\n    let paths = pathGroups.append('path').attr('d', d=> { \n        let scale = d.bins[0].data[0].yScale\n        d.bins = d.bins.map((b, i, n)=> {\n            if(b.mean === undefined){\n                b.mean = d.bins[i-1].mean;\n                d.missing = true;\n            }\n            b.yScale = scale;\n            return b;\n        });\n        return lineGen(d.bins);\n    }).classed('path', true);\n\n    paths.style('fill', 'none');\n    paths.style('stroke', d=> d.group.color);\n    paths.style('stroke-width', '1px');\n\n    let yAxisG = innerWrap.append('g').classed('y-axis', true);\n\n    innerWrap.on('mousemove', function(d, i) {\n        \n        let scale = scales.filter(f=> f.field === d.field)[0];\n        let axisGroupTest = d3.select(this).select('.y-axis');\n        let axisGroup = axisGroupTest.empty() ? d3.select(this).append('g').classed('y-axis', true) : axisGroupTest;\n        \n        if(d3.select('#compare-button').empty() || d3.select('#compare-button').text()==='Normal Mode'){\n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)')\n            axisGroup.call(d3.axisLeft(scale.yScale).ticks(5));\n        }else{\n            let pathD = d3.select(this).select('.path-groups').selectAll('path');\n            let maxDiff = pathD.data().map(d=> d[0].maxDiff)[0];\n            \n            axisGroup.attr('transform', (d, i)=> 'translate('+(d3.mouse(this)[0] - 10)+',0)');\n            let newScale = d3.scaleLinear().domain([maxDiff, 0]).range([0, 60]);\n            axisGroup.call(d3.axisLeft(newScale).ticks(5));\n        }\n\n    \n    }).on('mouseleave', function(){\n        let axisGroup = d3.select(this).select('.y-axis');\n        axisGroup.remove();\n    });\n    \n}else{\n\n    innerWrap.selectAll('.path-groups').remove();\n    let pathGroups = innerWrap.selectAll('g.path-groups').data(d=> {\n        let startBins = d.data[0].bins;\n        let difArray = [];\n        for(let i = 1; i < d.data.length; i ++){\n            let diffs = []\n            d.data[i].bins.map((b, j)=>{\n                if(b.mean === undefined){\n                    b.mean = d.data[i].bins[j-1].mean;\n                }\n                if(startBins[j].mean === undefined){\n                    startBins[j].mean = startBins[j-1].mean;\n                }\n                let maxDiff = d.data[0].bins[0].max - d.data[0].bins[0].min;\n                diffs.push({'diff':Math.abs(startBins[j].mean - b.mean), 'maxDiff': maxDiff});\n            });\n            difArray.push(diffs);\n        }\n        return difArray;\n    }).join('g').classed('path-groups', true);\n\n    let lineGen = d3.line()\n        .x((d, i)=> {\n            let x = d3.scaleLinear().domain([0, 5]).range([0, 800]);\n            return x(i);\n        })\n        .y(d=> {\n            let y = d3.scaleLinear().domain([0, d.maxDiff]).clamp(true);\n            y.range([60, 0]);\n            return y(d.diff);\n        });\n\n    let paths = pathGroups.append('path').attr('d', d=> { \n        return lineGen(d);\n    });\n\n    paths.style('fill', 'none');\n    paths.style('stroke', 'black');\n    paths.style('stroke-width', '1px');\n}\n\n/////////////////////////\nlet obsDistWrap = attWraps.selectAll('.observed-dist-wrap').data(d=> {\n  \n        let max = d3.max(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n        let min = d3.min(d.data.flatMap(f=> f.leaves.map(m=> m.realVal)));\n\n        let x = d3.scaleLinear().domain([min, max]).range([0, 200]);\n    \n        let histogram = d3.histogram()\n        .value(function(d) { return d.realVal; })  \n        .domain(x.domain())  \n        .thresholds(x.ticks(10)); \n        \n        let leafData = d.data.map(m=> {\n            let newLeaves = [...m.leaves].map(leaf => {\n                leaf.x = x;\n                leaf.group = m.group;\n                return leaf;\n            });\n            return {'binData':histogram(m.leaves), 'data': newLeaves, 'group': m.group, 'xScale': x};\n        });\n        return [{'data':leafData, 'xScale': x}];\n    }).join('g').classed('observed-dist-wrap', true);\n\n    obsDistWrap.attr('transform', 'translate(970, 0)');\n  \n    let xAxis = obsDistWrap.selectAll('g.axis-x').data(d=> [d]).join('g').classed('axis-x', true);\n    xAxis.attr('transform', 'translate(0, 50)')\n    xAxis.each((d, i, nodes)=> {\n        d3.select(nodes[i]).call(d3.axisBottom(d.xScale).ticks(5))\n    });\n\n    let distGroups = obsDistWrap.selectAll('.observed-group').data(d=> {\n        return d.data.map((m, i, n)=> {\n            m.index = i;\n            m.groupLength = n.length;\n            return m;\n        });\n    }).join('g').classed('observed-group', true);\n\n    let lines = distGroups.selectAll('.line').data(d => {\n            let mean = d3.mean(d.data.map(r=> r.realVal))\n            let vals = {'mean': mean, 'group':d.group, 'x':d.xScale}\n            return [vals];\n    }).join('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.mean)-1.5)+',0)')\n    .attr('height', 50).attr('width', 3).attr('fill', d=> d.group.color).style('opacity', '0.4')\n\n    let circWrap = distGroups.selectAll('.circ-wrap').data((d, i)=> [d]).join('g').classed('circ-wrap', true).attr('transform', (d, i, n)=> {\n        let move = d3.scaleLinear().domain([0, d.groupLength]).range([0, 60]);\n        return 'translate(0,'+(move(d.index+0.5))+')'});\n\n    let distCirc = circWrap.selectAll('circle.disDots').data(d=> d.data).join('circle').attr('r', 3)\n    .attr('cx', (d, i) => {\n        return d.x(d.realVal);\n    }).attr('cy', (d, i, n)=> {\n        return 0;\n    }).attr('fill', d=> d.group.color);\n}\nexport function renderSelectedView(pathData, otherPaths, selectedDiv, scales, moveMetric) {\n\n    let attributeHeight = 50;\n\n    let selectedSpecies = pathData.flatMap(p => p.filter(f => f.leaf === true).map(n => n.node));\n    let treeNodes = d3.select('#sidebar').select('svg').selectAll('.node');\n    treeNodes.filter(node => selectedSpecies.indexOf(node.data.node) > -1).classed('selected', true);\n\n    ////FILTER MASTER TO HIDE ATTRIBUTES THAT ARE DESELECTED FROM FILTERBAR\n    let attrHide = filterMaster.filter(f => f.type === 'hide-attribute').length > 0 ? filterMaster.filter(f => f.type === 'hide-attribute').map(m => m.attribute) : [];\n    let attrFilter = attrHide.length > 0 ? scales.filter(sc => {\n        return attrHide.indexOf(sc.field) === -1;\n    }).map(m => m.field) : null;\n\n    ////IF THE SELECTED DIV IS THERE ALREADY USE THAT/////\n    let selectedToolTest = selectedDiv.select('.selected-toolbar');\n    let selectedTool = selectedToolTest.empty() ? selectedDiv.append('div').classed('selected-toolbar', true) : selectedToolTest;\n    selectedTool.selectAll('*').remove();\n\n    ///////////////////////\n    let sortByDistanceDiv = selectedTool.append('div').style('display', 'inline-block');\n    sortByDistanceDiv.append('text').text('Topology: ');\n    let sortByDistanceButton = sortByDistanceDiv.append('button').classed('btn btn-secondary btn-sm', true);\n    sortByDistanceButton.text('Sort Most to Least');\n    sortByDistanceButton.on('click', () => sortPaths(sortByDistanceButton));\n\n    /////////////Sorting by attribute///////////////\n    let attrKeys = scales.map(m => m.field);\n    let attrSortWrap = selectedTool.append('div').style('display', 'inline-block');\n    attrSortWrap.append('h6').text('Sort by: ').style('display', 'inline');\n\n    let radioDiv = attrSortWrap.selectAll('div.attr-radio').data(attrKeys).join('div').classed('attr-radio form-check form-check-inline', true);\n    let radio = radioDiv.append('input').attr('type', 'radio').property('name', 'attribute-radio-sort').property('value', d => d).attr('id', (d, i) => 'radio-' + i).classed(\"form-check-input\", true);\n    radioDiv.append('label').text(d => d).property('for', (d, i) => 'radio-' + i).classed(\"form-check-label\", true);\n\n    let svgTest = selectedDiv.select('svg.select-svg');\n    let svg = svgTest.empty() ? selectedDiv.append('svg').classed('select-svg', true) : svgTest;\n\n    svg.selectAll('*').remove();\n\n    let branchFrequency = pathData.flatMap(row => row.flatMap(f => f.node)).reduce(function(acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n            acc[curr] = 1;\n        } else {\n            acc[curr] += 1;\n        }\n        return acc;\n    }, {});\n\n    ///RENDERING SELECTED PATHS////\n    if (pathData.length === 1) {\n\n        /////////////////////////////////////////////////\n        let selectWrap = svg.append('g').classed('select-wrap', true);\n        selectWrap.attr('transform', (d, i) => 'translate(0,20)');\n\n        ///Scales for circles ///\n        let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n\n        let selectedGroups = selectWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n\n        let pathBars = selectedGroups.append('rect').classed('path-rect', true);\n        pathBars.attr('y', -8);\n\n        //////////\n        ///Selecting species\n        /////////\n        addRemoveBubble(selectedGroups, scales, moveMetric)\n\n        /////////\n        selectedGroups.on('mouseover', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let treeLinks = d3.select('#sidebar').selectAll('.link');\n            treeNode.filter(f => {\n                return d.map(m => m.node).indexOf(f.data.node) > -1;\n            }).classed('hover', true);\n            treeLinks.filter(f => d.map(m => m.node).indexOf(f.data.node) > -1).classed('hover', true);\n            return d3.select(this).classed('hover', true);\n        }).on('mouseout', function(d, i) {\n            let treeNode = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n            let treeLinks = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n            return d3.select(this).classed('hover', false);\n        });\n\n        let speciesTitle = selectedGroups.append('text').text(d => {\n            let string = d.filter(f => f.leaf === true)[0].label;\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        });\n\n        speciesTitle.attr('x', 25).attr('y', 15);\n\n        let timelines = selectedGroups.append('g').classed('time-line', true);\n        timelines.attr('transform', (d, i) => 'translate(150, 0)');\n\n        let lines = timelines.append('line')\n            .attr('x1', 0)\n            .attr('x2', 1000)\n            .attr('y1', 15)\n            .attr('y2', 15);\n\n        let nodeGroups = timelines.selectAll('.node').data((d) => d).join('g').classed('node', true);\n\n        nodeGroups.attr('transform', (d) => {\n            let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate(' + distance + ', 10)';\n        });\n\n        let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d => {\n            return circleScale(branchFrequency[d.node]);\n        }).attr('class', (d, i) => 'node-' + d.node);\n\n        circle.on('mouseover', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            let treeNode = d3.select('#sidebar').selectAll('.node');\n            let selectedBranch = treeNode.filter(f => f.data.node === d.node).classed('selected-branch', true);\n            return hovers.classed('hover-branch', true);\n        }).on('mouseout', function(d, i) {\n            let hovers = nodeGroups.filter(n => n.node === d.node);\n            d3.selectAll('.selected-branch').classed('selected-branch', false);\n            return hovers.classed('hover-branch', false);\n        });\n\n        let speciesNodeLabel = nodeGroups.filter(f => f.label != undefined).append('text').text(d => {\n            let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n            return string;\n        }).attr('x', 10).attr('y', 5);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(0,' + (i * 60) + ')');\n\n        let nodes = selectedGroups.select('.time-line').selectAll('.node');\n        nodes.on('mouseover', (d, i) => {\n\n            let nearest = otherPaths.filter(path => {\n                let nodearray = path.flatMap(f => f.node);\n                return nodearray.indexOf(d.node) > -1;\n            });\n\n            let nearestA = nearest[0];\n            let nearestB = nearest[1];\n           \n        });\n\n        //////PLAYING WITH FUNCTION TO CALULATE DISTANCES\n\n        /// LOWER ATTRIBUTE VISUALIZATION ///\n        let attributeWrapper = selectedGroups.append('g').classed('attribute-wrapper', true);\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attributeGroups = renderAttributes(attributeWrapper, attData, scales, null);\n\n        selectedGroups.attr('transform', (d, i) => 'translate(10,' + (i * ((attributeHeight + 5) * (Object.keys(d[1].attributes).length + 1))) + ')');\n\n        drawContAtt(attributeGroups);\n        drawDiscreteAtt(attributeGroups, scales, false, false);\n\n        //sizeAndMove(svg, attributeWrapper, pathData, (attrMove * attributeHeight));\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attributeWrapper.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales, moveMetric);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n      \n        return pathData;\n\n    } else if(pathData.length > 1 && pathData.length < 5) {\n       \n        let commonNodeStart = getCommonNodes(pathData);\n        renderSelectedTopology(commonNodeStart, svg, scales, branchFrequency, moveMetric);\n\n        /////END PATH RENDER///////\n        let attWrap = svg.append('g').classed('attribute-wrapper', true);\n        let attributeData = commonNodeStart[commonNodeStart.length - 1].children.map(ch => {\n            return [...commonNodeStart].concat(ch);\n        });\n\n        let attData = formatAttributeData(pathData, scales, attrFilter);\n        let attDataComb = attData[0].map((att, i)=> {\n            let species = pathData[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < attData.length; index++ ){\n                let species = pathData[index].filter(f=> f.leaf === true)[0].label;\n                let last = attData[index][i].length - 1\n                attData[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': attData[index][i]})\n            }\n            return attribute;\n        });\n\n        function findMaxState(states, offset){\n            let maxP = d3.max(states.map(v=> v.realVal));\n            let notMax = states.filter(f=> f.realVal != maxP);\n            let winState = states[states.map(m=> m.realVal).indexOf(maxP)]\n            winState.other = notMax;\n            winState.offset = offset;\n    \n            return winState;\n        }\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'edgeMove': m.edgeMove, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n\n       let attGroups = attWrap.selectAll('g').data(mappedDis).join('g').classed('attr', true);\n       attGroups.attr('transform', (d, i) => 'translate(145,' + (i * (attributeHeight + 10)) + ')');\n\n       attGroups.append('text')\n        .text(d=> d.label)\n        .style('text-anchor', 'end')\n        .style('font-size', 11)\n        .attr('transform', 'translate(0,'+(attributeHeight/2)+')');\n\n       let wrapRect = attGroups.append('rect').attr('width', 1010);\n       wrapRect.attr('height', attributeHeight);\n       wrapRect.style('fill', '#fff');\n       wrapRect.style('stroke', 'gray');\n       wrapRect.style('opacity', 0.5);\n\n       attGroups.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n     \n       let speciesGrp = attGroups.selectAll('g').data(d=> {\n            d.data = d.data.map(m=> {\n                m.type = d.type;\n                return m;\n            });\n            return d.data;\n        }).join('g').classed('species', true);\n\n       let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n           return y(d.realVal) + d.offset;\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([attributeHeight-2, 1]);\n           return y(d.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n           d3.select(n[i]).classed('selected', true);\n       }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).classed('selected', false);\n       });\n\n       let disGroup = speciesGrp.filter(sp=> {\n        return sp.type === 'discrete';\n        });\n\n       let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n       branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n            let distance = x(d.edgeMove);\n            return 'translate('+distance+', 0)';\n        });\n\n        let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 5, 2]);\n            return y(d.realVal) + d.offset;\n        }).attr('cx', 5);\n\n        bCirc.attr('fill', (d, i)=> d.color);\n\n        let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n        otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n                return y(c.realVal);\n            }).attr('fill', (c)=> c.color).style('opacity', 0.1);\n\n        otherCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n\n        bCirc.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX + 10) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n        \n        /////AXIS ON HOVER////\n        branchGrpDis.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let conGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'continuous';\n        });\n\n        let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n        branchGrpCon.attr('transform', (d)=> {\n         let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n             let distance = x(d.edgeMove);\n             return 'translate('+distance+', 0)';\n         });\n\n         /////AXIS ON HOVER////\n        branchGrpCon.on('mouseover', (d, i, n)=> {\n            let y = d.yScale;\n            y.range([0, (attributeHeight-5)]);\n            svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n            svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n            d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n            d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n            d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n            d3.selectAll('.other').style('opacity', 0.1);\n        });\n\n        let MeanRect = branchGrpCon.append('rect');\n   \n        MeanRect.attr('width', 10).attr('height', 3);\n        MeanRect.attr('y', (d, i) => {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0])\n            return y(d.realVal);\n        });\n\n        let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n        confiBars.attr('width', 10).attr('height', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.lowerCI95) - y(d.upperCI95);\n        });\n\n        confiBars.attr('y', (d, i)=> {\n            let scale = scales.filter(s=> s.field === d.label)[0];\n            let y = d3.scaleLinear().domain([scale.min, scale.max]).range([attributeHeight, 0]);\n            return y(d.upperCI95);\n        })\n        confiBars.style('opacity', 0.1);\n\n        //tranforming elements\n        svg.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(0, 60)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n\n\n    }else{\n       \n        /////////\n        //getting common node\n        ///\n\n        let maxBranch = d3.max(pathData.map(p => p.length));\n        let longestBranch = pathData.filter(path => path.length === maxBranch)[0];\n        let startBranch = longestBranch.filter(f=> f.leaf != true);\n        let commonNodeStart = startBranch;\n        //FIND THE COMMON BRANCHES BETWEEN ALL OF THE SELECTED///\n        pathData.map(path => {\n            commonNodeStart = [...path].filter(f => {\n                return (commonNodeStart.map(m => m.node).indexOf(f.node) > -1) & f.leaf != true });\n        });\n\n        svg.remove();\n        let remove = selectedTool.append('g').classed('x-icon', true);\n        remove.attr('transform', 'translate(15, 10)');\n        remove.append('circle').attr('r', 7).attr('fill', '#fff');\n        remove.append('text').text('x').attr('transform', 'translate(-5, 5)');\n        remove.style('cursor', 'pointer');\n        remove.on('click', (d, i, n) => {\n            d3.selectAll('.high').classed('high', false);\n            d3.selectAll('.low').classed('low', false);\n            treeNodes.select('.selected').classed('selected', false);\n            pathSelected(null, dataMaster[0], scales, moveMetric);\n        });        \n\n        /////////\n        renderDistibutions(pathData, selectedDiv, scales, moveMetric);\n        selectedDiv.style('height', '550px');\n\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        ////RADIO BUTTON THAT COLORS BASE DON ATTRIBUTE VALUE////\n        radio.on('click', (d, i) => {\n            let leaf = pathData.map(node => node.filter(d => d.leaf === true)[0])[0];\n            let sorted = [...otherPaths].sort(function(a, b) {\n                return a.filter(n => n.leaf === true)[0].attributes[d].realVal - b.filter(n => n.leaf === true)[0].attributes[d].realVal;\n            });\n    \n            let main = d3.select('div#main');\n            /// LOWER ATTRIBUTE VISUALIZATION ///\n            drawPathsAndAttributes(sorted.reverse(), main, scales, moveMetric);\n            main.style('padding-top', '250px');\n    \n            let paths = main.select('svg#main-path-view').selectAll('.paths');\n    \n            let high = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal > leaf.attributes[d].realVal;\n            });\n            high.classed('high', true);\n    \n            let highLeaves = high.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => highLeaves.indexOf(f.data.node) > -1).classed('high', true);\n    \n            let low = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal < leaf.attributes[d].realVal;\n            });\n            low.classed('low', true);\n    \n            let lowLeaves = low.data().map(path => path.filter(f => f.leaf === true)[0].node);\n    \n            treeNodes.filter(f => lowLeaves.indexOf(f.data.node) > -1).classed('low', true);\n    \n            let same = paths.filter(path => {\n                let leafOther = path.filter(node => node.leaf === true)[0];\n                return leafOther.attributes[d].realVal === leaf.attributes[d].realVal;\n            });\n            same.classed('same', true);\n        });\n        //tranforming elements\n        svg.style('height', ((pathData.length + attributeGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        selectedDiv.style('height', ((pathData.length + attGroups.data().map(m => m[0]).length) * 50) + 50 + 'px');\n        attWrap.attr('transform', (d) => 'translate(140, 25)');\n        d3.selectAll('.selected-path').classed('selected-path', false);\n\n        return commonNodeStart;\n    }\n    \n}\n\nfunction sortPaths(sortButton) {\n    if (sortButton.text() === 'Sort Most to Least') {\n        sortButton.text('Sort Least to Most');\n    } else {\n        sortButton.text('Sort Most to Least');\n    }\n}","export function dropDown(div, optionArray, dropText, dropId){\n    let dropdiv = div.append('div').classed('dropdown', true);\n    dropdiv.style('display', 'inline-block')\n    let button = dropdiv.append('button').classed('btn dropbtn btn-secondary', true).text(dropText);\n    let dropContent = dropdiv.append('div').attr('id', dropId).classed('dropdown-content', true);\n    dropContent.append('a').text('text');\n    let options = dropContent.selectAll('a').data(optionArray).join('a').text(d=> d.field);\n\n    button.on('click', (d, i, n)=> {\n        if(dropContent.classed('show')){\n            dropContent.classed('show', false);\n        }else{\n            dropContent.classed('show', true);\n        }\n    });\n\n    return options;\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport { colorKeeper } from './index';\nimport {pathSelected, renderComparison} from './selectedPaths';\nimport {formatAttributeData} from './dataFormat';\nimport {filterMaster, nodeFilter, getLatestData, leafStateFilter} from './filterComponent';\nimport { drawBranchPointDistribution } from './distributionView';\nimport { dropDown } from './buttonComponents';\nimport { groupedView } from './viewControl';\n\nexport function drawPathsAndAttributes(pathData, main, calculatedScales, moveMetric){\n\n    let nodeTooltipFlag = true;\n\n    let collapsed = d3.select('#scrunch').attr('value');\n  \n    main.select('#main-path-view').selectAll('*').remove();\n\n    let pathGroups = renderPaths(pathData, main, calculatedScales, moveMetric);\n  \n      /// LOWER ATTRIBUTE VISUALIZATION ///\n    let attributeWrapper = pathGroups.append('g').classed('attribute-wrapper', true);\n    let attrHide = filterMaster.filter(f=> f.type === 'hide-attribute').map(m=> m.attribute);\n\n    let attKeys = attrHide.length > 0 ? calculatedScales.filter(f=> attrHide.indexOf(f.field) === -1).map(m=> m.field) : null;\n\n    let attData = formatAttributeData(pathData, calculatedScales, attKeys);\n\n    let attrMove = attKeys === null ? calculatedScales.length : attKeys.length;\n\n    let predictedAttrGrps = renderAttributes(attributeWrapper, attData, calculatedScales, null, collapsed);\n    let attributeHeight = (collapsed === 'true')? 22 : 45;\n    pathGroups.attr('transform', (d, i)=> 'translate(10,'+ (i * ((attributeHeight + 5)* (attrMove + 1))) +')');\n    \n    let cGroups = drawContAtt(predictedAttrGrps, moveMetric, collapsed);\n    let dGroups = drawDiscreteAtt(predictedAttrGrps, moveMetric, collapsed, false);\n    sizeAndMove(main.select('#main-path-view'), attributeWrapper, pathData, (attrMove * attributeHeight));\n\n    let leafStates = d3.selectAll('.discrete-leaf');\n    leafStates.on('click', (d, i)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#state-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.winState);\n            d3.select(\"#state-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-state\").on('click', ()=> {\n                \n                leafStateFilter(d, calculatedScales);\n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n\n            });\n\n            d3.select(\"#select-by-state\").on('click', ()=> {\n                let data = getLatestData();\n                let test = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState === d.winState;\n                });\n\n                let notIt = data.filter(path => {\n                    return path[path.length - 1].attributes[d.label].winState != d.winState;\n                });\n            \n                nodeTooltipFlag = false;\n                d3.select(\"#state-tooltip\").classed(\"hidden\", true);\n\n                pathSelected(test, notIt, calculatedScales, moveMetric);\n\n            });\n\n        }});\n\n    return pathGroups;\n\n}\nexport function sizeAndMove(svg, attribWrap, data, attrMove){\n        //tranforming elements\n    svg.style('height', ((data.length * (attrMove + 52))) + 'px');\n    attribWrap.attr('transform', (d)=> 'translate(140, 25)');\n        ///////////////////////////////////\n}\nexport function renderPaths(pathData, main, scales, moveMetric){\n    \n    ////YOU SHOULD MOVE THESE APPENDING THINGS OUT OF HERE///////\n    /////Rendering ///////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    \n    let nodeTooltipFlag = false;\n\n    let pathWrapTest = svg.select('.path-wrapper');\n    let pathWrap = pathWrapTest.empty() ? svg.append('g').classed('path-wrapper', true) : pathWrapTest;\n    pathWrap.attr('transform', (d, i)=> 'translate(0,20)');\n\n      /////Counting frequency of nodes//////\n    let branchFrequency = pathData.flatMap(row=> row.flatMap(f=> f.node)).reduce(function (acc, curr) {\n        if (typeof acc[curr] == 'undefined') {\n          acc[curr] = 1;\n        } else {\n          acc[curr] += 1;\n        }\n        return acc;\n        }, {});\n\n     ///Scales for circles ///\n    \n    let circleScale = d3.scaleLog().range([6, 14]).domain([1, d3.max(Object.values(branchFrequency))]);\n    let pathGroups = pathWrap.selectAll('.paths').data(pathData).join('g').classed('paths', true);\n    let pathBars = pathGroups.append('rect').classed('path-rect', true);\n    pathBars.attr('y', -8);\n\n    //////////\n    ///Selecting species\n    /////////\n    let pathAdd = pathGroups.append('g').classed(\"fas fa-search-plus\", true);\n    pathAdd.attr('transform', 'translate(15, 10)');\n    pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n    pathAdd.append('text').text('+').attr('transform', 'translate(-5, 5)');\n    pathAdd.style('cursor', 'pointer');\n\n    pathAdd.on('click', (d, i, n)=>{\n\n        let notIt = d3.selectAll(n).filter((f, j)=> j != i).classed('selected-path', false);\n     \n        if(d3.select(n[i]).classed('selected-path')){\n            d3.select(n[i]).classed('selected-path', false);\n            pathSelected(null, notIt.data(), scales, moveMetric);\n        }else{\n            d3.select(n[i]).classed('selected-path', true);\n            pathSelected([d], notIt.data(), scales, moveMetric);\n        }\n    });\n\n    /////////\n    pathGroups.on('mouseover', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let treeLinks  = d3.select('#sidebar').selectAll('.link');\n        treeNode.filter(f=> {\n            return d.map(m=> m.node).indexOf(f.data.node) > -1;\n        }).classed('hover', true);\n        treeLinks.filter(f=> d.map(m=> m.node).indexOf(f.data.node) > -1).classed('hover', true);\n        return d3.select(this).classed('hover', true);\n    }).on('mouseout', function(d, i){\n        let treeNode  = d3.select('#sidebar').selectAll('.node').classed('hover', false);\n        let treeLinks  = d3.select('#sidebar').selectAll('.link').classed('hover', false);\n        return d3.select(this).classed('hover', false);\n    });\n\n    let speciesTitle = pathGroups.append('text').text(d=> {\n       let string = d.filter(f=> f.leaf === true)[0].label;\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    });\n\n    speciesTitle.attr('x', 25).attr('y', 15);\n\n    let timelines = pathGroups.append('g').classed('time-line', true);\n    timelines.attr('transform', (d, i)=> 'translate(150, 0)');\n\n    let lines = timelines.append('line')\n    .attr('x1', 0)\n    .attr('x2', 1000)\n    .attr('y1', 15)\n    .attr('y2', 15);\n\n    let nodeGroups = timelines.selectAll('.node').data((d)=> {\n        return d}).join('g').attr('class', (d, i, n)=> {\n            return d3.select(n[n.length - 1]).data()[0].label + \" node\";\n        });\n   \n    nodeGroups.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n        let distance = (moveMetric === 'move') ? d.move : x(d.edgeMove);\n        return 'translate('+ distance +', 10)';});\n\n    nodeGroups.on('click', (d, i, n)=> {\n        if(nodeTooltipFlag){\n            nodeTooltipFlag = false;\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n        }else{\n            nodeTooltipFlag = true;\n            d3.select(\"#branch-tooltip\")\n            .style(\"left\", (d3.event.pageX) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\")\n            .select(\"#value\")\n            .text(d.node);\n            d3.select(\"#branch-tooltip\").classed(\"hidden\", false);\n\n            d3.select(\"#filter-by-node\").on('click', ()=> {\n                nodeFilter(d.node, scales);\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n            });\n\n            d3.select(\"#select-by-node\").on('click', ()=> {\n                let data = getLatestData();\n                let test = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) > -1;\n                });\n                let notIt = pathGroups.filter(path => {\n                    return path.map(node => node.node).indexOf(d.node) === -1;\n                });\n\n                nodeTooltipFlag = false;\n                d3.select(\"#branch-tooltip\").classed(\"hidden\", true);\n\n                pathSelected(test.data(), notIt.data(), scales, moveMetric);\n\n            });\n        }\n          \n    });\n\n    let circle = nodeGroups.append('circle').attr('cx', 0).attr('cy', 0).attr('r', d=> {\n        return circleScale(branchFrequency[d.node]);\n    }).attr('class', (d, i)=> 'node-'+d.node);\n\n    circle.on('mouseover', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n        let selectedBranch = treeNode.filter(f=> f.data.node === d.node).classed('selected-branch', true);\n        return hovers.classed('hover-branch', true);\n    }).on('mouseout', function(d, i){\n        let hovers = nodeGroups.filter(n=> n.node === d.node);\n        d3.selectAll('.selected-branch').classed('selected-branch', false);\n        return hovers.classed('hover-branch', false);\n    });\n\n    let speciesNodeLabel = nodeGroups.filter(f=> f.label != undefined).append('text').text(d=> {\n        let string = d.label.charAt(0).toUpperCase() + d.label.slice(1);\n        return string;\n    }).attr('x', 10).attr('y', 5);\n\n    return pathGroups;\n}\nexport function renderAttributes(attributeWrapper, data, scales, filterArray, collapsed){\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n    let predictedAttrGrps = attributeWrapper.selectAll('g').data((d, i)=> data[i]).join('g');\n    predictedAttrGrps.classed('predicated-attr-groups', true);\n    predictedAttrGrps.attr('transform', (d, i) => 'translate(0, '+(i * (attributeHeight + 5))+')');\n\n    let attrLabel = predictedAttrGrps.append('text').text(d=> d[d.length - 1].label);\n    attrLabel.classed('attribute-label', true);\n    attrLabel.attr('transform', 'translate(-15, 20)');\n\n    return predictedAttrGrps;\n}\nfunction collapsedPathGen(data){\n    data.map((p, i)=>{\n        let step = i === 0 ? 0 : 1;\n        let test = (p.realVal > data[i-step].realVal) ? 1 : 18;\n        p.change = test;\n    })\n}\nasync function continuousPaths(innerTimeline, moveMetric, collapsed){\n\n    innerTimeline.data().forEach(path => {\n        collapsedPathGen(path, moveMetric);\n    });\n\n    //THIS IS THE PATH GENERATOR FOR THE CONTINUOUS VARIABLES\n    let height = (collapsed === 'true')? 20 : 45;\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n        let distance = (moveMetric === 'move') ? d.move : x(d.edgeMove);\n        return distance; })\n    .y(d=> {\n        let y = d.yScale;\n        y.range([height, 0]);\n        if(collapsed === 'true'){\n            return d.change;\n        }else{\n            return y(d.realVal);\n        }\n    });\n\n    let innerPaths = innerTimeline.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", \"inner-line\")\n    .style('stroke', (d)=> d[0].color);\n\n    return innerPaths;\n    ///////////////////////////////////////////////////////////\n}\nexport function drawContAtt(predictedAttrGrps, moveMetric, collapsed){\n\n    let continuousAtt = predictedAttrGrps.filter(d=> {\n        return (d[d.length - 1] != undefined) ? d[d.length - 1].type === 'continuous' : d.type === 'continuous';\n    });\n\n    let attributeHeight = (collapsed === 'true') ? 20 : 45;\n\n    let innerTimeline = continuousAtt.append('g').classed('attribute-time-line', true);\n    /////DO NOT DELETE THIS! YOU NEED TO SEP CONT AND DICRETE ATTR. THIS DRAWS LINE FOR THE CONT/////\n    let innerPaths = continuousPaths(innerTimeline, moveMetric, collapsed);\n ////////\n    let attribRectCont = innerTimeline.append('rect').classed('attribute-rect', true);\n    attribRectCont.attr('height', attributeHeight);\n    let attributeNodesCont = innerTimeline.selectAll('g').data(d=> d).join('g').classed('attribute-node', true);\n\n    let innerBars = attributeNodesCont.append('g').classed('inner-bars', true);\n\n    let innerRect = innerBars.append('rect').classed('attribute-inner-bar', true);\n    innerRect.attr('height', attributeHeight);\n    innerBars.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n        let distance = (moveMetric === 'move') ? d.move : x(d.edgeMove);\n        return 'translate('+ distance +', 0)';});\n      \n    let rangeRect = innerBars.append('rect').classed('range-rect', true);\n    rangeRect.attr('width', 20).attr('height', (d, i)=> {\n        let y = d.yScale;\n        y.range([attributeHeight, 0]);\n        let range = d.leaf ? 0 : y(d.lowerCI95) - y(d.upperCI95);\n        let barHeight = (collapsed === 'true') ? 20 : range;\n        return barHeight;\n    });\n    rangeRect.attr('transform', (d, i)=> {\n        let y = d.yScale;\n        y.range([attributeHeight, 0]);\n        let move = (d.leaf || (collapsed === 'true')) ? 0 : y(d.upperCI95);\n        return 'translate(0, '+ move +')';\n    });\n    rangeRect.style('fill', (d)=> {\n        return d.colorScale(d.realVal);\n    });\n    rangeRect.attr('opacity', (d)=> {\n        return d.satScale(d.realVal);\n    });\n    if(collapsed != 'true'){\n        innerBars.append('rect').attr('width', 20).attr('height', 5)\n        .attr('transform', (d, i)=> {\n            let y = d.yScale;\n            y.range([attributeHeight, 0]);\n            return 'translate(0, '+ y(d.realVal) +')';})\n        .attr('fill', d=> d.color).classed('val-bar', true);\n    }\n\n    /////AXIS ON HOVER////\n    innerBars.on('mouseover', (d, i, n)=> {\n        let y = d.yScale;\n        y.range([0, attributeHeight]);\n        d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(5));\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(200)\n          .style(\"opacity\", .9);\n        let f = d3.format(\".3f\");\n        tool.html('mean: '+f(d.realVal) +\"</br>\"+\"</br>\"+ 'upperCI: '+ f(d.upperCI95) +\"</br>\"+\"</br>\"+ 'lowerCI: '+ f(d.lowerCI95))\n          .style(\"left\", (d3.event.pageX) + \"px\")\n          .style(\"top\", (d3.event.pageY - 28) + \"px\");\n        tool.style('height', 'auto');\n       \n    }).on('mouseout', (d, i, n)=> {\n        d3.select(n[i]).select('g.y-axis')\n        d3.select(n[i]).select('g.y-axis').remove();\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n\n    return attributeNodesCont;\n   \n}\nexport function findMaxState(states, offset){\n    let maxP = d3.max(states.map(v=> v.realVal));\n    let notMax = states.filter(f=> f.realVal != maxP);\n    let winState = states[states.map(m=> m.realVal).indexOf(maxP)]\n    winState.other = notMax;\n    winState.offset = offset;\n    return winState;\n}\n    //BEGIN TEST\nfunction drawLeaves(attWraps){\n    let height = 40;\n        let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap-first').data(d=> {\n            let totalVal = attWraps.data().filter(f=> f.label === d.label).map(m=> m.data);\n            let totalArray = totalVal.flatMap(p=> p.flatMap(f=> f.paths[f.paths.length - 1].realVal));\n            let max = d3.max(totalArray);\n            let min = d3.min(totalArray);\n            let totalMean = d3.mean(totalArray);\n        \n            let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n            let newVal = d.data.map((m, i)=> {\n                m.index = i;\n                return {'value': m.paths[m.paths.length - 1].realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n            });\n            let groupMean = d3.mean(newVal.map(v=> v.value));\n            return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n        }).join('g').classed('observe-wrap-first', true);\n        \n        leafWraps.attr('transform', 'translate(850, 0)');\n        \n        let xAxis = leafWraps.append('g').classed('axis-x', true);\n        xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n        xAxis.each((d, i, nodes)=> {\n            d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n        });\n        \n        let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n        \n        let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n        .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n        \n        let distCircGroupOut = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n        let distcirclesOut = distCircGroupOut.selectAll('circle').data(d=> d.dotVals).join('circle');\n        distcirclesOut.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n        \n    }\nexport function drawGroups(stateBins, scales){\n    \n    let groupedBool = d3.select('#show-drop-div-group').attr('value', 'grouped');\n    \n    let height = 40;\n    let selectedTool = d3.select('#selected');\n    selectedTool.selectAll('*').remove();\n \n    let main = d3.select('#main');\n    main.style('padding-top', 0);\n\n    d3.select('#toolbar').append('text').text(stateBins[0].field)\n\n    let splitOnArray = [{'field':'None'}].concat(scales.filter(f=> (f.field != stateBins[0].field) && f.type === 'discrete'));\n    let dropOptions = dropDown(d3.select('#toolbar'), splitOnArray, 'Split On','show-drop-div-group');\n\n    ////THIS SPLITS THE DATA////\n    dropOptions.on('click', (d, i, n)=> {\n        d3.select('#toolbar').append('text').text(d.field);\n        \n        if(d.type === 'discrete'){\n\n            let newBins = stateBins.map(state=> {\n                let newBinData = d.scales.map(sc=> {\n                    let field = sc.field;\n                    let name = sc.scaleName;\n                    let newData = state.data.filter(pa=> {\n                        let leaf = pa.filter(le=> le.leaf === true)[0];\n                        return leaf.attributes[field].winState === name;\n                    });\n                    return {'field': field, 'state': name, 'data': newData }\n                });\n                state.data = newBinData;\n                return state;\n            });\n\n            //////RENDERING NEED TO SEPARATE OUT/////\n           \n           let main = d3.select('#main');\n           main.selectAll('*').remove();\n           main.style('padding-top', '40px');\n           let firstGroupDiv = main.selectAll('div.first-group').data(newBins).join('div').classed('first-group', true);\n           \n           let firstGroupSvg = firstGroupDiv.append('svg');\n           firstGroupSvg.attr('height', s=> (s.data.length*270));\n           let firstGroup = firstGroupSvg.append('g');\n          \n           let firstLabel = firstGroup.append('text').text(f=> f.state).attr('transform', 'translate(10, 10)');\n\n           let secondGroup = firstGroup.selectAll('g.second-group').data(g=> {\n               let newGroups = g.data.map((m)=>{\n                   let newM = {};\n                   newM.first = [g.field, g.state];\n                   newM.second = [m.field, m.state];\n                   newM.data = m.data\n                   newM.leaves = m.data.flatMap(path=> path.filter(f=> f.leaf === true));\n                   return newM\n               });\n               return newGroups}).join('g').classed('second-group', true);\n\n           secondGroup = secondGroup.filter(f=> f.data.length > 0);\n           secondGroup.attr('transform', (s, i)=> 'translate(30,'+(20 + (i * 270))+')');\n\n           secondGroup.each((s, i, n)=> {\n            let branchBar = drawBranchPointDistribution(s.data, d3.select(n[i]));\n            branchBar.select('rect').attr('x', -80).attr('fill','gray');\n            branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n            \n            branchBar.select('.leaf-label').append('text').text((t, i) =>': '+ t.data.length).attr('transform', 'translate(45, 0)');\n            branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n    \n            branchBar.select('line').attr('stroke', '#fff');\n\n            let groupLabels = d3.select(n[i]).append('g');\n\n            //groupLabels.\n            let pathAdd = groupLabels.append('g').classed(\"fas fa-search-plus\", true);\n            pathAdd.attr('transform', 'translate(-10, 15)');\n            pathAdd.append('circle').attr('r', 7).attr('fill', '#fff');\n            pathAdd.append('text').text('+').attr('transform', 'translate(-5, 3)').attr('fill', 'gray');\n        \n            pathAdd.style('cursor', 'pointer');\n\n            pathAdd.on('click', ()=> {\n                let other = d3.selectAll(n).filter((f,j)=> j != i);\n                renderComparison(s, other.data(), d3.select('#selected'), scales);\n            });\n\n            let stateLabel = groupLabels.append('text').text((s, i)=> s.second[1]);\n            stateLabel.attr('transform', (d, i)=> 'translate(3, 20)');\n            stateLabel.attr('fill', '#fff');\n           });\n\n           let innerGroup = secondGroup.filter(f=> f.data.length > 0).append('g').classed('inner-wrap', true);\n           innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n       \n           let attWraps = innerGroup.selectAll('.att-wrapper').data((d)=> {\n               let atts = formatAttributeData(d.data, scales, null);\n             \n               let attDataComb = atts[0].map((att, i)=> {\n                  \n                   let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n\n                   att[att.length - 1].offset = 0;\n                   let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n                   for(let index = 1; index < atts.length; index++ ){\n                       let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                       let last = atts[index][i].length - 1\n                       atts[index][i][last].offset = (index * 8);\n                       attribute.data.push({'species': species, 'paths': atts[index][i]});\n                   }\n                   \n                   return attribute;\n               });\n\n              let mappedDis = attDataComb.map(dis=> {\n                  dis.data = dis.data.map((spec, i)=> {\n                      spec.paths = spec.paths.map(m=> {\n                            if(dis.type === 'discrete'){\n                                let offset = 5 * i;\n                                let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'edgeMove': m.edgeMove, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                                return maxProb;\n                            }else{\n                                return m;\n                            }\n                        });\n                   return spec;\n                  });\n        \n                  dis.leaves = dis.data.flatMap(f=> f.paths.filter(p=> p.leaf === true));\n                  return dis;\n              });\n              return mappedDis;\n           }).join('g').classed('att-wrapper', true);\n\n           let innerWrapRect = attWraps.append('rect').attr('width', 800);\n\n            innerWrapRect.attr('height', height);\n            innerWrapRect.style('fill', '#fff');\n            innerWrapRect.style('stroke', 'gray');\n\n            attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n            wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n            svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n            let labels = attWraps.append('text')\n            .text(d=> d.label)\n            .style('text-anchor', 'end')\n            .style('font-size', 11)\n            labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n////WORKING ON STATE SHIFT VIEW///////\n            let shiftWraps = attWraps.filter(f=> f.type === 'discrete').selectAll('g.shift-wrap').data(d=> {\n       \n                let test = d.data.flatMap(m=> m.paths.filter((f, i)=> {\n                    if(i===0) return (i === 0);\n                    if(i > 0) return (m.paths[i-1].state != f.state)\n                    if(i < m.paths.length - 1) return (m.paths[i+1].state != f.state);\n                }));\n             \n                return [test];\n            }).join('g').classed('shift-wrap', true);\n\n            shiftWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxisShift = shiftWraps.append('g').classed('axis-x', true);\n            xAxisShift.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxisShift.each((d, i, nodes)=> {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 200]);\n                d3.select(nodes[i]).call(d3.axisBottom(x).ticks(5));\n            });\n\n            let circGroupShift = shiftWraps.append('g').attr('transform', 'translate(0, 20)');\n\n            let shiftCircles = circGroupShift.selectAll('circle.shift').data(d=> d).join('circle').classed('shift', true);\n            shiftCircles.attr('r', 4).attr('cx', (d, i)=> {\n                let x = d3.scaleLinear().domain([0,1]).range([0, 200]);\n                return x(d.edgeMove)\n            });\n            shiftCircles.attr('fill', d=> d.color).style('opacity', 0.4);\n\n//////DRAW OBSERVED DISTRIBUTIONS/////\n            let leafWraps = attWraps.filter(f=> f.type === 'continuous').selectAll('g.observe-wrap').data(d=> {\n                let totalVal = attWraps.data().filter(f=> f.label === d.label).flatMap(m=> m.leaves.map(l=> l.realVal));\n                let max = d3.max(totalVal);\n                let min = d3.min(totalVal);\n                let totalMean = d3.mean(totalVal);\n\n                let x = d3.scaleLinear().domain([min, max]).range([0, 200])\n                let newVal = d.leaves.map((m, i)=> {\n                    m.index = i;\n                    return {'value': m.realVal, 'x': x, 'min': min, 'max': max, 'species':m.species };\n                });\n                let groupMean = d3.mean(newVal.map(v=> v.value));\n                return [{'dotVals':newVal, 'x': x, 'totalMean': totalMean, 'groupMean':groupMean}];\n            }).join('g').classed('observe-wrap', true);\n\n            leafWraps.attr('transform', 'translate(850, 0)');\n\n            let xAxis = leafWraps.append('g').classed('axis-x', true);\n            xAxis.attr('transform', 'translate(0, '+(height - 15)+')');\n            xAxis.each((d, i, nodes)=> {\n                d3.select(nodes[i]).call(d3.axisBottom(d.x).ticks(5));\n            });\n\n            let totalMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.totalMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'red').style('opacity', '0.4');\n\n            let groupMeanLine = leafWraps.append('rect').classed('line', true).attr('transform', (d, i)=> 'translate('+(d.x(d.groupMean)-1.5)+',0)')\n            .attr('height', (height - 15)).attr('width', 3).attr('fill', 'gray').style('opacity', '0.4');\n\n            let distCircGroup = leafWraps.append('g').attr('transform', 'translate(0, 20)');\n            let distcircles = distCircGroup.selectAll('circle').data(d=> d.dotVals).join('circle');\n            distcircles.attr('r', 4).attr('cx', (d, i)=> d.x(d.value)).style('opacity', '0.3');\n\n            distcircles.on('mouseover', (d, i, n)=> {\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n           \n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n\n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n\n            ////DRAW SPECIES GROUPS IN THE ATTRIBUTES\n\n            let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n                d.data = d.data.map(m=> {\n                    m.type = d.type;\n                    return m;\n                });\n                return d.data;\n            }).join('g').classed('species', true);\n\n            let lineGenD = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n                    let distance = d.edgeMove;\n                    return x(distance);\n                    })\n                .y(d=> {\n                    let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n                    return y(d.realVal);\n                });\n\n            let lineGenC = d3.line()\n                .x(d=> {\n                    let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n                    let distance = d.edgeMove;\n                    return x(distance);\n                })\n                .y(d=> {\n                    let y = d.yScale;\n                    y.range([height-2, 1]);\n                    return y(d.realVal) + 2;\n                });\n\n            let innerStatePaths = speciesGrp.append('path')\n            .attr(\"d\", d=> {\n                    return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n                })\n            .attr(\"class\", (d, i)=> {\n                    return d.species + \" inner-line\"})\n            .style('stroke-width', 0.7)\n            .style('fill', 'none')\n            .style('stroke', 'gray');\n\n            innerStatePaths.on('mouseover', (d, i, n)=> {\n               \n                d3.select(n[i]).classed('selected', true);\n                distcircles.filter(f=> f.species === d.species).classed('selected', true).style('opacity', 1);\n\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(200)\n                  .style(\"opacity\", .9);\n                let f = d3.format(\".3f\");\n                tool.html(d.species)\n                  .style(\"left\", (d3.event.pageX + 10) + \"px\")\n                  .style(\"top\", (d3.event.pageY - 28) + \"px\");\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', true);\n                \n            }).on('mouseout', (d, i, n)=> {\n                d3.select(n[i]).classed('selected', false);\n\n                distcircles.classed('selected', false).style('opacity', 0.3);\n                let tool = d3.select('#tooltip');\n                tool.transition()\n                  .duration(500)\n                  .style(\"opacity\", 0);\n\n                let leafNodes = d3.select('#sidebar').selectAll('.node--leaf').filter(f=> f.data.label === d.species);\n                leafNodes.classed('selected', false);\n            });\n\n            let disGroup = speciesGrp.filter(sp=> {\n            return sp.type === 'discrete';\n            });\n\n            let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n            branchGrpDis.attr('transform', (d)=> {\n                let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n                    let distance = x(d.edgeMove);\n                    return 'translate('+distance+', 0)';\n            });\n\n            let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n                let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n                return y(d.realVal);\n            }).attr('cx', 5);\n\n            bCirc.classed('win-state', true);\n\n            bCirc.attr('fill', (d, i, n)=> {\n                if(i === 0){\n                    return d.color;\n                }else if(i === n.length - 1){\n                    if(d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }else{\n                    if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                        return 'rgba(189, 195, 199, 0.3)';\n                    }else{\n                        d.shift = true;\n                        return d.color;\n                    }\n                }\n            });\n\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n          let distance = x(d.edgeMove);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n    branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', 10).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', 10).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     });\n     confiBars.style('opacity', 0.1);\n           \n           //drawGroups(stateBins, calculatedScales);\n    }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        selectedTool.select('#show-drop-div-group').classed('show', false);\n    });\n    /////END SPLIT VIEW//////\n    let svgTest = main.select('#main-path-view');\n    let svg = svgTest.empty() ? main.append('svg').attr('id', 'main-path-view') : svgTest;\n    svg.selectAll('*').remove();\n\n    svg.attr('height', (stateBins.length * (height + 20)));\n    svg.append('g').attr('transform', 'translate(500, 40)').append('text').text(stateBins[0].field)\n\n    let wrappers = svg.selectAll('.grouped').data(stateBins).join('g').classed('grouped', true);\n    wrappers.each((d, i, n)=> {\n        let branchBar = drawBranchPointDistribution(d.data, d3.select(n[i]));\n        branchBar.select('rect').attr('x', -80).attr('fill','gray');\n        branchBar.selectAll('.branch-points').selectAll('circle').attr('fill', 'rgba(255, 255, 255, 0.3)');\n        \n        branchBar.select('.leaf-label').append('text').text((d, i) =>': '+ d.data.length).attr('transform', 'translate(45, 0)');\n        branchBar.selectAll('text').style('font-size', '11.5px').style('fill', '#fff');\n\n        branchBar.select('line').attr('stroke', '#fff');\n    });\n\n    let groupLabels = wrappers.append('text').text((d, i)=> d.state);\n    groupLabels.attr('transform', (d, i)=> 'translate(15, 15)');\n    groupLabels.style('text-anchor', 'end');\n    groupLabels.attr('fill', '#fff');\n\n    let innerGroup = wrappers.append('g').classed('inner-wrap', true);\n    innerGroup.attr('transform', (d,i)=> 'translate(110, 0)');\n\n    let attWraps = innerGroup.selectAll('.att-wrapper').data((d, i)=> {\n        let atts = formatAttributeData(d.data, scales, null);\n        let attDataComb = atts[0].map((att, i)=> {\n            let species = d.data[0].filter(f=> f.leaf === true)[0].label;\n            att[att.length - 1].offset = 0;\n            let attribute = {'label': att[att.length-1].label, 'type':att[att.length-1].type, 'data': [{'species': species, 'paths': att}]}\n            for(let index = 1; index < atts.length; index++ ){\n                let species = d.data[index].filter(f=> f.leaf === true)[0].label;\n                let last = atts[index][i].length - 1;\n                atts[index][i][last].offset = (index * 8);\n                attribute.data.push({'species': species, 'paths': atts[index][i]})\n            }\n            return attribute;\n        });\n\n       let mappedDis = attDataComb.map(dis=> {\n           dis.data = dis.data.map((spec, i)=> {\n               spec.paths = spec.paths.map(m=> {\n                if(dis.type === 'discrete'){\n                    let offset = 5 * i;\n                    let maxProb = m.states? {'realVal': 1.0, 'state': m.winState, 'color':m.color, 'edgeMove': m.edgeMove, 'offset':m.offset, 'leaf': true} : findMaxState(m, offset); \n                    return maxProb;\n                }else{\n                    return m;\n                }\n            });\n            return spec;\n           });\n           return dis;\n       });\n       return mappedDis;\n    }).join('g').classed('att-wrapper', true);\n\n    let innerWrapRect = attWraps.append('rect').attr('width', 800);\n    innerWrapRect.attr('height', height);\n    innerWrapRect.style('fill', '#fff');\n    innerWrapRect.style('stroke', 'gray');\n\n    attWraps.attr('transform', (d, i)=> 'translate(0,'+((i * (height+5))+ 30)+')');\n    wrappers.attr('transform', (d, i)=> 'translate(60,'+(i * (5 * (height+15))+ 50)+')');\n    svg.attr('height', (wrappers.data().length * (5 * (height+15))+ 50));\n\n       //END EXPERIMENT\n    drawLeaves(attWraps);\n\n    let labels = attWraps.append('text')\n    .text(d=> d.label)\n    .style('text-anchor', 'end')\n    .style('font-size', 11)\n    labels.attr('transform', 'translate(-5,'+(50/2)+')');\n\n    let speciesGrp = attWraps.selectAll('g.species').data(d=> {\n        d.data = d.data.map(m=> {\n            m.type = d.type;\n            return m;\n        });\n        return d.data;\n    }).join('g').classed('species', true);\n\n    let lineGenD = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d3.scaleLinear().domain([0, 1]).range([height-2, 1]);\n           return y(d.realVal);\n       });\n\n       let lineGenC = d3.line()\n       .x(d=> {\n           let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n           let distance = d.edgeMove;\n           return x(distance);\n        })\n       .y(d=> {\n           let y = d.yScale;\n           y.range([height-2, 1]);\n           return y(d.realVal) + 2;\n       });\n\n       let innerStatePaths = speciesGrp.append('path')\n       .attr(\"d\", d=> {\n            return (d.type === 'discrete') ? lineGenD(d.paths) : lineGenC(d.paths);\n        })\n       .attr(\"class\", (d, i)=> {\n            return d.species + \" inner-line\"})\n       .style('stroke-width', 0.7)\n       .style('fill', 'none')\n       .style('stroke', 'gray');\n\n       innerStatePaths.on('mouseover', (d, i, n)=> {\n        d3.select(n[i]).classed('selected', true);\n    }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).classed('selected', false);\n    });\n\n    let disGroup = speciesGrp.filter(sp=> {\n     return sp.type === 'discrete';\n     });\n\n    let branchGrpDis = disGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpDis.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n            let distance = x(d.edgeMove);\n            return 'translate('+distance+', 0)';\n     });\n\n    let bCirc = branchGrpDis.append('circle').attr('r', 5).attr('cy', (d, i)=> {\n         let y = d3.scaleLinear().domain([0, 1]).range([height - 5, 2]);\n         //return y(d.realVal) + d.offset;\n         return y(d.realVal);\n     }).attr('cx', 5);\n\n     bCirc.classed('win-state', true);\n\n     bCirc.attr('fill', (d, i, n)=> {\n        if(i === 0){\n            return d.color;\n        }else if(i === n.length - 1){\n            if(d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }\n        }else{\n            if(d.state === d3.select(n[i+1]).data()[0].state || d.state === d3.select(n[i-1]).data()[0].state){\n                return 'rgba(189, 195, 199, 0.3)';\n            }else{\n                d.shift = true;\n                return d.color;\n            }\n        }\n     });\n\n    let otherCirc = branchGrpDis.filter(f=> f.leaf != true).selectAll('.other').data(d=> d.other).join('circle').classed('other', true);\n    \n    otherCirc.attr('r', 4).attr('cx', 5).attr('cy', (c, i)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n             return y(c.realVal);\n         }).attr('fill', 'rgba(189, 195, 199, 0.1)');\n\n    otherCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n\n    bCirc.on(\"mouseover\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(200)\n           .style(\"opacity\", .9);\n         let f = d3.format(\".3f\");\n         tool.html(d.state + \": \" + f(d.realVal))\n           .style(\"left\", (d3.event.pageX + 10) + \"px\")\n           .style(\"top\", (d3.event.pageY - 28) + \"px\");\n         })\n       .on(\"mouseout\", function(d) {\n         let tool = d3.select('#tooltip');\n         tool.transition()\n           .duration(500)\n           .style(\"opacity\", 0);\n         });\n     \n     /////AXIS ON HOVER////\n    branchGrpDis.on('mouseover', (d, i, n)=> {\n         let y = d3.scaleLinear().domain([1, 0]);\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7).attr('fill', (d)=> d.color);\n         d3.select(n[i]).selectAll('.win-state').style('opacity', 0.7).attr('fill', (d)=> d.color);\n\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').attr('fill', 'rgba(189, 195, 199, 0.1)');\n         d3.select(n[i]).selectAll('.win-state').filter(w=> w.shift != true).attr('fill', 'rgba(189, 195, 199, 0.3)');\n     });\n\n    let conGroup = speciesGrp.filter(sp=> {\n         return sp.type === 'continuous';\n     });\n\n    let branchGrpCon = conGroup.selectAll('.branch').data(d=>d.paths).join('g').classed('branch', true);\n\n    branchGrpCon.attr('transform', (d)=> {\n      let x = d3.scaleLinear().domain([0, 1]).range([0, 800]);\n          let distance = x(d.edgeMove);\n          return 'translate('+distance+', 0)';\n      });\n\n      /////AXIS ON HOVER////\n     branchGrpCon.on('mouseover', (d, i, n)=> {\n         let y = d.yScale;\n         y.range([0, (height-5)]);\n         svg.selectAll('path.inner-line.'+ d.species).attr('stroke', 'red');\n         svg.selectAll('path.inner-line.'+ d.species).classed('selected', true);\n         d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n         d3.select(n[i]).selectAll('.other').style('opacity', 0.7);\n     }).on('mouseout', (d, i, n)=> {\n         d3.select(n[i]).select('g.y-axis')\n         d3.select(n[i]).select('g.y-axis').remove();\n         d3.selectAll('path.inner-line.'+ d.species).attr('stroke', 'gray');\n         d3.selectAll('path.inner-line.'+ d.species).classed('selected', false);\n         d3.selectAll('.other').style('opacity', 0.1);\n     });\n\n     let MeanRect = branchGrpCon.append('rect');\n     MeanRect.attr('width', 10).attr('height', 3);\n     MeanRect.attr('y', (d, i) => {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0])\n         return y(d.realVal);\n     });\n\n     let confiBars = branchGrpCon.filter(f=> f.leaf != true).append('rect');\n     confiBars.attr('width', 10).attr('height', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.lowerCI95) - y(d.upperCI95);\n     });\n\n     confiBars.attr('y', (d, i)=> {\n         let scale = scales.filter(s=> s.field === d.label)[0];\n         let y = d3.scaleLinear().domain([scale.min, scale.max]).range([height, 0]);\n         return y(d.upperCI95);\n     })\n     confiBars.style('opacity', 0.1);\n\n     /////HIGHLIGHTING NODES IN A TREE ON HOVER//////\n     d3.selectAll('.att-wrapper').selectAll('.branch').on('mouseover', (d, i, n)=> {\n         let treeNode  = d3.select('#sidebar').selectAll('.node');\n      \n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', true);\n      \n    }).on('mouseout', (d, i, n)=> {\n       \n        let treeNode  = d3.select('#sidebar').selectAll('.node');\n      \n        treeNode.filter(f=> {\n            return d.node === f.data.node;\n        }).classed('selected', false);\n    })\n     \n     console.log(d3.selectAll('.att-wrapper').selectAll('.branch'))\n}\nexport function drawDiscreteAtt(predictedAttrGrps, moveMetric, collapsed, bars){\n\n    let discreteAtt = predictedAttrGrps.filter(d=> {\n        return d[d.length - 1].type === 'discrete';\n    });\n\n    discreteAtt.selectAll('*').remove();\n\n    let attributeHeight = (collapsed === 'true')? 20 : 45;\n\n    let innerTimelineDis = discreteAtt.append('g').classed('attribute-time-line', true);\n\n    innerTimelineDis.append('line').classed('half', true).attr('x1', 0).attr('y1', 22).attr('x2', 1010).attr('y2', 22);\n    \n    let statePath = innerTimelineDis.selectAll('g').data(d=> {\n        let disct = d.map(m=> {\n            let test = (m.leaf == true) ? m.states.map(s=> {\n                s.move = m.move;\n                s.edgeMove = m.edgeMove;\n                s.color = m.color;\n                return s;\n            }) : m;\n            return test;\n        });\n        let keys = disct[0].map(s=> s.state);\n        let lines = keys.map(key=> {\n            return disct.map(m=> m.filter(f=> f.state == key)[0]);\n        });\n        return lines;\n    }).join('g').classed('state-path', true);\n\n    var lineGen = d3.line()\n    .x(d=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n        let distance = (moveMetric === 'move') ? d.move : x(d.edgeMove);\n        return distance + 7;})\n    .y(d=> {\n        let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight-2, 1]);\n        return y(d.realVal);\n    });\n\n    let innerStatePaths = statePath.append('path')\n    .attr(\"d\", lineGen)\n    .attr(\"class\", (d, i)=> d[0].species + \" inner-line\")\n    .style('stroke-width', 0.7)\n    .style('stroke', (d)=> {\n        return d[0].color;\n    });\n\n    let attribRectDisc = innerTimelineDis.append('rect').classed('attribute-rect', true);\n    attribRectDisc.attr('height', attributeHeight);\n    let attributeNodesDisc = innerTimelineDis.selectAll('.attribute-node-discrete').data(d=> {\n        return d;}).join('g');\n\n    attributeNodesDisc.attr('transform', (d)=> {\n        let x = d3.scaleLinear().domain([0, 1]).range([0, 1000]);\n        if(d[0]){\n            let distance = (moveMetric === 'move') ? d[0].move : x(d[0].edgeMove);\n            return 'translate('+distance+', 0)';\n        }else{\n            let distance = (moveMetric === 'move') ? d.move : x(d.edgeMove);\n            return 'translate('+distance+', 0)';\n        }\n    });\n\n    attributeNodesDisc.append('rect').attr('width', 20).attr('height', attributeHeight).attr('opacity', 0);\n\n    attributeNodesDisc.append('line').attr('x1', 10).attr('x2', 10).attr('y1', 0).attr('y2', attributeHeight);\n\n        /////AXIS ON HOVER////\n    attributeNodesDisc.on('mouseover', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([1, 0]);\n            y.range([0, attributeHeight]);\n            d3.select(n[i]).append('g').classed('y-axis', true).call(d3.axisLeft(y).ticks(3));\n        }).on('mouseout', (d, i, n)=> {\n            d3.select(n[i]).select('g.y-axis')\n            d3.select(n[i]).select('g.y-axis').remove();\n        })\n\n    attributeNodesDisc.attr('class', (d, i, n)=> {\n        let path = d3.selectAll(n).data();\n        return path[path.length - 1].species;\n    }).classed('attribute-node-discrete', true);\n\n    if(bars === false){\n\n        let stateDots = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dots').data(d=> {\n            \n            return d;\n        }).join('circle').classed('dots', true);\n        \n        stateDots.attr('cx', 10).attr('cy', (d)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([attributeHeight - 2, 2]);\n            return y(d.realVal);\n        }).attr('r', 2);\n        \n        stateDots.style('fill', (d, i, n)=> {\n           \n            /*\n            let speciesPath = d3.selectAll('.attribute-node-discrete.'+ d.species)//.filter(f=> f.type === 'discrete');\n           \n            let nodeArray = speciesPath.data().map(m=> {\n                return m.node ? m.node : m[0].node;\n            });\n            let index = nodeArray.indexOf(d.node);\n           \n            */\n            //return d.color\n            return 'gray';\n        });\n    \n        stateDots.filter(f=> f.realVal > 0.5).attr('r', 4);\n/*\n        let maxDots = stateDots.filter((f, i, n)=> {\n           \n            return f.realVal === d3.max(d3.selectAll(n).data().map(m=> m.realVal));\n        });\n*/\n        \n\n        ////NEED TO ADD COLOR ON STATE CHANGE////\n    \n        stateDots.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n        ////NEED TO MAKE A FUNCTION TO ASSIGN COLOR OF STATES//////\n    \n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }else{\n        attributeNodesDisc.filter((att, i)=> {\n            return att[0] != undefined;}).append('rect').attr('height', attributeHeight).attr('width', 20).attr('fill', '#fff')\n        let stateBars = attributeNodesDisc.filter((att, i)=> att[0] != undefined).selectAll('.dis-rect').data(d=> {\n            return d;\n        }).join('rect').classed('dis-rect', true);\n\n        stateBars.attr('width', 20).attr('height', (d, i)=> {\n         \n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            return y(d.realVal);\n        });\n\n        stateBars.attr('fill', (d, i)=> d.color);\n        stateBars.attr('opacity', '0.7');\n        stateBars.attr('stroke', '#fff');\n        stateBars.attr('transform', (d, i, n)=> {\n            let y = d3.scaleLinear().domain([0, 1]).range([0, attributeHeight]);\n            let probability = d3.selectAll(n).data().sort((a, b)=> b.realVal - a.realVal);\n            let chosenIn = probability.map(p=> p.state).indexOf(d.state);\n         \n            if(chosenIn === 0){\n                    return 'translate(0,0)';\n            }else{\n                ///need to make this a reduce function///\n                let valueAdd = 0;\n                    for(let step = 0; step < chosenIn; step++){\n                        valueAdd = valueAdd + probability[step].realVal;\n                    }\n                return 'translate(0,'+(y(valueAdd))+')';\n            }\n        });\n\n        stateBars.on(\"mouseover\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(200)\n              .style(\"opacity\", .9);\n            let f = d3.format(\".3f\");\n            tool.html(d.state + \": \" + f(d.realVal))\n              .style(\"left\", (d3.event.pageX) + \"px\")\n              .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            })\n          .on(\"mouseout\", function(d) {\n            let tool = d3.select('#tooltip');\n            tool.transition()\n              .duration(500)\n              .style(\"opacity\", 0);\n            });\n    \n        let endStateDot = attributeNodesDisc.filter((att, i)=> {\n            return att[0] === undefined;}).classed('discrete-leaf', true);\n    \n        endStateDot.append('circle').attr('cx', 10).attr('cy', 2).attr('r', 7).style('fill', d=> {\n           return d.color;\n        });\n\n        endStateDot.append('text').text(d=> d.winState).attr('transform', 'translate(20, 5)').style('font-size', 10);\n\n    }\n\n    return attributeNodesDisc;\n}\n\n","import '../styles/index.scss';\nimport * as d3 from \"d3\";\n\nimport {dataMaster, nestedData, collapsed} from './index';\nimport {filterMaster, removeFilter, addFilter} from './filterComponent';\nimport { updateMainView, groupedView } from './viewControl';\nimport {getNested} from './pathCalc';\nimport { dropDown } from './buttonComponents';\n\n\nexport function buildTreeStructure(paths, edges){\n    let root = paths[0][0];\n    let nestedData = getNested(root, edges.rows);\n   // console.log('nested data', nestedData);\n    return nestedData;\n}\n\nfunction updateBrush(treeBrush, scales){\n    \n    let sidebar = d3.select('#sidebar');\n    let toolbarDiv = d3.select('#toolbar');\n\n    let data = filterMaster.length === 0 ? dataMaster[0] : dataMaster[0];\n    let nodes = sidebar.select('svg').select('g').selectAll('.node');\n    let selectedNodes = nodes.filter(n=> (n.y > d3.event.selection[0][0]) && (n.y < d3.event.selection[1][0]) && (n.x > d3.event.selection[0][1]) && (n.x < d3.event.selection[1][1])).classed('selected', true);\n    let filterArray = selectedNodes.data().map(n=> n.data.node);\n    let test = treeFilter(data, filterArray);\n    let brushId = 'brush-'+ filterMaster.filter(f=> f.attributType === 'topology').length;\n    let filterOb = addFilter('data-filter', 'topology', brushId, treeFilter, [...data], [...test], null);\n\n    updateMainView(scales, 'edgeLength');\n   \n    ///DIMMING THE FILTERED OUT NODES//////\n\n    ////Class Tree Links////\n    let treeLinks  = d3.select('#sidebar').selectAll('.link');\n    let treeNode  = d3.select('#sidebar').selectAll('.node');\n\n    let nodeList = test.flatMap(path=> path.map(node => node.node));\n\n    d3.selectAll('.link-not-there').classed('link-not-there', false);\n    d3.selectAll('.node-not-there').classed('node-not-there', false);\n\n    let missingLinks = treeLinks.filter(f=> nodeList.indexOf(f.data.node) === -1);\n    missingLinks.classed('link-not-there', true);\n\n    let missingNodes = treeNode.filter(f=> nodeList.indexOf(f.data.node) === -1);\n    missingNodes.classed('node-not-there', true);\n\n    ///END NODE DIMMING///////\n\n    let button = toolbarDiv.append('button').classed('btn btn-info', true);\n    let span = button.append('span').classed('badge badge-light', true);\n    span.text(test.length);\n    let label = button.append('h6').text('Tree Filter');\n\n    let xSpan = label.append('i').classed('close fas fa-times', true);\n    xSpan.on('click', async (d, i, n)=> {\n        removeFilter(brushId);\n        await updateMainView(scales, 'edgeLength');\n        d3.selectAll('.selected').classed('selected', false);\n        d3.selectAll('.link-not-there').classed('link-not-there', false);\n        d3.selectAll('.node-not-there').classed('node-not-there', false);\n        button.remove();\n        d3.select(this).call(treeBrush.move, null);\n        d3.select('.tree-brush').remove();\n    });\n}\n\nexport function renderTreeButtons(normedPaths, calculatedScales, sidebar){\n    ///SIDBAR STUFF\n    let treeButton = sidebar.append('button').text('Filter by Tree').classed('btn btn-outline-secondary', true);  \n    let treeBrush = d3.brush().extent([[0, 0], [400, 600]]).on('end', (d, i, n) => updateBrush(treeBrush, calculatedScales));\n    treeButton.on('click', ()=> {\n        renderTree(sidebar, true, null, true);\n        let treeBrushG = sidebar.select('svg').append('g').classed('tree-brush', true).call(treeBrush);\n    });\n\n        ///SIDBAR STUFF\n    let treeViewButton = sidebar.append('button').text('Hide Lengths').attr('id', 'length').classed('btn btn-outline-secondary', true);  \n\n    treeViewButton.on('click', ()=> {\n  \n       sidebar.select('svg').remove();\n       if(treeViewButton.text() === 'Show Lengths'){\n            renderTree(sidebar, null, true);\n            treeViewButton.text('Hide Lengths');\n       }else{\n            renderTree(sidebar, null, false);\n            treeViewButton.text('Show Lengths');\n       }\n    });\n\n    treeViewButton.style('opacity', 0).style('width', 0).style('padding', 0).style('margin', 0)\n\n    let optionArray = [{'field':'None'}];\n\n    calculatedScales.map(m=> optionArray.push(m))\n\n    let dropOptions = dropDown(sidebar, optionArray, 'See Values','show-drop-div-sidebar');\n\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            renderTree(sidebar, d, true);\n            //updateTree(tree, dimensions, treeSvg, g, d, lengthBool);\n        }else if(d.type === 'continuous'){\n            renderTree(sidebar, null, false);\n            //updateTree(tree, dimensions, treeSvg, g, null, lengthBool);\n        }else{\n            renderTree(sidebar, null, false);\n           // updateTree(tree, dimensions, treeSvg, g, null, lengthBool);\n        }\n       sidebar.select('#show-drop-div-sidebar').classed('show', false);\n    });\n}\n\nfunction treeFilter(data, selectedNodes){\n    return data.filter(path=> {\n        let nodeNames = path.map(no=> no.node);\n        let booArray = nodeNames.map(id=> selectedNodes.indexOf(id) > -1);\n        return booArray.indexOf(true) > -1\n    });\n}\n\nfunction uncollapseSub(d){\n    d.children = d._children;\n    d._children = null;\n    if(d.children){\n        d.children.map(c=> uncollapseSub(c));\n    }    \n}\n\nfunction collapseSub(d){\n    if(d.children) {\n        d._children = d.children\n        d._children.forEach(collapseSub)\n        d.children = null\n    }  \n}\n\n\nfunction collapseTree(treeData){\n\n    let leaves = getLeaves(treeData, []);\n    //GOING TO CHANGE ALL BLANK TO ANOLIS FOR THIS SITUATION///\n    leaves.forEach(l=> l.data.clade === \"Norops\" ? l.data.clade = \"Norops\" : l.data.clade = \"Anolis\");\n\n    return stepDown(treeData);\n\n    function stepDown(node){\n        let leaves = getLeaves(node, []);\n        let ids = new Set(leaves.map(m=> m.data.clade));\n        if(ids.size > 1){\n            node.children.map(n=> stepDown(n))\n        }else{\n            node.branchPoint = true;\n            node.clade = Array.from(ids)[0]\n            collapseSub(node);\n            return node;\n        }\n        return node;\n    }\n    \n    function getLeaves(node, array){\n        if(node.children != undefined ){\n            node.children.map(n=> getLeaves(n, array))\n        }else{\n            array.push(node);\n        };\n        return array;\n    }\n}\n\nfunction assignPosition(node, position) {\n    if (node.children === undefined || node.children === null){\n        console.log('leaf',node)\n        position = position + 1.5;\n        node.position = position;\n        return position;\n    }else{\n        let positionArray = []\n        node.children.forEach((child) => {\n            position = assignPosition(child, position);\n            positionArray.push(position);\n        });\n        node.options = positionArray;\n        node.position = d3.max(positionArray);\n        return position;\n    }\n}\n\nfunction addingEdgeLength(edge, data){\n    data.combEdge = data.edgeLength + edge;\n    if(data.children){\n        data.children.forEach(chil=> {\n            addingEdgeLength(data.combEdge, chil);\n        });\n    }\n}\n\nexport function renderTree(sidebar, att, uncollapse){\n\n    // set the dimensions and margins of the diagram\n    let dimensions = {\n        margin : {top: 10, right: 90, bottom: 50, left: 20},\n        width : 290,\n        height : 650\n    }\n\n    // declares a tree layout and assigns the size\n    var treemap = d3.tree()\n    .size([dimensions.height, dimensions.width]);\n\n    addingEdgeLength(0, nestedData[0]);\n\n    //  assigns the data to a hierarchy using parent-child relationships\n    var treenodes = d3.hierarchy(nestedData[0]);\n\n    // maps the node data to the tree layout\n    treenodes = treemap(treenodes);\n\n    let groupedBool = d3.select('#show-drop-div-group').attr('value');\n    let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n\n    let sidebarTest = sidebar.select('svg');\n    let treeSvg = sidebarTest.empty() ? sidebar.append(\"svg\") : sidebarTest;\n    treeSvg.attr(\"width\", dimensions.width + dimensions.margin.left + dimensions.margin.right)\n    .attr(\"height\", dimensions.height + dimensions.margin.top + dimensions.margin.bottom);\n\n    let gTest = treeSvg.select('g.tree-g');\n    let g = gTest.empty() ? treeSvg.append(\"g\").classed('tree-g', true) : gTest;\n    g.attr(\"transform\",\n      \"translate(\" + dimensions.margin.left + \",\" + dimensions.margin.top + \")\");\n\n    if(groupedBool === \"ungrouped\" && uncollapse === false){\n        let newNodes = collapseTree(treenodes);\n        updateTree(newNodes, dimensions, treeSvg, g, att, lengthBool);\n    }else{\n        ////Break this out into other nodes////\n        updateTree(treenodes, dimensions, treeSvg, g, att, lengthBool);\n    }\n    /////END TREE STUFF\n    ///////////\n}\n\nfunction findDepth(node, array){\n\n    function stepDown(n){\n        if(n.children != null){\n            n.children.forEach(child=> {\n                stepDown(child);\n            })\n        }else{\n            array.push(n);\n        }\n    }\n    stepDown(node);\n\n    return array;\n    \n}\n\nfunction updateTree(treenodes, dimensions, treeSvg, g, attrDraw, length){\n    \n    assignPosition(treenodes, 0);\n\n    let branchCount = findDepth(treenodes, []);\n    let xScale = d3.scaleLinear().domain([0, 1]).range([0, dimensions.width]).clamp(true);\n    let yScale = d3.scaleLinear().range([dimensions.height, 0]).domain([0, branchCount.length])\n\n    if(length){   \n        g.attr('transform', 'translate(20, 320)');\n        treeSvg.attr('height', 1000);\n        yScale.range([560, 0])\n        xScale.range([0, dimensions.width + 10]);\n    } \n\n// adds the links between the nodes\n    let link = g.selectAll(\".link\")\n    .data( treenodes.descendants().slice(1))\n    .join(\"path\")\n    .attr(\"class\", \"link\");\n\n    link.transition()\n    .duration(500)\n    .attr(\"d\", function(d) {\n        if(length){\n           return \"M\" + xScale(d.data.combEdge) + \",\" + yScale(d.position)\n           + \"C\" + (xScale(d.data.combEdge) + xScale(d.parent.data.combEdge)) / 2 + \",\" + yScale(d.position)\n           + \" \" + (xScale(d.parent.data.combEdge)) + \",\" + yScale(d.position)\n           + \" \" + xScale(d.parent.data.combEdge) + \",\" + yScale(d.parent.position);\n        }else{\n            return \"M\" + d.y + \",\" + d.x\n            + \"C\" + (d.y + d.parent.y) / 2 + \",\" + d.x\n            + \" \" + (d.y + d.parent.y) / 2 + \",\" + d.parent.x\n            + \" \" + d.parent.y + \",\" + d.parent.x;\n        }       \n    });\n\n    // adds each node as a group\n    var node = g.selectAll(\".node\")\n    .data(treenodes.descendants(), d => d.data.node)\n    .join(\"g\")\n    .attr(\"class\", function(d) { \n    return \"node\" + \n    (d.children ? \" node--internal\" : \" node--leaf\"); });\n\n\n      // adds the circle to the node\n      node.selectAll('circle').data(d=> [d]).join(\"circle\")\n      .attr(\"r\", 3);\n\n    node.transition()\n    .duration(500)\n    .attr(\"transform\", function(d) { \n        if(length){\n            return \"translate(\" + xScale(d.data.combEdge) + \",\" + yScale(d.position) + \")\"; \n        }else{\n            return \"translate(\" + d.y + \",\" + d.x + \")\"; \n        }\n    });\n\n    if(attrDraw != null){\n        let leaves = node.filter(n=> n.data.leaf === true);\n        let notleaves = node.filter(n=> n.data.leaf != true);\n        \n        attrDraw.stateColors.forEach(att=> {\n            let circ = leaves.filter(f=> {\n                return f.data.attributes[attrDraw.field].winState === att.state;\n            }).select('circle');\n            circ.attr('fill', att.color);\n            circ.attr('r', 4)\n            notleaves.selectAll('circle').attr('fill', 'gray');\n        });\n    }else{\n        node.selectAll('circle').attr('fill', 'gray');\n    }\n\n    node.on('mouseover', (d, i, n)=> {\n        let paths = d3.select('#main-path-view').selectAll('.paths');\n        let points = d3.select('#main-summary-view').selectAll('.branch-points');\n        points.filter(f=> f.node === d.data.node).classed('selected', true);\n\n        let selectedPaths = paths.filter(path=> {\n            let nodes = path.map(m=> m.node);\n            return nodes.indexOf(d.data.node) > -1;\n        }).classed('hover', true);\n        selectedPaths.selectAll('g').filter(g=> g.node === d.data.node).classed('selected', true);\n        d3.select(n[i]).classed('selected-branch', true);\n\n        if(d.data.label){\n            let tool = d3.select('#tooltip');\n            tool.transition()\n            .duration(200)\n            .style(\"opacity\", .9);\n          \n            tool.html(`${d.data.label.charAt(0).toUpperCase() + d.data.label.slice(1)}`)\n            .style(\"left\", (d3.event.pageX - 40) + \"px\")\n            .style(\"top\", (d3.event.pageY - 28) + \"px\");\n            tool.style('height', 'auto');\n        }\n\n    }).on('mouseout', (d, i, n)=> {\n        d3.selectAll('.paths.hover').classed('hover', false);\n        d3.selectAll('g.selected').classed('selected', false);\n        d3.select(n[i]).classed('selected-branch', false);\n\n        let tool = d3.select('#tooltip');\n        tool.transition()\n          .duration(500)\n          .style(\"opacity\", 0);\n    });\n    let leaves = node.filter(f=> f.data.children.length == 0);\n\n    node.selectAll('text').remove();\n    node.selectAll('.triangle').remove();\n\n    let branchNodes = node.filter(n=> n.branchPoint === true);\n    branchNodes.each((b, i, n)=> {\n        if(b.children === null){\n            let triangle = d3.select(n[i]).append('path').classed('triangle', true).attr('d', d3.symbol().type(d3.symbolTriangle).size('400'))\n            triangle.attr('transform', `rotate(-90) translate(0, 65) scale(.9 4)`);\n            triangle.attr('fill', 'gray').style('opacity', 0.3);\n            let text = d3.select(n[i]).selectAll('text').data(d=> [d]).join('text').text(b.clade);\n            text.attr('transform', 'translate(55, 5)');\n        }\n    })\n    branchNodes.select('circle').attr('fill', 'red').attr('r', 4.5);\n    branchNodes.on('click', (d, i, n)=> {\n        if(d.children == null){\n            uncollapseSub(d);\n        }else{\n            collapseSub(d);\n        }\n        let lengthBool = d3.select('button#length').text() === 'Hide Lengths';\n        updateTree(treenodes, dimensions, treeSvg, g, attrDraw, lengthBool);\n      \n    });\n\n    node.raise();\n    node.selectAll('circle').raise();\n\n    return node;\n}","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {drawPathsAndAttributes, drawDiscreteAtt, drawGroups} from './renderPathView';\nimport {toggleFilters, getLatestData} from './filterComponent';\nimport { updateMainView } from './viewControl';\nimport { collapsed } from '.';\nimport { dropDown } from './buttonComponents';\n\n\nexport function toolbarControl(toolbar, normedPaths, main, calculatedScales, moveMetric, pathView){\n\n    let viewButton = toolbar.append('button').attr('id', 'view-toggle').attr('attr' , 'button').attr('class', 'btn btn-outline-secondary');\n    viewButton.on('click', ()=> togglePathView(viewButton, calculatedScales, moveMetric));\n\n    if(pathView === 'paths'){\n        viewButton.text('View Summary');\n    }else if(pathView === 'summary'){\n        viewButton.text('View Paths');\n    }else{\n        console.error('pathView parameter not found');\n    }\n    \n    let filterButton = toolbar.append('button').attr('id', 'view-filter');\n    filterButton.attr('class', 'btn btn-outline-secondary').text('Show Filters');\n    filterButton.on('click', ()=> toggleFilters(filterButton, main, moveMetric, calculatedScales));\n    ///LENGTH BUTTON CODE\n\n    let scrunchButton = toolbar.append('button').attr('id', 'scrunch');\n    scrunchButton.attr('class', 'btn btn-outline-secondary').text('Collapse Attributes');\n    scrunchButton.attr('value', false);\n    scrunchButton.on('click', ()=> toggleScrunch(scrunchButton, main, calculatedScales));\n\n    let discreteViewButton = toolbar.append('button').attr('id', 'discrete-view');\n    discreteViewButton.attr('class', 'btn btn-outline-secondary').text('Switch to Discrete Bars');\n    discreteViewButton.attr('value', false);\n    discreteViewButton.on('click', ()=> {\n        let discretePredictedGroups = d3.selectAll('.predicated-attr-groups');\n        if(discreteViewButton.text() === 'Switch to Discrete Bars'){\n            discreteViewButton.text('Switch to Discrete Dots');\n            drawDiscreteAtt(discretePredictedGroups, moveMetric, collapsed, true);\n        }else{\n            discreteViewButton.text('Switch to Discrete Bars');\n            drawDiscreteAtt(discretePredictedGroups, moveMetric, collapsed, false);\n        }\n    });\n\n    let optionArray = [{'field':'None'}];\n\n    calculatedScales.map(m=> {\n        if(m.type === 'discrete'){\n            optionArray.push(m);\n        }\n    });\n\n    let dropOptions = dropDown(toolbar, optionArray, 'Group By','show-drop-div-group');\n    toolbar.select('#show-drop-div-group').attr('value', 'ungrouped');\n    console.log('dropOptions', toolbar.select('#show-drop-div-group').attr('value'));\n\n    dropOptions.on('click', (d, i, n)=> {\n        if(d.type === 'discrete'){\n            let data = getLatestData();\n            let stateBins = d.scales.map(m=> {\n                return {'field': m.field, 'state': m.scaleName, 'data': []}});\n           \n            stateBins.map(state=> {\n               state.data = data.filter(paths=> {\n                    let node = paths.filter(no=> no.leaf === true);\n                        return node[0].attributes[state.field].winState === state.state;\n                });\n            });\n           d3.select('#main').selectAll('*').remove();\n           drawGroups(stateBins, calculatedScales);\n        }else{\n            console.error('THIS HAS TO BE DISCRETE');\n        }\n        toolbar.select('#show-drop-div-group').classed('show', false);\n    });\n}\n\n////COLLAPSES THE NODES DOWN\nfunction toggleScrunch(button, main, calculatedScales){\n\n    let data = getLatestData();\n   \n    if(button.text() === 'Collapse Attributes'){\n        button.text('Expand Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', true);\n        drawPathsAndAttributes(data, main, calculatedScales, 'edgeLength');\n    }else{\n        button.text('Collapse Attributes');\n        main.selectAll('*').remove();\n        button.attr('value', false);\n\n        drawPathsAndAttributes(data, main, calculatedScales, 'edgeLength');\n    }\n}\n\n/**\n * \n * @param {*} viewButton button that changes the actual view the text of the button determines what the view should change to \n * @param {*} normedPaths \n * @param {*} main \n * @param {*} calculatedScales \n */\nfunction togglePathView(viewButton, calculatedScales, moveMetric){\n\n    if(viewButton.text() === 'View Paths'){\n        viewButton.text('View Summary');\n    }else{\n        viewButton.text('View Paths');\n    }\n    updateMainView(calculatedScales, moveMetric);\n}\n\n\n\n\n\n","import '../styles/index.scss';\nimport * as d3 from \"d3\";\nimport {loadData} from './dataLoad';\nimport {calculateScales, matchLeaves, matchEdges, normPaths, filterKeeper} from './dataFormat';\nimport {allPaths, pullPath, getPath} from './pathCalc';\nimport {drawPathsAndAttributes} from './renderPathView';\nimport {renderTree, buildTreeStructure, renderTreeButtons} from './sidebarComponent';\nimport {toolbarControl, renderAttToggles} from './toolbarComponent';\nimport { updateMainView, initialViewLoad } from './viewControl';\n\nexport const dataMaster = [];\nexport const savedSelected = [];\nexport const collapsed = false;\nexport const nestedData = [];\n\nexport const colorKeeper = [\n    ['#0dc1d1', '#c8f7fd'],\n    ['#3AD701', '#2a9b01'],\n    ['#fec303', '#d3a001'],\n    ['#fe4ecb', '#d30197'],\n    ['#f36b2c'],\n    ['#1abc9c'],\n    ['#493267'],\n    ['#a40b0b'],\n    ['#0095b6'],\n]\n\nlet wrap = d3.select('#wrapper');\nlet main = wrap.select('#main');\nlet selectedPaths = wrap.select('#selected');\nlet sidebar = wrap.select('#sidebar');\nlet toolbarDiv = wrap.select('#toolbar');\n\nloadData(d3.json, './public/data/body-length-res.json', '').then(d=> console.log('new data!', d))\n\nloadData(d3.json, './public/data/anolis-edges.json', 'edge').then(async edges => {\n\n    //helper function to create array of unique elements\n    Array.prototype.unique = function() {\n        return this.filter(function (value, index, self) { \n            return self.indexOf(value) === index;\n        });\n    }\n\n    let edgeLen = await loadData(d3.json, './public/data/anolis-edge-length.json', 'edge');\n\n    //Mapping data together/////\n    let edgeSource = edges.rows.map(d=> d.V1);\n    let leaves = edges.rows.filter(f=> edgeSource.indexOf(f.V2) == -1 );\n    let leafChar = await loadData(d3.json, './public/data/anolisLeafChar.json', '');\n    let leafChar2 = await loadData(d3.csv, './public/data/anolisDataNew.csv', '');\n    let labels = await loadData(d3.json, './public/data/anolis-labels.json', '');\n\n    console.log('leafffs', leafChar)\n\n// console.log('new attribute data',leafChar, leafChar2)\n  //  console.log(Object.entries(leafChar2).filter(en=> en[0] != 'columns' && en[0] != 'type'));\n    let rows = Object.entries(leafChar2).filter(en=> en[0] != 'columns' && en[0] != 'type');\n    \n //   let leafChar = {'rows': rows.map(m=> m[1]), 'type': leafChar2.type, 'fields': leafChar2.columns};\n\n   // console.log(leafChar, leafCharNew);\n\n    ///MAKE A ESTIMATED SCALES THING\n    let calculatedAtt = {\n        'awesomeness' : await loadData(d3.json, './public/data/anolis-awesomeness-res.json', 'continuous'),\n        'island' : await loadData(d3.json, './public/data/anolis-island-res.json', 'discrete'),\n        'SVL' : await loadData(d3.json, './public/data/anolis-svl-res.json', 'continuous'),\n        'ecomorph': await loadData(d3.json, './public/data/anolis-ecomorph-res.json', 'discrete'),\n        'PCIII_padwidth_vs_tail': await loadData(d3.json, './public/data/padwidth-vs-tail-res.json', 'continuous'),\n    }\n\n    console.log('pad v tail', calculatedAtt['PCIII_padwidth_vs_tail'])\n\n    ////CALCULATE THE SCALES FOR EACH ATTRIBUTE////////\n    let calculatedScales = calculateScales(calculatedAtt, colorKeeper);\n\n    ///MATCH LEAF CHARACTERS AND LABELS TO LEAVES///\n    let matchedLeaves = matchLeaves(labels, leaves, leafChar, calculatedScales);\n\n    console.log(matchedLeaves);\n\n    //MATCH CALC ATTRIBUTES TO EDGES///\n    let matchedEdges = matchEdges(edges, edgeLen, calculatedAtt, calculatedScales);\n\n    ///CALCULATES PATHS FROM THE DATA////\n    let paths = allPaths(matchedEdges, matchedLeaves, \"V1\", \"V2\");\n \n    let normedPaths = normPaths(paths, calculatedAtt, calculatedScales);\n    dataMaster.push(normedPaths);\n   \n    toolbarControl(toolbarDiv, normedPaths, main, calculatedScales, 'edgeLength', 'paths');\n    \n    let filterDiv = wrap.select('#filter-tab').classed('hidden', true);\n\n    ////////TREE RENDER IN SIDEBAR////////\n    nestedData.push(buildTreeStructure(paths, edges));\n    renderTreeButtons(normedPaths, calculatedScales, sidebar, false);\n    let tree = renderTree(sidebar, null, false);\n    \n    /// LOWER ATTRIBUTE VISUALIZATION ///\n    initialViewLoad(calculatedScales, 'edgeLength');\n});\n\nlet tooltip = wrap.append(\"div\")\n.attr(\"id\", \"tooltip\")\n.style(\"opacity\", 0);\n/*\nloadData(d3.json, './public/data/geospiza_with_attributes.json').then(data=> {\n    let pathArray = pullPath([], [data], [], [], 0);\n\n    //console.log('pa',pathArray);\n});*/\n/*\nloadData(d3.json, './public/data/geospiza_loop_all_asr_features.json').then(data=> {\n    let pathArray = pullPath([], [data], [], [], 0);\n\n    console.log('pa RICH',pathArray);\n});*/\n/*\nloadData(d3.json, './public/data/anolis_rich_ASR_pad_vs_tail.json').then(data=> {\n    let pathArray = pullPath([], [data], [], [], 0);\n\n    console.log('anolis RICH',pathArray);\n});*/\n\n\n\n\n"],"sourceRoot":""}